# å…«ã€æ·±åº¦é‡å­å­¦ä¹ 

> å¤´è„‘æ— æ‰€ç•æƒ§çš„åœ°æ–¹

> *å¹¶ä¸”å¤´è¢«æŠ¬å¾—é«˜é«˜çš„*

> çŸ¥è¯†æ˜¯å…è´¹çš„ã€‚
> 
> â€”ç½—å®¾å¾·æ‹‰çº³ç‰¹Â·æ³°æˆˆå°”

é€šè¿‡å­¦ä¹ æ¥æ‹“å±•æˆ‘ä»¬çš„çŸ¥è¯†æ˜¯äººç±»çš„å¤©æ€§ã€‚é€šè¿‡ä¸æ–­å­¦ä¹ æ¥åŸ¹å…»å’Œå‘å±•ä¼˜åŒ–æˆ‘ä»¬ç”Ÿæ´»ä¸­æ¯ä¸€ä¸ªå°è§’è½çš„è‰ºæœ¯ï¼Œæ˜¯äººç±»æ–‡æ˜å²ä¸Šè¿›æ­¥çš„æ”¯æŸ±ã€‚æˆ‘ä»¬å—ç›Šäºæ”¹å–„æ—¥å¸¸ç”Ÿæ´»å„ä¸ªæ–¹é¢çš„åŠªåŠ›ã€‚ç¬¬ä¸ƒç« è®²è¿°äº†é‡å­é€€ç«ï¼Œè™½ç„¶æœ€ä¼˜åŒ–ç†è®ºæ¥æºäºæ•°å­¦æ¦‚å¿µï¼Œä½†å®ƒä»¬ä¹Ÿå¯ä»¥è¢«è½¬åŒ–å¹¶æ„å»ºåˆ°ç‰©ç†å­¦ä¸­ã€‚æ¯”å¦‚ç‰©ç†å­¦æœ‰*æœ€å°ä½œç”¨é‡åŸç†*ï¼Œæœ€å°ç†µäº§ç”Ÿ*åŸç†*ï¼Œå˜åˆ†åŸç†*ã€‚ç‰©ç†å­¦æä¾›*ç‰©ç†é€€ç«*ï¼Œå®ƒå…ˆäºè®¡ç®—æ¨¡æ‹Ÿé€€ç«ã€‚ç‰©ç†å­¦è¿˜æä¾›äº†ç»çƒ­åŸç†ï¼Œä»é‡å­å½¢å¼æ¥çœ‹ï¼Œå°±æ˜¯é‡å­é€€ç«ã€‚å› æ­¤ï¼Œç‰©ç†æœºå™¨å¯ä»¥è§£å†³ä¼˜åŒ–çš„æ•°å­¦é—®é¢˜ï¼ŒåŒ…æ‹¬çº¦æŸâ€”â€”è¿™ç§å±æ€§å¯ä»¥æ‰©å±•åˆ°ä½¿ç”¨é‡å­ç³»ç»Ÿæ¥å¤„ç†ç»å…¸å’Œé‡å­æ•°æ®ã€‚*

*Note

ç¬¬ç«  7 è§£å†³äº†æœ€å¤§å‰² NP éš¾é—®é¢˜ã€‚æœ¬ç« ç€çœ¼äºåˆ©ç”¨ D-Wave çš„ qbsolve è§£å†³ä¸€ä¸ªæ›´å¤æ‚çš„ NP-hard é—®é¢˜:æ—…è¡Œæ¨é”€å‘˜é—®é¢˜ã€‚æˆ‘ä»¬è¿˜ä»ç¬¬ 2 å’Œ 3 ç« ä¸­ä»ç»å…¸ç¥ç»ç½‘ç»œè·å¾—çš„è§è§£ä¸­æ”¶é›†ä¿¡æ¯ï¼Œå¹¶åœ¨ Xanadu çš„ PennyLane å’Œè°·æ­Œçš„ TensorFlow Quantum æä¾›çš„åº“çš„å¸®åŠ©ä¸‹ï¼Œå‘å±•æˆä¸ºé‡å­æ·±åº¦å­¦ä¹ çš„é€‰é¡¹ã€‚

ä¸ºäº†è§£å†³ä»Šå¤©çš„ç°å®é—®é¢˜ï¼Œé‡å­è®¡ç®—æœºéœ€è¦è¯»å–ã€è§£é‡Šå’Œåˆ†æè¾“å…¥æ•°æ®é›†ã€‚é‡å­ç³»ç»Ÿçš„è¾“å…¥æ•°æ®å¯ä»¥æ˜¯è‡ªç„¶æˆ–äººå·¥é‡å­ç³»ç»Ÿä¸­çš„ä»»ä½•æ•°æ®æºã€‚

å›¾ 5-6 æ˜¾ç¤ºäº†ç»å…¸æ•°æ®é©±åŠ¨é‡å­è®¡ç®—è¿‡ç¨‹çš„ä¸‰ä¸ªä¸€èˆ¬æ‰§è¡Œé˜¶æ®µï¼Œæ­¤å¤„å†æ¬¡æ˜¾ç¤ºä»¥ä¾›å‚è€ƒã€‚

![img/502577_1_En_8_Figa_HTML.jpg](img/502577_1_En_8_Figa_HTML.jpg)

*è½¬è½½å›¾* 5-6 *ã€‚é‡å­è®¡ç®—æœºæ‰§è¡Œçš„ä¸‰ä¸ªé˜¶æ®µ*

å°†ç»å…¸æ•°æ®åŠ è½½åˆ°é‡å­æ€ä»¥ä¾›é‡å­è®¡ç®—æœºå¤„ç†çš„é‡å­ç”µè·¯å…¬å¼æ˜¯å½“å‰ç ”ç©¶çš„æ´»è·ƒç„¦ç‚¹ã€‚ç”±äºä¸åŒçš„é‡å­ç®—æ³•å¯¹å¦‚ä½•åŠ è½½ç»å…¸è¾“å…¥æ•°æ®å¹¶å°†å…¶æ ¼å¼åŒ–æˆç›¸åº”çš„é‡å­çŠ¶æ€å…·æœ‰ä¸åŒçš„é™åˆ¶ï¼Œå› æ­¤ç›®å‰åœ¨è¯¥é¢†åŸŸä¸­ä½¿ç”¨äº†å‡ ç§æ•°æ®åŠ è½½ç”µè·¯(ä¾‹å¦‚ï¼ŒåŸºæœ¬ç¼–ç ã€å¹…åº¦ç¼–ç ç­‰ã€‚).éšç€æœ¬ç« çš„æ·±å…¥ï¼Œä½ ä¼šçœ‹åˆ°ç»å…¸æ•°æ®æ˜¯å¦‚ä½•é€šè¿‡é‡å­ç³»ç»Ÿè¿›è¡Œç¼–ç å’Œå¤„ç†çš„ã€‚

ä½œä¸ºç¬¬ä¸ƒç« çš„å»¶ç»­ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•ä½¿ç”¨ D-Wave çš„ qbsolve æ¥è§£å†³ä¸€ä¸ªä¼—æ‰€å‘¨çŸ¥çš„ NP éš¾é¢˜:æ—…è¡Œé”€å”®äººå‘˜ã€‚

## é€šè¿‡ D-Wave ä¼˜åŒ–å­¦ä¹ 

åœ¨ç¬¬ä¸ƒç« ä¸­ï¼Œæˆ‘ä»¬ä» D-Wave æ¢ç´¢äº†ä¸€äº›åŸºäºé‡å­é€€ç«çš„ç³»ç»Ÿå¯ä»¥è§£å†³çš„åŠŸèƒ½å’Œé—®é¢˜ã€‚ç»å…¸çš„æœ€ä¼˜åŒ–é—®é¢˜ï¼Œç”±æ–¹ç¨‹å¼ 7 ç»™å‡ºã€‚27 (ä¸ºä¾¿äºé˜…è¯»åœ¨æ­¤è½¬è½½)ï¼Œç»™äº†æˆ‘ä»¬ä»¥ä¸‹æ•°å­¦è¡¨è¾¾å¼ï¼Œå¯ä»¥ç”¨æ¥åœ¨ D-Wave å¹³å°ä¸Šå»ºç«‹ç¼–ç¨‹æ¨¡å‹ã€‚

![$$ Obj\left({a}_i,{b}_{ij};{q}_i\right)=\sum \limits_i{a}_i{q}_i+\sum \limits_{ij}{b}_{ij}{q}_i{q}_j $$](img/502577_1_En_8_Chapter_TeX_Equa.png)

æ–¹ç¨‹å¼ 7ã€‚27 é€šè¿‡ä¼Šè¾›æ¨¡å‹å“ˆå¯†é¡¿é‡é‡åŒ–ï¼Œå¹¶ç”¨äºé€šè¿‡åœ¨é€€ç«é©±åŠ¨å¹³å°ä¸Šæ˜ å°„æ¥å®ç°é‡å­å¢å¼ºä¼˜åŒ–ã€‚ä¸ºæ­¤ï¼Œæ–¹ç¨‹å¼ 7ã€‚4 ï¼Œ 7ã€‚5 å’Œ 7ã€‚27 åˆ¶å®šä»¥ä¸‹å“ˆå¯†é¡¿é‡(D-Wave æ–‡æ¡£[144])ã€‚

![$$ H(s)=A(s)\sum \limits_i{\sigma_i}^x+B(s)\left[\sum \limits_i{a}_i{\sigma_i}^z+\sum \limits_{ij}{b}_{ij}{\sigma_i}^z{\sigma_j}^z\right] $$](img/502577_1_En_8_Chapter_TeX_Equb.png)

(8.1)

å…¶ä¸­ *A* ( *s* )å’Œ *B* ( *s* )ä¸ºæ‹‰æ ¼æœ—æ—¥ä¹˜æ•°ã€‚ <sup>1</sup> åœ¨ç¼–ç¨‹æœ¯è¯­ä¸­ï¼Œ *A* ( *s* )ä¹Ÿè¢«ç§°ä¸º`gamma`å‚æ•°(åé¢è§£é‡Š)ã€‚

åœ¨è¿™ç§èƒŒæ™¯ä¸‹ï¼Œç†Ÿæ‚‰ D-Wave çš„ QB solve([`https://github.com/dwavesystems/qbsolv`](https://github.com/dwavesystems/qbsolv))ã€161ã€‘æ˜¯æœ‰å¸®åŠ©çš„ã€‚qbsolve æ˜¯ä¸€ä¸ªåˆ†è§£ï¼Œæ··åˆé‡å­/ç»å…¸æ±‚è§£å™¨ã€‚å®ƒé€šè¿‡å°†ä¸€ä¸ªå¤§å‹äºŒæ¬¡æ— çº¦æŸäºŒå…ƒä¼˜åŒ–(æ›²æ³¢)é—®é¢˜åˆ†è§£æˆå¤šä¸ªéƒ¨åˆ†æ¥å¯»æ‰¾å…¶æœ€å°å€¼ï¼Œé€šè¿‡ D-Wave ç³»ç»Ÿæˆ–ç»å…¸çš„ç¦å¿Œæ±‚è§£å™¨æ¥æ±‚è§£ã€‚è¿™æ˜¯ä¸€ä¸ªå¼€æºè½¯ä»¶å·¥å…·ï¼Œä¸“ä¸ºå¤ªå¤§å’Œ/æˆ–å¤ªå¯†é›†çš„é—®é¢˜è€Œè®¾è®¡ï¼Œæ— æ³•åœ¨ D-Wave é‡å­è®¡ç®—æœºä¸Šè¿è¡Œï¼Œè¯¥è®¡ç®—æœºå°†é—®é¢˜åˆ†æˆå—ï¼Œå¹¶è¿­ä»£æˆå­é‡å­ã€‚qbsolve è¿‡ç¨‹å¯ä»¥åœ¨ç»å…¸è®¡ç®—æœºä¸Šè¿è¡Œã€‚

qbsolve é‡‡ç”¨æ›²æ³¢æ–‡ä»¶æ ¼å¼æˆ– Q çŸ©é˜µä½œä¸ºæ¨¡æ‹Ÿé€€ç«æˆ– QPU çš„è¾“å…¥ï¼Œå¹¶ç»™å‡ºä½ä¸²ä½œä¸ºè¾“å‡º(è§å›¾ 8-1 )ã€‚

![img/502577_1_En_8_Fig1_HTML.jpg](img/502577_1_En_8_Fig1_HTML.jpg)

å›¾ 8-1

å…é™¤æ··åˆç®—æ³•å·¥ä½œæµ

å›¾ 8-1 æ˜¾ç¤ºäº† qbsolve ç®—æ³•çš„å·¥ä½œæµç¨‹ï¼ŒåŒ…æ‹¬ä»¥ä¸‹æ­¥éª¤ã€‚

*   è¯»å–æ›²æ³¢å®ä¾‹

*   åˆ’åˆ†æˆæ›´å°çš„å­é‡å­

*   æ±‚è§£å­é‡å­(è¿™å¯ä»¥åœ¨ CPU æˆ– QPU ä¸Šå®Œæˆ)

*   åˆå¹¶ç»“æœ

qbsolve çš„ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­æ˜¯æ—…è¡Œæ¨é”€å‘˜é—®é¢˜ã€‚

### æ—…è¡Œæ¨é”€å‘˜é—®é¢˜(qbsolve)

æ—…è¡Œæ¨é”€å‘˜é—®é¢˜(TSP)<sup>2</sup>ã€162ã€‘æ˜¯ä¸€ä¸ªä¼—æ‰€å‘¨çŸ¥ä¸”è‡­åæ˜­è‘—çš„ NP-hard é—®é¢˜ï¼Œå®ƒè®©æ•°å­¦å®¶ä»¬å…´å¥‹äº†å‡ ä¸ªä¸–çºªï¼Œä¹Ÿè®©è®¡ç®—æœºç§‘å­¦å®¶ä»¬å…´å¥‹äº†å‡ åå¹´ã€‚ä»åº”ç”¨ç¨‹åºçš„ä¸Šä¸‹æ–‡æ¥çœ‹ï¼ŒTSP ç±»å‹çš„é—®é¢˜åœ¨é‡‘èå’Œè¥é”€è¡Œä¸šä¸­å¾ˆé‡è¦ã€‚TSP ç”±äºå…¶*ç¡¬åº¦*ä»¥åŠä¸å®è·µä¸­å‡ºç°çš„ä¸€äº›å…¶ä»–ç›¸å…³ç»„åˆä¼˜åŒ–é—®é¢˜çš„ç›¸ä¼¼æ€§è€Œè¢«è®¤ä¸ºæ˜¯é‡è¦çš„ã€‚

åŸºäºæ—©æœŸåˆ†æçš„æ•°å­¦å…¬å¼æ˜¯ç”±çˆ±å°”å…°æ•°å­¦å®¶ W. R .æ±‰å¯†å°”é¡¿å’Œè‹±å›½æ•°å­¦å®¶æ‰˜é©¬æ–¯Â·æŸ¯å…‹æ›¼åœ¨ 19 ä¸–çºªæ—©æœŸæå‡ºçš„ã€‚ä»æ•°å­¦ä¸Šæ¥è¯´ï¼Œè¿™ä¸ªé—®é¢˜å¯ä»¥ç”¨å›¾æ¥æŠ½è±¡(ä¾‹å¦‚ï¼Œæœ€å¤§å‰²)ã€‚å›¾çš„èŠ‚ç‚¹ä¸Šçš„ TSP è¦æ±‚å¯ä»¥é€šè¿‡æ¯ä¸ªèŠ‚ç‚¹çš„æœ€çŸ­å“ˆå¯†é¡¿åœˆã€‚å“ˆå¯†å°”é¡¿åœˆæ˜¯ä¸€ä¸ªå°é—­çš„è·¯å¾„ï¼Œå®ƒä½¿ç”¨å›¾çš„æ¯ä¸ªé¡¶ç‚¹ä¸€æ¬¡ã€‚ä¸€èˆ¬çš„è§£å†³æ–¹æ¡ˆæ˜¯*æœªçŸ¥çš„ï¼Œ*å¹¶ä¸”æœ‰æ•ˆåœ°æ‰¾åˆ°å®ƒçš„ç®—æ³•ï¼Œä¾‹å¦‚ï¼Œä¸æœŸæœ›åœ¨å¤šé¡¹å¼æ—¶é—´å†…å­˜åœ¨ã€‚

TSP çš„å…¬å¼å¦‚ä¸‹:ä¸€ä¸ªæ—…è¡Œæ¨é”€å‘˜ä»ä¸€ä¸ªåŸå¸‚åˆ°å¦ä¸€ä¸ªåŸå¸‚å»æ¨é”€å•†å“ã€‚ç»™å®šä¸€ä¸ªåŸå¸‚åˆ—è¡¨å’Œæ¯å¯¹åŸå¸‚ä¹‹é—´çš„è·ç¦»ï¼Œæœ€çŸ­çš„å¯èƒ½è·¯çº¿æ˜¯ä»€ä¹ˆï¼Œå¯ä»¥è®¿é—®æ¯ä¸ªåŸå¸‚ä¸€æ¬¡ï¼Œç„¶åè¿”å›å‡ºå‘åŸå¸‚ï¼Ÿè¿™ç§ä¼˜åŒ–çš„è·¯çº¿ä½¿é”€å”®äººå‘˜èƒ½å¤Ÿåœ¨æœ€çŸ­çš„æ—¶é—´å†…å®ç°æœ€å¤§çš„æ½œåœ¨é”€å”®é¢ã€‚

åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªä¹ä¸ªåŸå¸‚çš„ TSPï¼Œå…¶ä¸­é”€å”®äººå‘˜å¿…é¡»è®¿é—®ä¹ä¸ªåŸå¸‚æ¥è¿›è¡Œé”€å”®ã€‚è¿™ä¸ªé—®é¢˜å¯¹äºä»»ä½•æ•°é‡çš„åŸå¸‚éƒ½å¯ä»¥è§£å†³ã€‚æˆ‘ä»¬é€‰æ‹©äº†ä»¥ä¸‹ä¹ä¸ªç¾å›½é¦–éƒ½åŸå¸‚ï¼Œå¹¶ç”¨å®ƒä»¬çš„ä½ç½®å‚æ•°(çº¬åº¦å’Œç»åº¦)å®šä¹‰äº†ä¸€ä¸ªæ•°æ®æ–‡ä»¶(`data_9cities.txt`)ï¼Œå¹¶ä¸ºå®ƒä»¬ç¼–åˆ¶äº†ç´¢å¼•ï¼Œä»¥ä¾¿äºç¼–ç¨‹(è¯¥æ–‡ä»¶å¯åœ¨æœ¬ä¹¦çš„ç½‘ç«™ä¸Šæ‰¾åˆ°)ã€‚

```py
0,Colorado,Denver,39.7391667,-104.984167
1,Connecticut,Hartford,41.767,-72.677
2,Delaware,Dover,39.161921,-75.526755
3,Illinois,Springfield,39.783250,-89.650373
4,Indiana,Indianapolis,39.790942,-86.147685
5,Massachusetts,Boston,42.2352,-71.0275
6,Michigan,Lansing,42.7335,-84.5467
7,New Hampshire,Concord,43.220093,-71.549127
8,New Jersey,Trenton,40.221741,-74.756138

```

æˆ‘ä»¬å®šä¹‰äº†å¦ä¸€ä¸ªæ•°æ®æ–‡ä»¶(`data_distance9.txt`)ï¼Œå…¶ä¸­æ¯å¯¹é¦–éƒ½åŸå¸‚ä¹‹é—´çš„è·ç¦»æ€»å…±ä¸º 9 Ã— 8 = 72 ä¸ªè·ç¦»(è¿™ä¸ªæ–‡ä»¶å¯ä»¥åœ¨æœ¬ä¹¦çš„ç½‘ç«™ä¸Šæ‰¾åˆ°)ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªé—®é¢˜è·¯å¾„çš„ä¾‹å­ã€‚

![$$ \left(\mathbf{0}-&gt;\mathbf{1}\right)+\left(\mathbf{1}-&gt;\mathbf{2}\right)+\left(\mathbf{2}-&gt;\mathbf{3}\right)+\left(\mathbf{3}-&gt;\mathbf{4}\right)+\left(\mathbf{4}-&gt;\mathbf{5}\right)+\left(\mathbf{5}-&gt;\mathbf{6}\right)+\left(\mathbf{6}-&gt;\mathbf{1}\right) $$](img/502577_1_En_8_Chapter_TeX_Equc.png)

æˆ–è€…

![$$ \left(\mathbf{0}-&gt;\mathbf{2}\right)+\left(\mathbf{2}-&gt;\mathbf{1}\right)+\left(\mathbf{3}-&gt;\mathbf{2}\right)+\left(\mathbf{3}-&gt;\mathbf{4}\right)+\left(\mathbf{4}-&gt;\mathbf{5}\right)+\left(\mathbf{5}-&gt;\mathbf{6}\right)+\left(\mathbf{6}-&gt;\mathbf{1}\right) $$](img/502577_1_En_8_Chapter_TeX_Equd.png)

å¦‚æœè·¯å¾„å’Œè¡Œè¿›æ—¶é—´å¯¹äºé”€å”®äººå‘˜æ¥è¯´æ˜¯ä¼˜åŒ–çš„ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ä»»ä½•å…¶ä»–ç»„åˆæ¥æœ€å¤§åŒ–ä»–ä»¬çš„é”€å”®ã€‚å½“åˆ¶å®š QUBU æ—¶ï¼Œåœ¨æˆ‘ä»¬çš„é—®é¢˜ä¸­è€ƒè™‘ä»¥ä¸‹ä¸¤ä¸ªçº¦æŸã€‚

*   é”€å”®äººå‘˜åœ¨ä»–å¼€å§‹çš„åœ°æ–¹ç»“æŸã€‚

*   ä»–æ¯ä¸ªåŸå¸‚åªå»ä¸€æ¬¡ã€‚

æœ€åˆï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘ç”¨æ•°å­¦æ–¹æ³•æ¥å»ºæ¨¡è¿™ä¸ªé—®é¢˜ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬é¦–å…ˆå®šä¹‰æˆ‘ä»¬çš„*äºŒè¿›åˆ¶å˜é‡*ã€‚

![$$ a\ast b=\left\{\begin{array}{c}1,\kern6.25em \mathrm{if}\ \mathrm{the}\ \mathrm{trip}\  includes\ \mathrm{segment}\ \mathbf{0}-&gt;1\\ {}0,\kern0.5em \mathrm{if}\ \mathrm{the}\ \mathrm{trip}\  does\ not\ include\ \mathrm{segment}\ \mathbf{0}-&gt;1\end{array}\right. $$](img/502577_1_En_8_Chapter_TeX_Eque.png)

![$$ \vdots \kern1em \vdots \kern1em \vdots \kern2.5em \vdots \kern1em \vdots \kern1em \vdots \kern2.5em \vdots \kern1em \vdots \kern1em \vdots \kern2.5em \vdots \kern1em \vdots \kern1em \vdots \kern2.5em \vdots \kern1em \vdots \kern1em \vdots $$](img/502577_1_En_8_Chapter_TeX_Equf.png)

![$$ h\ast i=\left\{\begin{array}{c}1,\kern6.25em \mathrm{if}\ \mathrm{the}\ \mathrm{trip}\  includes\ \mathrm{segment}\ \mathbf{7}-&gt;8\\ {}0,\kern0.5em \mathrm{if}\ \mathrm{the}\ \mathrm{trip}\  does\ not\ include\ \mathrm{segment}\ \mathbf{8}-&gt;7\end{array}\right. $$](img/502577_1_En_8_Chapter_TeX_Equg.png)

è¿™äº›çº¦æŸå…è®¸æˆ‘ä»¬ç”¨æ•°å­¦å…¬å¼æ¥æœ€å°åŒ–æˆ‘ä»¬çš„è·ç¦»ç®—å­![$$ \mathcal{D} $$](img/502577_1_En_8_Chapter_TeX_IEq1.png)

![$$ \mathcal{D}\left( ab\ast ab\right)+\mathcal{D}\left( ac\ast ac\right)+\cdots +\mathcal{D}\left( hi\ast hi\right) $$](img/502577_1_En_8_Chapter_TeX_Equh.png)

è®°ä½æˆ‘ä»¬çš„é™åˆ¶ï¼Œæ¯ä¸ªåŸå¸‚åœ¨æ›²æ³¢å‡ºç°ä¸¤æ¬¡â€”â€”ä¸€æ¬¡åˆ°è¾¾ï¼Œä¸€æ¬¡ç¦»å¼€ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œ

å¯¹äºåŸå¸‚ 0(ä¸¹ä½›)ï¼Œæˆ‘ä»¬æœ‰

![$$ ab+ ac+ ad+ ae+ af+ ag+ ah+ ai-2 $$](img/502577_1_En_8_Chapter_TeX_Equi.png)

å¯¹äºåŸå¸‚ 1(å“ˆç‰¹ç¦å¾·)ï¼Œæˆ‘ä»¬æœ‰

![$$ ab+ bc+ bd+ be+ bf+ bg+ bh+ bi-2 $$](img/502577_1_En_8_Chapter_TeX_Equj.png)

å¦‚æ­¤ç±»æ¨ï¼Œç›´åˆ°ç¬¬å…«ä¸ªåŸå¸‚ï¼Œä¹Ÿå°±æ˜¯ç‰¹ä¼¦é¡¿ã€‚

æ—¢ç„¶æˆ‘ä»¬å·²ç»å®šä¹‰äº†é¢„å¤‡å·¥ä½œï¼Œæˆ‘ä»¬å¿…é¡»åˆ¶å®šçº¦æŸå’Œç›®æ ‡(æ–¹ç¨‹å¼)7ã€‚27 ã€‚

![$$ Obj\equiv \mathit{\min}\ \left(\mathcal{D}\left( ab\ast ab\right)+\mathcal{D}\left( ac\ast ac\right)+\cdots +\mathcal{D}\left( hi\ast hi\right)\right) $$](img/502577_1_En_8_Chapter_TeX_Equk.png)

å…¶ä¸­ï¼Œ *min* ä»£è¡¨*æœ€å°åŒ–*ã€‚*æœ€å°åŒ–*çš„åŠ¨ä½œå¯»æ‰¾è¾¹ä¹‹é—´çš„æœ€çŸ­è·ç¦»ï¼Œè¿™å‘ç”Ÿåœ¨ç›¸ç­‰æ—¶ã€‚ä½¿ç”¨æ­£æ–¹å½¢æ˜¯ä¸ºäº†æ¶ˆé™¤è´Ÿè·ç¦»ã€‚*çº¦æŸ*ç”±ä¸‹å¼ç»™å‡º

![$$ {\left( ab+ ac+ ad+ ae+ af+ ag+ ah+ ai-2\right)}Â² $$](img/502577_1_En_8_Chapter_TeX_Equl.png)

![$$ {\left( ab+ bc+ bd+ be+ bf+ bg+ bh+ bi-2\right)}Â² $$](img/502577_1_En_8_Chapter_TeX_Equm.png)

![$$ \vdots \kern1em \vdots \kern1em \vdots \kern1em \vdots \kern1em \vdots \kern1em \vdots \kern1em \vdots \kern1em \vdots \kern1em \vdots $$](img/502577_1_En_8_Chapter_TeX_Equn.png)

![$$ {\left( ai+ bi+ ci+ di+ ei+ fi+ gi+ hi-2\right)}Â² $$](img/502577_1_En_8_Chapter_TeX_Equo.png)

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ç»“åˆç›®æ ‡å’Œçº¦æŸæ¥åˆ¶å®šæˆ‘ä»¬çš„æ›²æ³¢ã€‚

![$$ \mathrm{QUBO}= objectives+\gamma (constraints) $$](img/502577_1_En_8_Chapter_TeX_Equp.png)

å…¶ä¸­ï¼Œ *Î³* æ˜¯ä¸€ä¸ªæ‹‰æ ¼æœ—æ—¥å‚æ•°ï¼Œå¯ä»¥å¯¹å…¶è¿›è¡Œè°ƒæ•´ä»¥è·å¾—æœ€ä½³ç»“æœã€‚

æœ‰äº†è¿™ä¸ªï¼Œæˆ‘ä»¬å¼€å§‹ç»ƒä¹  Jupyter ç¬”è®°æœ¬æ–‡ä»¶`TSP_9City_Dwave.ipynb`,å¯ä»¥ä»è¯¥ä¹¦çš„ç½‘ç«™ä¸‹è½½ã€‚ç¬¬ä¸€ä¸ªä»£ç ç‰‡æ®µæ˜¯åº“å’Œå¯è§†åŒ–å·¥å…·ã€‚

![img/502577_1_En_8_Figb_HTML.jpg](img/502577_1_En_8_Figb_HTML.jpg)

```py
## Libraries & visualization tools for us to use.
import networkx as nx
import pylab
import matplotlib.pyplot as plt
from matplotlib.pyplot import pause
import sys
from bokeh.sampledata import us_states
from bokeh.plotting import *
from bokeh.models import Plot, Range1d, MultiLine, Circle, HoverTool, TapTool, BoxSelectTool
from bokeh.io import output_notebook
from bokeh.palettes import Spectral4
from bokeh.models.graphs import from_networkx, NodesAndLinkedEdges, EdgesAndLinkedNodes
output_notebook()
%matplotlib inline
import argparse
import re

Listing 8-1aLibraries and Pauli 

Matrices for TSP_9City_Dwave.ipynb

```

è¿™é‡Œçš„`bokeh`æŒ‡çš„æ˜¯ä¸ºç°ä»£ç½‘ç»œæµè§ˆå™¨åˆ›å»ºäº¤äº’å¼å¯è§†åŒ–çš„ Python åº“ã€‚åœ¨æˆ‘ä»¬çš„ç»ƒä¹ ä¸­ï¼Œæˆ‘ä»¬ç”¨å®ƒæ¥åˆ›å»ºä¸€å¼ ç¾å›½åœ°å›¾å’Œæ—…è¡Œè¿‡çš„åŸå¸‚çš„åœ°å›¾ã€‚

ä¸‹ä¸€ä¸ªä»»åŠ¡æ˜¯è®¾ç½®é—®é¢˜ä¸­åŸå¸‚çš„æ•°é‡å’Œä¸€ä¸ªç´¢å¼•å‡½æ•°ã€‚äºŒå…ƒå˜é‡æ˜¯*x*<sub>T3ã€‘Iï¼Œ *j*</sub> = 1 å½“ä¸”ä»…å½“åœ¨åœé ç‚¹ *j* è®¿é—®åŸå¸‚ *i* æ—¶ã€‚æ›²æ³¢å­—å…¸/çŸ©é˜µæ˜¯*N*T14ã€‘2Ã—*N*T18ã€‘2ï¼Œå› æ­¤ï¼Œè¿™äº›å˜é‡å¿…é¡»è¢«èµ‹äºˆè¡Œå’Œåˆ—ç´¢å¼•ã€‚å‡½æ•° *x* ( *a* ï¼Œ *b* )ç»™ *x* <sub>*a* ï¼Œ *b*</sub> å˜é‡åˆ†é…ä¸€ä¸ªæ›²æ³¢çŸ©é˜µç´¢å¼•ã€‚

```py
# Number of cities in our problem
N = 9
# Function to compute index in Q for variable x_(a,b)
def x(a, b):
    return (a)*N+(b)

Listing 8-1bMatrix for TSP_9City_Dwave.ipynb

```

åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæœ‰ä¸¤ä¸ª*æ‹‰æ ¼æœ—æ—¥å‚æ•°*ã€‚

*   *A* æˆ–`gamma`æ˜¯æ ‡å‡†çš„æ‹‰æ ¼æœ—æ—¥å‚æ•°ï¼Œè¡¨ç¤ºæˆ‘ä»¬çš„çº¦æŸåœ¨æˆ‘ä»¬çš„è§£å†³æ–¹æ¡ˆçš„è´¨é‡ä¸­æœ‰å¤šé‡è¦ã€‚è¿™å¯ä»¥å¾®è°ƒä»¥è·å¾—æœ€ä½³ç»“æœã€‚è¿™å†³å®šäº†æ˜¯æ»¡è¶³çº¦æŸæ¡ä»¶æ›´é‡è¦è¿˜æ˜¯æ‰¾åˆ°æœ€çŸ­è·ç¦»æ›´é‡è¦ã€‚å¯¹äºè¿™ä¸ªé—®é¢˜ï¼Œè‡³å…³é‡è¦çš„æ˜¯æˆ‘ä»¬è¦è®¿é—®è·¯çº¿ä¸Šçš„æ¯ä¸ªåŸå¸‚ï¼Œæ‰€ä»¥æˆ‘ä»¬åº”è¯¥å°†è¿™ä¸ªå‚æ•°è®¾ç½®ä¸ºå¤§äºä¸¤ä¸ªåŸå¸‚ä¹‹é—´çš„æœ€å¤§è·ç¦»ã€‚

*   ğµæŒ‡å‡ºäº†ç›®æ ‡å‡½æ•°åœ¨æˆ‘ä»¬çš„æ›²æ³¢ä¸­çš„é‡è¦æ€§ã€‚ä¸€èˆ¬æˆ‘ä»¬å®šä¹‰ *B* = 1ï¼Œä¿®æ”¹ *A* ä¸­çš„å€¼ã€‚

ä¹Ÿå¯ä»¥è°ƒæ•´ä»¥ä¸‹å‚æ•°ã€‚

*   **é“¾å¼ºåº¦** ( `chainstrength`):è¿™å‘Šè¯‰åµŒå…¥å‡½æ•°å°†ç‰©ç†é‡å­ä½çš„é“¾æ†ç»‘åœ¨ä¸€èµ·å½¢æˆä¸€ä¸ªé€»è¾‘é‡å­ä½çš„å¼ºåº¦ã€‚è¿™åº”è¯¥å¤§äºæ›²æ³¢ä¸­çš„ä»»ä½•å…¶ä»–å€¼ã€‚

*   **è¿è¡Œæ¬¡æ•°** ( `numruns`):è¿™å‘Šè¯‰ç³»ç»Ÿæˆ‘ä»¬çš„é—®é¢˜è¦è¿è¡Œå¤šå°‘æ¬¡ã€‚ç”±äº D æ³¢ QPU çš„æ¦‚ç‡æ€§è´¨ï¼Œæˆ‘ä»¬åº”è¯¥å¤šæ¬¡è¿è¡Œè¯¥é—®é¢˜ï¼Œå¹¶å¯»æ‰¾æ‰¾åˆ°çš„æœ€ä½³è§£å†³æ–¹æ¡ˆã€‚

è¿™æ®µä»£ç ä¸ä¼šåœ¨ç‰©ç† QPU ä¸Šè¿è¡Œï¼Œè€Œæ˜¯ç¦»çº¿æˆ–ä¼ ç»Ÿåœ°ä½¿ç”¨`qbsolv`ã€‚`numruns`ç»å¸¸è¿è¡Œ`qbsolv`ï¼Œä½†æ˜¯*é“¾å¼ºåº¦*ä¸ä¼šå½±å“æ ·æœ¬ï¼Œé™¤éæˆ‘ä»¬ä¿®æ”¹ä»£ç ä½¿ç”¨ QPUã€‚

```py
# Gamma = A
A = 6500
B = 1
chainstrength = 3000
# Number of runs
numruns = 100

Listing 8-1cTunable Parameters TSP_9City_Dwave.ipynb

```

æ¥ä¸‹æ¥ï¼Œåˆ©ç”¨åŸå¸‚ä½ç½®`data_9cities.txt, the`ç¬¬ä¸€ä¸ªæ•°æ®æ–‡ä»¶ï¼Œæˆ‘ä»¬ç”Ÿæˆç¾å›½åœ°å›¾ã€‚é”€å”®äººå‘˜å»è¿‡çš„åŸå¸‚ç”¨çº¢è‰²æ ‡å‡ºã€‚

```py
us_states = us_states.data.copy()
# Delete states Hawaii and Alaska from mainland map
del us_states["HI"]
del us_states["AK"]
# separate latitude and longitude points for the borders
#   of the states.
state_xs = [us_states[code]["lons"] for code in us_states]
state_ys = [us_states[code]["lats"] for code in us_states]
with open('data_9cities.txt', "r") as myfile:
    city_text = myfile.readlines()
    myfile.close()
cities = [',']*N
states = [',']*N
lats=[]
longs=[]
for i in city_text:
    index, state, city,lat,lon = i.split(',')
    cities[int(index)] = city.rstrip()
    states[int(index)] = state
    lats.append(float(lat))
    longs.append(float(lon))

# init figure
p = figure(title="Find shortest route that visits each city",
           toolbar_location="left", plot_width=550, plot_height=350)
# Draw state lines
p.patches(state_xs, state_ys, fill_alpha=0.0,
    line_color='blue', line_width=1.5)
# The scatter markers
p.circle(longs, lats, size=10, color='red', alpha=1)
show(p)

Listing 8-1dMap

of the cities TSP_9City_Dwave.ipynb

```

è¿™æ®µä»£ç ç”Ÿæˆäº†å¦‚å›¾ 8-2 æ‰€ç¤ºçš„ç¾å›½åœ°å›¾ï¼Œçªå‡ºæ˜¾ç¤ºäº† bokeh æä¾›çš„ä¹ä¸ªåŸå¸‚ã€‚

![img/502577_1_En_8_Fig2_HTML.jpg](img/502577_1_En_8_Fig2_HTML.jpg)

å›¾ 8-2

å‚è§‚è¿‡çš„ä¹ä¸ªåŸå¸‚çš„åœ°å›¾

ç°åœ¨æˆ‘ä»¬æœ‰äº†åŸºç¡€åœ°å›¾ï¼Œæˆ‘ä»¬é€šè¿‡æ–‡ä»¶`data_distance9.txt`ä¸Šä¼ åŸå¸‚é—´çš„è·ç¦»ã€‚

```py
# Input file containing inter-city distances
fn = "data_distance9.txt"

# check that the user has provided input file
try:
  with open(fn, "r") as myfile:
    distance_text = myfile.readlines()
    myfile.close()
except IOError:
  print("Input distance file missing")
  exit(1)

Listing 8-1eInter-City Distances TSP_9City_Dwave.ipynb

```

è·ç¦»å­˜å‚¨åœ¨ä¸€ä¸ª *N* Ã— *N* çŸ©é˜µä¸­ã€‚çŸ©é˜µåœ¨å¯¹è§’çº¿ä¸Šæœ‰é›¶ç‚¹ã€‚ä»ä¸€ä¸ªåŸå¸‚(ä¾‹å¦‚ 0)åˆ°ä¸‹ä¸€ä¸ªåŸå¸‚(ä¾‹å¦‚ 1)çš„è·ç¦»åœ¨æ¡ç›®![$$ \mathcal{D}\left(a,b\right) $$](img/502577_1_En_8_Chapter_TeX_IEq2.png)ä¸­ï¼Œå› ä¸ºå½“åœ¨ä¸¤ä¸ªåŸå¸‚ä¹‹é—´çš„ä»»ä¸€æ–¹å‘æ—…è¡Œæ—¶ï¼Œè·ç¦»æ˜¯ç›¸åŒçš„ã€‚çŸ©é˜µæ˜¯å¯¹ç§°çš„ã€‚

```py
# Initialize matrix of correct size with all 0's
D = [[0 for z in range(N)] for y in range(N)]
# Read in distance values and enter in matrix
for i in distance_text:
  if re.search("^between", i):
    m = re.search("^between_(\d+)_(\d+) = (\d+)", i)
    citya = int(m.group(1))
    cityb = int(m.group(2))
    D[citya][cityb] = D[cityb][citya] = int(m.group(3))

Listing 8-1fCreate the Matrix TSP_9City_Dwave.ipynb

```

åœ¨ä¸‹ä¸€æ­¥ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡åˆ›å»ºä¸€ä¸ªæ‰€æœ‰å€¼éƒ½åˆå§‹åŒ–ä¸º 0 çš„ç©º Q çŸ©é˜µï¼Œå¼€å§‹å¼€å‘è¿™ä¸ªé—®é¢˜çš„æ›²æ³¢ã€‚

```py
Q = {}
for i in range(N*N):
    for j in range(N*N):
        Q.update({(i,j): 0})

Listing 8-1gQ-matrix TSP_9City_Dwave.ipynb

```

ä¸‹ä¸€ä¸ªä»£ç å—å®šä¹‰äº†åœ¨ç½®æ¢çŸ©é˜µä¸­æ¯è¡Œæ°å¥½æœ‰*ä¸ª* 1 çš„çº¦æŸã€‚å¯¹äºç¬¬ 1 è¡Œï¼Œæ­¤çº¦æŸæ¡ä»¶ä¸º

![$$ A{\left(\sum \limits_{j=1}â¹{x}_{1,j}-1\right)}Â²\equiv \sum \limits_{j=1}â¹-A{x}_{1,j}+\sum \limits_{j=1}â¹\sum \limits_{k=j+1}â¹Â²A{x}_{1,j}{x}_{1,k} $$](img/502577_1_En_8_Chapter_TeX_Equq.png)

```py
for v in range(N):
    for j in range(N):
        Q[(x(v,j), x(v,j))] += -1*A
        for k in range(j+1, N):
            Q[(x(v,j), x(v,k))] += 2*A

Listing 8-1hPermutation Matrix TSP_9City_Dwave.ipynb

```

ä¸‹ä¸€æ­¥æ˜¯å¼€å‘æ›²æ³¢ã€‚ä¸»è¦ç›®æ ‡æ˜¯æœ€å°åŒ–è¡Œè¿›çš„è·ç¦»ã€‚

è€ƒè™‘è¿™æ ·çš„æƒ…å†µï¼Œæ—…è¡Œçš„é”€å”®äººå‘˜åœ¨ç¬¬ 3 ç«™è®¿é—®åŸå¸‚ *u* ï¼Œåœ¨ç¬¬ 4 ç«™è®¿é—®åŸå¸‚ *v* ã€‚ç„¶åï¼Œä»–åœ¨è¿™ä¸€æ®µæ—…è¡Œçš„è·ç¦»æ˜¯![$$ \mathcal{D}\left(u,v\right){x}_{u,3}{x}_{v,4} $$](img/502577_1_En_8_Chapter_TeX_IEq3.png)ã€‚å¦‚æœä»–åœ¨ç¬¬ 3 ç«™è®¿é—®åŸå¸‚ *u* å¹¶åœ¨ç¬¬ 4 ç«™è®¿é—®åŸå¸‚ *v* ï¼Œåˆ™æ€»è·ç¦»å¢åŠ ![$$ \mathcal{D}\left(u,v\right) $$](img/502577_1_En_8_Chapter_TeX_IEq4.png)ï¼Œå¦åˆ™æ€»è·ç¦»å¢åŠ  0ã€‚å› æ­¤ï¼Œå¯¹äºæ¯ä¸€å¯¹åŸå¸‚ï¼Œ *u* å’Œ *v* ï¼Œæˆ‘ä»¬æ·»åŠ ![$$ \sum \limits_{j=1}â¹\mathcal{D}\left(u,v\right){x}_{u,j}{x}_{v,j+1}. $$](img/502577_1_En_8_Chapter_TeX_IEq5.png)è¿™å°†æ·»åŠ ä»åŸå¸‚ *u* å’Œ *v* åˆ°æ€»è·¯çº¿çš„ç›´æ¥è¡Œé©¶è·ç¦»ã€‚åŒå‘ä¸­çš„æ¯ä¸ª *u* å’Œ *v* é€‰é¡¹éƒ½éœ€è¦æ·»åŠ ã€‚

```py
for u in range(N):
    for v in range(N):
        if u!=v:
            for j in range(N):
                Q[(x(u,j), x(v,(j+1)%N))] += B*D[u][v]

Listing 8-1iAdd Distance objective TSP_9City_Dwave.ipynb

```

#### è¿è¡Œé—®é¢˜

ç°åœ¨æˆ‘ä»¬ç¦»çº¿è¿è¡Œ qbsolvã€‚qbsolv <sup>3</sup> æ˜¯ä¸€ä¸ªé—®é¢˜åˆ†è§£å·¥å…·ï¼Œå®ƒæ—¢å¯ä»¥ç»å…¸çš„ç¦»çº¿è¿è¡Œ(ä¾‹å¦‚åœ¨æˆ‘ä»¬çš„ç¬”è®°æœ¬ç”µè„‘ä¸Š)ï¼Œä¹Ÿå¯ä»¥ä»¥ç»å…¸å’Œ QPU çš„æ··åˆæ–¹å¼è¿è¡Œã€‚

```py
from dwave_qbsolv import QBSolv
resp = QBSolv().sample_qubo(Q)

Listing 8-1jRun qbsolve TSP_9City_Dwave.ipynb

```

ä¸‹ä¸€æ­¥ï¼Œæˆ‘ä»¬åš*åå¤„ç†*ã€‚ä¸€æ—¦`qbsolv`è¿è¡Œï¼Œæˆ‘ä»¬æ”¶é›†ç»“æœå¹¶æŠ¥å‘Šæ‰¾åˆ°çš„æœ€ä½³ç­”æ¡ˆã€‚è¿™é‡Œï¼Œæˆ‘ä»¬åˆ—å‡ºäº†æ‰¾åˆ°çš„æœ€ä½èƒ½è€—è§£å†³æ–¹æ¡ˆã€é”€å”®äººå‘˜è·¯çº¿ä¸­åŸå¸‚çš„è®¿é—®é¡ºåºï¼Œä»¥åŠè¿™æ¡è·¯çº¿æ‰€éœ€çš„æ€»é‡Œç¨‹ã€‚æˆ‘ä»¬åœ¨æ­¤è¾“å‡ºä¸­åŒ…å«äº†ä¸€äº›æœ‰æ•ˆæ€§æ£€æŸ¥ï¼ŒæŒ‡ç¤ºæŸä¸ªç«™ç‚¹æ˜¯å¦è¢«åˆ†é…ç»™å¤šä¸ªåŸå¸‚ï¼Œä»¥åŠæŸä¸ªç«™ç‚¹æ˜¯å¦æ²¡æœ‰åˆ†é…åŸå¸‚ã€‚

```py
# First solution is the lowest energy solution found
sample = next(iter(resp))
# Display energy for best solution found
print('Energy: ', next(iter(resp.data())).energy)
# Print route for solution found
route = [-1]*N
for node in sample:
    if sample[node]>0:
        j = node%N
        v = (node-j)/N
        if route[j]!=-1:
            print('Stop '+str(i)+' used more than once.\n')
        route[j] = int(v)
# Compute and display total mileage
mileage = 0
for i in range(N):
    mileage+=D[route[i]][route[(i+1)%N]]
print('Mileage: ', mileage)
print('\nRoute:\n')
for i in range(N):
    if route[i]!=-1:
        print(str(i) + ':  ' +cities[route[i]]+ ',' + states[route[i]] + '\n')
    else:
        print(str(i) + ':  No city assigned.\n')

Listing 8-1kAdd Distance Objective TSP_9City_Dwave.ipynb

```

è¿™ä¸ªè¿è¡Œåœ¨ qbsolve ä¸Šçš„ä»£ç ç‰‡æ®µä»¥æœ€ä½çš„èƒ½è€—ã€æ€»é‡Œç¨‹å’Œè·¯çº¿ç»™å‡ºäº†æˆ‘ä»¬æƒ³è¦çš„è¾“å‡ºã€‚

![img/502577_1_En_8_Figc_HTML.jpg](img/502577_1_En_8_Figc_HTML.jpg)

è¯·æ³¨æ„ï¼Œç”±äºè®¡ç®—çš„æ¦‚ç‡æ€§è´¨ï¼Œæ‰€è®¿é—®åŸå¸‚çš„é¡ºåºå¯èƒ½ä¼šå› è¿è¡Œè€Œå¼‚ã€‚é¼“åŠ±ä½ å°†æ‹‰æ ¼æœ—æ—¥å€¼ä»ä½å˜é«˜ï¼Œå¹¶è§‚å¯Ÿè®¡ç®—å‡ºçš„æœ€ä½èƒ½é‡çš„å˜åŒ–ã€‚é€šå¸¸ï¼Œå‚æ•° *A* çš„å€¼è¢«è®¾ç½®ä¸ºå¤§äºä¸¤ä¸ªåŸå¸‚ä¹‹é—´çš„æœ€å¤§è·ç¦»ã€‚

è®©æˆ‘ä»¬è¿è¡Œä¸€äº›æ£€æŸ¥æ¥éªŒè¯æˆ‘ä»¬çš„ç»“æœæ˜¯æœ‰æ•ˆçš„ã€‚

*   å¦‚æœæ¯ä¸ªåŸå¸‚åœ¨æˆ‘ä»¬çš„åˆ—è¡¨ä¸­æ°å¥½å‡ºç°ä¸€æ¬¡ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„è·¯çº¿åˆ—è¡¨ç”±æ•°å­— 0ã€1ã€2â€¦â€¦(*N*-1)æŒ‰ç…§ä¸€å®šçš„é¡ºåºç»„æˆï¼Œæ€»è®¡ä¸º*N*(*N*-1)/2ã€‚å¦‚æœè¿™ä¸ªæ€»æ•°ä¸æ­£ç¡®ï¼Œæˆ‘ä»¬çš„è·¯çº¿å°±æ— æ•ˆã€‚

*   éªŒè¯æ˜¯å¦æ¯ä¸ªåŸå¸‚éƒ½æœ‰æŒ‡å®šçš„ç«™ç‚¹ï¼Œåä¹‹äº¦ç„¶ã€‚å¦‚æœæ²¡æœ‰ï¼Œæˆ‘ä»¬æ‰“å°ä¸€æ¡æ¶ˆæ¯ç»™ç”¨æˆ·ï¼Œè®©ä»–ä»¬çŸ¥é“ã€‚

```py
alert = 0
if sum(route)!=N*(N-1)/2:
    print('Route invalid.\n')

for i in range(N):
    if route[i]==-1:
        print('Stop '+str(i)+' has no city assigned.')

if alert==0:
    print("Route valid.")

Listing 8-1lVerify If Route Is Valid TSP_9City_Dwave.ipynb

```

åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œä»£ç å—éªŒè¯è·¯ç”±æ˜¯æœ‰æ•ˆçš„ã€‚

![img/502577_1_En_8_Figd_HTML.jpg](img/502577_1_En_8_Figd_HTML.jpg)

æœ€åçš„ä»£ç å—å°†æ‰¾åˆ°çš„è·¯çº¿å¯è§†åŒ–ã€‚

```py
Path = nx.Graph()
coord={}
coord[route[0]]=(longs[route[0]],lats[route[0]])
Path.add_node(cities[route[0]],pos=coord[route[0]],label=cities[route[0]])

for i in range(N-1):
    e=(cities[route[i]],cities[route[i+1]])
    Path.add_edge(*e)
    coord[route[i+1]]=(longs[route[i+1]],lats[route[i+1]])
    Path.add_node(cities[route[i+1]],pos=coord[route[i+1]],label=cities[route[i+1]])

e=(cities[route[N-1]],cities[route[0]])
Path.add_edge(*e)

fig, ax = plt.subplots(figsize=(120,60))
margin=0.15
fig.subplots_adjust(margin, margin, 1.-margin, 1.-margin)
ax.axis('equal')
nx.draw(Path, nx.get_node_attributes(Path, 'pos'), with_labels=True, width=10, edge_color='b', node_size=200,font_size=72,font_weight='bold', ax=ax)
plt.show()

Listing 8-1mVisualization of the Route TSP_9City_Dwave.ipynb

```

æœ€åä¸€ä¸ªä»£ç å—ç»™å‡ºäº†åœ°å›¾ä¸Šè·¯å¾„çš„å¯è§†åŒ–è¾“å‡ºã€‚

![img/502577_1_En_8_Fige_HTML.jpg](img/502577_1_En_8_Fige_HTML.jpg)

æˆ‘ä»¬é¼“åŠ±æ‚¨å°†æ•°æ®æ–‡ä»¶(`data_9cities.txt`å’Œ`data_distance9.txt`)ä¿®æ”¹ä¸ºæ›´å¤šçš„åŸå¸‚åŠå…¶åæ ‡ã€é¢å¤–çš„åŸå¸‚é—´è·ç¦»ï¼Œå¹¶å¤šæ¬¡å°è¯•å¯è§†åŒ–ã€‚éšç€åŸå¸‚æ•°é‡çš„å¢åŠ ï¼Œæ¯æ¬¡è·‘æ­¥çš„è§†è§‰æ•ˆæœå¯èƒ½ä¼šæœ‰æ‰€ä¸åŒã€‚

å¦‚æœä½ æœ‰å…´è¶£ä½“éªŒçœŸæ­£çš„é‡å­ä½è®¡ç®—ä»£ç ï¼ŒD-Wave åœ¨ Leap ( [`https://cloud.dwavesys.com/leap/`](https://cloud.dwavesys.com/leap/) )ä¸Šæä¾›æœ‰é™çš„å…è´¹ç”¨æˆ·é…é¢â€”â€”åŸºäºäº‘çš„ç¡¬ä»¶å¹³å°è®¿é—®ã€‚å¦‚ç¬¬ 1 å’Œ 7 ç« æ‰€è¿°ï¼Œæ¥è‡ª 38 ä¸ªå›½å®¶(ç›®å‰)çš„ç”¨æˆ·å¯ä»¥åœ¨ Leap æ³¨å†Œå…è´¹è´¦æˆ·ï¼Œå¹¶åˆ©ç”¨å¤§é‡çš„åŸ¹è®­ææ–™ã€æ–‡æ¡£ã€å¼€å‘è€…èµ„æºç­‰ç­‰ã€‚ä¸€æ—¦æ‚¨ç™»å½•åˆ° Leap å¹³å°ï¼Œä»–ä»¬éœ€è¦åœ¨ç¬¬ä¸€ä¸ªç™»å½•å±å¹•ä¸Šå‘ä¸‹æ»šåŠ¨ã€‚å·¦ä¸‹è§’æœ‰ä¸€ä¸ªå¸¦æœ‰ API ä¿¡æ¯çš„æ¡†ï¼Œå¯ä»¥å¤åˆ¶å¹¶ç”¨äºè¿›è¡Œ API è°ƒç”¨ï¼Œä»¥åˆ©ç”¨ D-Wave çš„å®é™… QPUã€‚

![img/502577_1_En_8_Figf_HTML.jpg](img/502577_1_En_8_Figf_HTML.jpg)

è¦ä½¿ç”¨ qbsolve è°ƒç”¨ QPU æ¥è§£å†³æœ¬èŠ‚ä¸­çš„ TSP é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ä»£ç å—ã€‚

```py
from dwave.system.composites import EmbeddingComposite
from dwave.system.samplers import DWaveSampler

sampler = DWaveSampler(solver={'qpu': True})  # Some accounts need to replace this line with the next:
sampler = EmbeddingComposite(DWaveSampler(token = 'my_token', solver=dict(name='solver_name')))
print("Connected to QPU.")

```

è“è‰²çš„ä¸¤ä¸ªä»£ç è¡Œåœ¨éæ­¤å³å½¼çš„åŸºç¡€ä¸Šä½¿ç”¨ã€‚å¯¹äºå¤§å¤šæ•°ç”¨æˆ·æ¥è¯´ï¼Œéœ€è¦ API ä»¤ç‰Œçš„ç¬¬äºŒè¡Œæ˜¯æœ‰æ•ˆçš„ã€‚API ä»¤ç‰Œä» Leap æ¥å£å¤åˆ¶å¹¶è¾“å…¥åˆ°`<my_token>`ä¸­ï¼Œä»¥ä¿æŠ¤åˆ°å®é™… QPU çš„è¿æ¥ã€‚ä½¿ç”¨ qbsolve æ—¶ï¼Œåç§°çš„å€¼ç”±`name='qbsolve'.`ç»™å‡º

è®©æˆ‘ä»¬å‰è¿›åˆ°é‡å­é¢†åŸŸçš„æ·±åº¦å­¦ä¹ æ–¹æ³•è®ºã€‚*é‡å­æ·±åº¦å­¦ä¹ *ä»Šå¤©æœ‰å‡ ä¸ªå®ç°ï¼›é™¤äº† D-Waveï¼Œè¿˜æœ‰ Google çš„ TensorFlow Quantum å’Œ Xanadu çš„ PennyLaneã€‚

## é‡å­æ·±åº¦ç¥ç»ç½‘ç»œ

ç»å…¸æ·±åº¦ç¥ç»ç½‘ç»œæ˜¯æœºå™¨å­¦ä¹ çš„æœ‰æ•ˆå·¥å…·ï¼Œä¹Ÿæ˜¯å‘å±•æ·±åº¦é‡å­å­¦ä¹ æ–¹æ³•çš„åŸºç¡€ã€‚æœ€ç®€å•çš„ç”¨äºé‡åŒ–çš„æ·±åº¦ç¥ç»ç½‘ç»œæ˜¯ç»å°”å…¹æ›¼æœºå™¨[139]ã€‚ç»å…¸ç»å°”å…¹æ›¼æœºå™¨(é˜¿å…‹åˆ©ç­‰äºº 1985 å¹´[168]ï¼›Du å’Œ Swamy 2019 [169])ä¸ºæ¦‚ç‡åˆ†å¸ƒå»ºæ¨¡æä¾›äº†ä¸€ä¸ªå¼ºå¤§çš„æ¡†æ¶ã€‚è¿™äº›ç±»å‹çš„ç¥ç»ç½‘ç»œä½¿ç”¨æ— å‘å›¾ç»“æ„æ¥ç¼–ç ç›¸å…³ä¿¡æ¯ã€‚ç›¸åº”çš„ä¿¡æ¯å­˜å‚¨åœ¨ç½‘ç»œèŠ‚ç‚¹çš„åç½®ç³»æ•°å’Œè¿æ¥æƒé‡ä¸­ï¼Œè¿™äº›ç½‘ç»œèŠ‚ç‚¹é€šå¸¸ä¸äºŒè¿›åˆ¶è‡ªæ—‹ç³»ç»Ÿç›¸å…³ï¼Œå¹¶è¢«åˆ†ç»„ä¸ºç¡®å®šè¾“å‡ºçš„é‚£äº›:å¯è§èŠ‚ç‚¹ï¼›è¿˜æœ‰é‚£äº›ä½œä¸ºæ½œåœ¨å˜é‡çš„:éšè—èŠ‚ç‚¹ã€‚ç½‘ç»œç»“æ„é“¾æ¥åˆ°*èƒ½é‡å‡½æ•°*ï¼Œå…¶é€šè¿‡ä½¿ç”¨æ¥è‡ªç»Ÿè®¡åŠ›å­¦çš„æ¦‚å¿µ(å³*å‰å¸ƒæ–¯çŠ¶æ€*)æ¥ä¿ƒè¿›åœ¨å¯èƒ½çš„èŠ‚ç‚¹é…ç½®ä¸Šæ¦‚ç‡åˆ†å¸ƒçš„*å®šä¹‰(Boltzmann 1877ã€170ã€‘ï¼›å‰å¸ƒæ–¯ 1902 [171])ã€‚*

ç»å…¸ç»å°”å…¹æ›¼æœº <sup>4</sup> ç”±ç›¸äº’ä½œç”¨å¯è°ƒçš„éƒ¨ä»¶ç»„æˆã€‚é€šè¿‡è°ƒæ•´è¿™äº›ç›¸äº’ä½œç”¨æ¥è®­ç»ƒç»å°”å…¹æ›¼æœºå™¨ï¼Œä»¥ä¾¿ç”±*ç»å°”å…¹æ›¼â€“å‰å¸ƒæ–¯åˆ†å¸ƒ*(è§å›¾ 7-11b )æè¿°çš„æ¯”ç‰¹çš„çƒ­ç»Ÿè®¡å†ç°æ•°æ®çš„ç»Ÿè®¡ã€‚ä¸ºäº†é‡å­åŒ–ç»å°”å…¹æ›¼æœºå™¨ï¼Œç¥ç»ç½‘ç»œè¢«è¡¨ç¤ºä¸ºå¯¹åº”äºå¯è°ƒè°ä¼Šè¾›æ¨¡å‹çš„ä¸€ç»„ç›¸äº’ä½œç”¨çš„é‡å­è‡ªæ—‹ã€‚ç”¨ä½œç»å°”å…¹æ›¼æœºå™¨è¾“å…¥çš„ç¥ç»å…ƒè¢«åˆå§‹åŒ–ä¸ºå›ºå®šçŠ¶æ€ï¼›åœ¨æ­¤ä¹‹åï¼Œç³»ç»Ÿå¯ä»¥çƒ­åŒ–ï¼Œå¹¶ä¸”è¾“å‡ºé‡å­ä½ä½œä¸ºç»“æœè¢«è¯»å–ã€‚æ·±åº¦é‡å­å­¦ä¹ çš„ä¸€ä¸ªå¸å¼•äººçš„ç‰¹ç‚¹æ˜¯ï¼Œå®ƒä¸éœ€è¦å¤§å‹é€šç”¨é‡å­è®¡ç®—æœºã€‚

ä¹‹å‰æˆ‘ä»¬è®¨è®ºäº†ä¸“ç”¨é‡å­ä¿¡æ¯å¤„ç†å™¨ï¼Œå¦‚é‡å­é€€ç«å™¨ï¼Œå®ƒä»¬éå¸¸é€‚åˆæ„å»ºæ·±åº¦é‡å­å­¦ä¹ ç½‘ç»œ[164ï¼Œ165ï¼Œ166]ã€‚æœ¬ç« è¿˜ç€çœ¼äºåŸºäºå¯ç¼–ç¨‹å…‰å­ç”µè·¯çš„é‡å­ç³»ç»Ÿï¼Œå› ä¸ºå®ƒä»¬å¯¹äºåˆ›å»ºé«˜æ•ˆçš„é‡å­æ·±åº¦å­¦ä¹ ç½‘ç»œä¹Ÿæ˜¯æœ‰ç”¨çš„ã€‚

ç»å…¸ç¥ç»ç½‘ç»œæ¶‰åŠç¥ç»å…ƒçš„å¤„ç†ã€ç¥ç»å…ƒæ‰§è¡Œçš„è½¬æ¢ã€ç¥ç»å…ƒä¹‹é—´çš„äº’è¿ã€ç¥ç»ç½‘ç»œåŠ¨åŠ›å­¦å’Œå­¦ä¹ è§„åˆ™ã€‚ç¥ç»ç½‘ç»œå­¦ä¹ è§„åˆ™æ§åˆ¶ç¥ç»ç½‘ç»œè¿æ¥å¼ºåº¦çš„å˜åŒ–ã€‚ç¥ç»ç½‘ç»œé€šè¿‡ç›‘ç£æˆ–æ— ç›‘ç£æ–¹å¼çš„è®­ç»ƒæ¥åŒºåˆ†ã€‚ç¥ç»ç½‘ç»œå¯ä»¥ä½¿ç”¨å•ä¸ªç³»ç»Ÿæ¥ä¿å­˜ä¸åŒç±»åˆ«çš„æ•°æ®ï¼Œå¹¶ä»¥åˆ†å¸ƒå¼æ–¹å¼å¯¹åˆºæ¿€è¿›è¡Œåˆ†ç±»ã€‚å› æ­¤ï¼Œç¥ç»ç½‘ç»œåœ¨åˆ›å»ºåˆ†ç±»ç³»ç»Ÿæ–¹é¢éå¸¸æœ‰ç”¨ã€‚

é‡å­æ€ä¸­çš„ç›¸å¹²æ€§è¢«ç§°ä¸º*å åŠ *ï¼Œè¢«è®¤ä¸ºç±»ä¼¼äºç»å…¸ç¥ç»ç½‘ç»œä¸­çš„ç¥ç»å…ƒã€‚é‡å­è®¡ç®—ä¸­çš„æµ‹é‡åŠŸèƒ½ç±»ä¼¼äºç»å…¸ç¥ç»ç½‘ç»œä¸­çš„äº’è¿ã€‚ç¥ç»ç½‘ç»œä¸­çš„å¢ç›Šå‡½æ•°ç±»ä¼¼äºé‡å­è®¡ç®—ä¸­çš„çº ç¼ ç‰¹æ€§ã€‚

é‡å­ç¥ç»ç½‘ç»œ(QNN)ç±»ä¼¼äºå¤§è„‘åŠŸèƒ½ï¼Œæœ‰åŠ©äºåˆ›å»ºæ–°çš„ä¿¡æ¯ç³»ç»Ÿã€‚qnn ç”¨äºè§£å†³éœ€è¦æŒ‡æ•°çº§å®¹é‡å’Œå†…å­˜çš„ç»å…¸æŒ‘æˆ˜æ€§é—®é¢˜ã€‚ç®€è€Œè¨€ä¹‹ï¼Œqnn è¢«è®¤ä¸ºæ˜¯ç¥ç»è®¡ç®—ç³»ç»Ÿè¿›åŒ–çš„è‡ªç„¶ä¸‹ä¸€æ­¥ã€‚

é‡å­è®¡ç®—å’Œæœºå™¨å­¦ä¹ ä¹‹é—´çš„è”ç³»åœ¨è¿‡å»å‡ å¹´é‡Œä¸€ç›´åœ¨å‘å±•ã€‚ç„¶è€Œï¼Œè®¸å¤šå®šä¹‰æ˜ç¡®çš„â€œæ•™ç§‘ä¹¦â€QML ç®—æ³•æ˜¯åœ¨è€ƒè™‘å®¹é”™é‡å­è®¡ç®—æœºçš„æƒ…å†µä¸‹è®¾è®¡çš„ã€‚åœ¨å½“å‰çš„é«˜å™ªå£°ä¸­å°ºåº¦é‡å­(NISQ)å™¨ä»¶æ—¶ä»£ï¼Œéœ€è¦ä¸€å¥—ä¸åŒçš„ç®—æ³•ã€å·¥å…·å’Œç­–ç•¥ã€‚æœ‰å¿…è¦ä»‹ç»ä¸€ä¸‹ NISQ æ—¶ä»£æœºå™¨å­¦ä¹ çš„å…³é”®æ€æƒ³ï¼Œå¹¶è°ƒæŸ¥ä¸€ä¸‹å½“å‰çš„å‘å±•çŠ¶å†µã€‚

## ç”¨ Xanadu è¿›è¡Œé‡å­å­¦ä¹ 

Xanadu æ˜¯ä¸€å®¶ä½äºåŠ æ‹¿å¤§å¤šä¼¦å¤šçš„å…¨æ ˆé‡å­åˆåˆ›å…¬å¸ï¼Œè¯¥å…¬å¸æ­£åœ¨æ¨è¿›ä¸€ç§é‡å­å…‰å­å¤„ç†å™¨ï¼Œè¯¥å¤„ç†å™¨é‡‡ç”¨å¼€æºçš„å…¨æ ˆé‡å­è½¯ä»¶å¹³å°ï¼Œåä¸º Strawberry Fieldsã€‚è¯¥å…¬å¸è¿˜å¼€å‘äº†ä¸€ä¸ªç”¨äºé‡å­è®¡ç®—æœºå¯å¾®åˆ†ç¼–ç¨‹çš„è·¨å¹³å° Python åº“[146]ï¼Œåä¸º PennyLane ( [`https://pennylane.readthedocs.io/en/stable/introduction/pennylane.html`](https://pennylane.readthedocs.io/en/stable/introduction/pennylane.html) )ã€‚PennyLane å’Œ Strawberry å­—æ®µæ˜¯ç”¨ Python å®ç°çš„ã€‚Xanadu è¿˜å¼€å§‹å‘å¸ƒä»–ä»¬åœ¨ä¸åŒé¢†åŸŸçš„ç¡¬ä»¶å’Œè½¯ä»¶æˆæœï¼Œå¦‚é‡å­åŒ–å­¦ã€å›¾è®ºã€é‡å­æœºå™¨å­¦ä¹ ç­‰ã€‚

PennyLane<sup>5</sup>ã€145ã€‘æ˜¯ä¸€ä¸ªå›´ç»•é‡å­å¯å¾®ç¼–ç¨‹æ„å»ºçš„å¼€æºè½¯ä»¶æ¡†æ¶ï¼Œç”¨é‡å­è®¡ç®—æœºå®ç°æœºå™¨å­¦ä¹ ä»»åŠ¡ã€‚å®ƒå°†ç»å…¸çš„æœºå™¨å­¦ä¹ åº“ä¸é‡å­æ¨¡æ‹Ÿå™¨å’Œç¡¬ä»¶æ— ç¼é›†æˆï¼Œä½¿ç”¨æˆ·èƒ½å¤Ÿè®­ç»ƒé‡å­ç”µè·¯ã€‚PennyLane è™½ç„¶æœ‰ QML çš„èƒ½åŠ›ï¼Œä½†ä¹Ÿæœ‰å¤šç§å¤šæ ·çš„èƒ½åŠ›ã€‚

*   æ”¯æŒæ··åˆé‡å­å’Œç»å…¸æ¨¡å‹ï¼Œå…è®¸ç”¨æˆ·å°†é‡å­ç¡¬ä»¶ä¸ PyTorchã€TensorFlow å’Œ NumPy è¿æ¥ï¼Œä»è€Œå¢å¼ºé‡å­æœºå™¨å­¦ä¹ èƒ½åŠ›

*   å…è®¸é‡å­ç”µè·¯çš„å†…ç½®è‡ªåŠ¨å¾®åˆ†

*   æä¾›ä¼˜åŒ–å’Œæœºå™¨å­¦ä¹ å·¥å…·

*   ç¡¬ä»¶ä¸å¯çŸ¥â€”â€”ç›¸åŒçš„é‡å­ç”µè·¯æ¨¡å‹å¯ä»¥åœ¨ä¸åŒçš„åç«¯è¿è¡Œâ€”â€”å¹¶å…è®¸æ’ä»¶è®¿é—®ä¸åŒçš„è®¾å¤‡ï¼ŒåŒ…æ‹¬ Strawberry Fieldsã€Amazon Braketã€IBM Qã€Google Cirqã€Rigetti Forestã€Microsoft QDK å’Œ ProjectQ

å®‰è£… PennyLane éå¸¸ç®€å•ã€‚å®ƒéœ€è¦ Python 3.6 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚æ¨èçš„ Python å®‰è£…æ˜¯ Anaconda Python 3 ( [`www.anaconda.com/download/`](http://www.anaconda.com/download/) )ã€‚å› ä¸ºè¿™æœ¬ä¹¦ä»ä¸€å¼€å§‹å°±æ‰¿è®¤äº† Anacondaï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨è¿™æ–¹é¢åº”è¯¥æ²¡é—®é¢˜ã€‚å‰©ä¸‹çš„å¾ˆç®€å•:é€šè¿‡ä¸‹é¢çš„å‘½ä»¤å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„ PennyLaneã€‚

```py
pip install pennylane --upgrade

```

è¿™ä¸ªå‘½ä»¤åº”è¯¥å¯ä»¥åœ¨ Python 3.6+ç¯å¢ƒä¸ŠæˆåŠŸè€Œè½»æ¾åœ°å®‰è£… PennyLaneã€‚PennyLane æœ‰ä¸€äº›ä¾èµ–é¡¹ï¼Œæ¯”å¦‚ NumPyã€SciPyã€networkï¼Œå®ƒä¼šåœ¨å®‰è£…æ—¶æ£€æŸ¥è¿™äº›ä¾èµ–é¡¹(å¦‚æœéœ€è¦ï¼Œä¼šè‡ªåŠ¨å®‰è£…å®ƒä»¬)ï¼Œå¦‚å›¾ 8-3 æ‰€ç¤ºã€‚

![img/502577_1_En_8_Fig3_HTML.jpg](img/502577_1_En_8_Fig3_HTML.jpg)

å›¾ 8-3

PennyLane å®‰è£…è¿‡ç¨‹

Xanadu æ­£åœ¨å¼€å‘ä¸€ç§å…‰å­é‡å­è®¡ç®—æœº:ä¸€ç§å¤„ç†ä»¥å…‰çš„é‡å­çŠ¶æ€å­˜å‚¨çš„ä¿¡æ¯çš„è®¾å¤‡ã€‚å…‰å­é‡å­è®¡ç®—æœºä½¿ç”¨è¿ç»­çš„è‡ªç”±åº¦â€”â€”å¦‚å…‰çš„æŒ¯å¹…å’Œç›¸ä½â€”â€”æ¥ç¼–ç ä¿¡æ¯ã€‚è¿™ç§è¿ç»­æˆ–æ¨¡æ‹Ÿç»“æ„ä½¿å¾—å…‰å­å™¨ä»¶æˆä¸ºç¥ç»ç½‘ç»œé‡å­ç‰ˆæœ¬çš„ä¸€ä¸ªæœ‰å¸å¼•åŠ›çš„å¹³å°ã€‚

qnn æ˜¯é‡å­ç”µè·¯æˆ–ç®—æ³•ï¼Œéå¸¸ç±»ä¼¼äºç»å…¸ç¥ç»å…ƒå’Œç¥ç»ç½‘ç»œçš„ç»“æ„(è§ç¬¬ä¸‰ç« )ï¼ŒåŒæ—¶ç”¨å¼ºå¤§çš„é‡å­å±æ€§æ‰©å±•å’Œæ¦‚æ‹¬å®ƒä»¬ã€‚å·²ç»å‘è¡¨äº†åˆ©ç”¨å…‰å­å­¦çš„ qnn ç ”ç©¶[84]ï¼Œå¹¶ä¸”åœ¨æ–‡çŒ®ä¸­è¿˜æœ‰å‡ ä¸ªå…¶ä»–çš„æè®®ã€‚

ç”¨å…‰å­å­¦æ¨¡æ‹Ÿé‡å­é˜±çš„æè®®è®©ä¸€äº›ç ”ç©¶å›¢ä½“å…´å¥‹ä¸å·²ã€‚åŸºæ´›å…°ç­‰äººåœ¨ 2018 å¹´å‘è¡¨äº†ä¸€ç¯‡è®ºæ–‡[84]ï¼Œå…¶ä¸­ä»–ä»¬æå‡ºäº†ä¸€ç§ç”±ä¸€ç³»åˆ—é‡å¤çš„æ„å»ºå—æˆ–*å±‚*ç»„æˆçš„å…‰å­ç”µè·¯ã€‚è¿™äº›å±‚å¯ä»¥ç”¨ä¸€å±‚çš„è¾“å‡ºä½œä¸ºä¸‹ä¸€å±‚çš„è¾“å…¥æ¥æ„å»ºã€‚è¿™äº›å…‰å­å±‚ç±»ä¼¼äºç»å…¸ç¥ç»ç½‘ç»œä¸­å‡ºç°çš„å±‚(è§ç¬¬ä¸‰ç« )ã€‚ç»å…¸ç½‘ç»œé‡‡ç”¨ä¸€ä¸ªè¾“å…¥ *x* ï¼Œä¹˜ä»¥ä¸€ä¸ªæƒé‡çŸ©é˜µ *W* ï¼ŒåŠ ä¸Šä¸€ä¸ªåå·® *b* ï¼Œå¹¶å°†ç»“æœé€šè¿‡ä¸€ä¸ªéçº¿æ€§æ¿€æ´»å‡½æ•°ï¼Œå¦‚ sigmoidã€tanh å’Œ ReLUã€‚

![img/502577_1_En_8_Fig4_HTML.jpg](img/502577_1_En_8_Fig4_HTML.jpg)

å›¾ 8-4

ç»å…¸ç¥ç»ç½‘ç»œçš„åŸºæœ¬å•å…ƒ

å›¾ 8-4 æ˜¾ç¤ºäº†ç»å…¸ç¥ç»ç½‘ç»œ(NN)çš„åŸºæœ¬ç»“æ„ï¼Œå®ƒæ‰§è¡Œä»¥ä¸‹è½¬æ¢ã€‚

![$$ z=f(x)\to \phi \left(\mathbf{w}.\mathbf{x}+b\right) $$](img/502577_1_En_8_Chapter_TeX_Equr.png)

(8.2)

å…¸å‹åœ°ï¼Œåœ¨ç­‰å¼ 8.2 ä¸­ï¼Œæƒé‡ **w** ç”±ä¸¤ä¸ªæ­£äº¤çŸ©é˜µå’Œä¸€ä¸ªå¯¹è§’çŸ©é˜µè¡¨ç¤ºã€‚

é€šè¿‡ä½¿ç”¨å…‰å­é‡å­é—¨ï¼Œé‡å­ç¥ç»ç½‘ç»œå±‚ç±»ä¼¼äºå›¾ 8-4 ä¸­æ‰€ç¤ºçš„ç»å…¸ç¥ç»ç½‘ç»œçš„åŠŸèƒ½ï¼Œå…‰å­é‡å­é—¨åŒ…æ‹¬ç”±ç§»ç›¸å™¨å’Œåˆ†æŸå™¨åˆ¶æˆçš„å¹²æ¶‰ä»ªã€å‹ç¼©å’Œä½ç§»é—¨ä»¥åŠå›ºå®šçš„éçº¿æ€§å˜æ¢ã€‚è¿™äº›æ˜¯å»ºé€ å…‰å­é‡å­è®¡ç®—æœºçš„ç›¸åŒçš„é—¨ï¼›å› æ­¤ï¼ŒQNN æ¶æ„è¢«è§£é‡Šä¸ºå…·æœ‰é‡å­è®¡ç®—æœºçš„è®¡ç®—èƒ½åŠ›ã€‚

![img/502577_1_En_8_Fig5_HTML.jpg](img/502577_1_En_8_Fig5_HTML.jpg)

å›¾ 8-5

å…‰å­é‡å­ç¥ç»ç½‘ç»œçš„åŸºæœ¬å•å…ƒ

å›¾ 8-5 æ˜¾ç¤ºäº†å…‰å­é‡å­ç³»ç»Ÿå®šä¹‰çš„åŸºæœ¬ QNN å•ä½ã€‚å®ƒæœ‰å½©è‰²çš„é—¨æ¥æŒ‡ç¤ºå®ƒä»¬ä¸å›¾ 8-4 ä¸­çš„å“ªä¸ªå¤å…¸éƒ¨ä»¶ç›¸å…³ã€‚å¹²æ¶‰ä»ªå’Œå‹ç¼©é—¨ç±»ä¼¼äºæƒé‡çŸ©é˜µã€‚ä½ç§»é—¨æ˜ å°„åˆ°åå‹ï¼Œé‡å­éçº¿æ€§æ¿€æ´»å‡½æ•°æ˜ å°„åˆ°ç»å…¸éçº¿æ€§ã€‚ç¥ç»ç½‘ç»œçš„é‡å­ç‰ˆæœ¬ä¸ç»å…¸ç¥ç»ç½‘ç»œéå¸¸ç›¸ä¼¼ï¼Œå¯ä»¥ç”¨æ¥è¿è¡Œç»å…¸ç‰ˆæœ¬ã€‚é€šè¿‡ä»¥ä¸€ç§æŠ›å¼ƒä»»ä½•é‡å­â€œæ€ªå¼‚â€çš„æ–¹å¼æ§åˆ¶é‡å­ç½‘ç»œï¼Œæ¯”å¦‚å åŠ å’Œçº ç¼ ã€‚PennyLane å¯ä»¥ç»“åˆç°æœ‰çš„ç»å…¸èŠ‚ç‚¹æ¥åˆ›å»ºå’Œæ¢ç´¢æ··åˆæ¨¡å‹ï¼Œå¦‚å›¾ 8-6 (æ¥è‡ª PennyLane æ–‡æ¡£ã€145ã€‘)ã€‚

![img/502577_1_En_8_Fig6_HTML.png](img/502577_1_En_8_Fig6_HTML.png)

å›¾ 8-6

å« PennyLane çš„æ··åˆç»å…¸é‡å­æ¨¡å‹çš„ç¤ºä¾‹ç»“æ„

å½“æˆ‘ä»¬è®¨è®ºé‡å­æ·±åº¦å­¦ä¹ æ—¶ï¼Œæˆ‘ä»¬éœ€è¦è®°ä½ï¼Œæˆ‘ä»¬ä»ç„¶æ²¡æœ‰å¤„äºä¸€ä¸ªå¯ä»¥åœ¨é‡å­ NN æ¨¡å‹ä¸Šè®­ç»ƒå’Œæµ‹è¯•å¤§é‡é‡å­æ•°æ®çš„æ—¶ä»£ã€‚ä»Šå¤©ç°å®ç”Ÿæ´»ä¸­çš„è®¸å¤šæ•°æ®æœ¬è´¨ä¸Šéƒ½æ˜¯ç»å…¸çš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦é—®è‡ªå·±å¦‚ä½•ç¼–ç è¿™äº›ç»å…¸æ•°æ®å¹¶å°†å…¶è¾“å…¥é‡å­æœºå™¨ï¼Ÿ

æœ‰å¾ˆå¤šæ–¹æ³•å¯ä»¥å°†ç»å…¸æ•°æ®åµŒå…¥åˆ°é‡å­ç”µè·¯ä¸­:é‡å­è®¡ç®—å¹³å°çš„ä¸åŒä¾›åº”å•†å·²ç»æä¾›äº†å¯ç”¨çš„æ¨¡æ¿æ¥å®ç°è¿™ä¸€ç‚¹ã€‚æ¯”å¦‚ PennyLane å°±æœ‰`qml.templates`æ¨¡å—ã€‚PennyLane é€šè¿‡ä¸€ç³»åˆ—æ’ä»¶æ”¯æŒå„ç§é‡å­æ¡†æ¶å’Œé‡å­ç¡¬ä»¶ã€‚ä¾‹å¦‚ï¼Œå…‰å­å±‚éœ€è¦è‰è“åœ°çš„`pennylane-sf`æ’ä»¶ã€‚

ä¸ºäº†æ„å»ºé‡å­èŠ‚ç‚¹å±‚(æˆ–è€… PennyLane æœ¯è¯­ä¸­ç§°ä¸º QNodes ),é™¤äº†æ‰‹åŠ¨æ”¾ç½®å•ä¸ªé—¨ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨é¢„å…ˆæ„å»ºçš„é‡å­ä½å±‚çš„æ¨¡æ¿ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›é¢„æ„å»ºçš„å±‚ã€‚

*   `RandomLayers`

*   `StronglyEntanglingLayers`

*   `BasicEntanglerLayers`

*   `SimplifiedTwoDesign`

*   `CVNeuralNetLayers`

ç±»ä¼¼ç»å…¸ç¥ç»ç½‘ç»œçš„é‡å¤å±‚æä¾›äº†ä»¥ä¸‹ä¼˜ç‚¹ã€‚

*   å®ƒæä¾›å¯¹ç”µè·¯æ·±åº¦çš„æ§åˆ¶ã€‚

*   å±‚å¯ä»¥è¢«è®¾è®¡æˆç¡¬ä»¶å‹å¥½çš„ã€‚

*   è¿™æ˜¯ä¸€ä¸ªé€šç”¨é‡å­è®¡ç®—çš„æ¨¡å‹ã€‚

### ç”¨äºç¥ç»ç½‘ç»œçš„æˆŠç‚”

ç°åœ¨æˆ‘ä»¬å·²ç»æ¢ç´¢äº†é‡å­ NNs (QNNs)å’Œ PennyLane çš„ç†è®ºæ–¹é¢ï¼Œæ˜¯æ—¶å€™è¿›è¡Œç¼–ç äº†ã€‚

#### ç”¨ QNN æ‹Ÿåˆä½™å¼¦å‡½æ•°

ä»¥ä¸‹ç¤ºä¾‹æ”¹ç¼–è‡ª PennyLane æ–‡çŒ®[172]ã€‚è¿™ä¸ªä¾‹å­æ„æˆäº†å­¦ä¹ ä¸€ç»´å‡½æ•°çš„*æ‹Ÿåˆ*çš„å˜åˆ†ç”µè·¯ã€‚ä¸ºäº†å®ç°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬ä»¥å¸¦æœ‰å™ªå£°çš„`cosine`å‡½æ•°çš„å½¢å¼ç”Ÿæˆåˆæˆæ•°æ®ï¼Œå¹¶è®­ç»ƒé‡å­ç¥ç»ç½‘ç»œ(QNode)æ¥åº”ç”¨å®ƒä»¬ã€‚

ä¸‹é¢è§£é‡Šäº†å¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹ã€‚

1.  ç”¨`default.qubit.`åˆ›å»ºä¸€ä¸ª`device`

2.  åˆ›å»ºä¸€ä¸ª QNodeï¼Œå®ƒæ¥å—ä¸€ä¸ªè¾“å…¥<sup>â€²</sup>*x*<sup>â€²</sup>å’Œå¯è®­ç»ƒæƒé‡ï¼Œå¹¶è¾“å‡ºä¸€ä¸ª<sup>â€²</sup>*y*<sup>â€²</sup>ã€‚

3.  å®šä¹‰ *x* çš„è®­ç»ƒèŒƒå›´( *Ï€* åˆ° *Ï€* )å¹¶è®¡ç®— *y* = cos *x* ã€‚

4.  é€‰æ‹© PennyLane ä¼˜åŒ–å™¨ã€‚

5.  è¿è¡Œä¼˜åŒ–å¾ªç¯ã€‚

ä»¥ä¸‹ç¤ºä¾‹ä¸­ä½¿ç”¨çš„å˜åˆ†ç”µè·¯æ˜¯åŸºæ´›å…°ç­‰äºº(2018) [84]ä¸­æè¿°çš„*è¿ç»­å˜é‡é‡å­ç¥ç»ç½‘ç»œ*æ¨¡å‹ã€‚

ç¬¬ä¸€æ­¥ï¼Œæˆ‘ä»¬`import` PennyLane(å®‰è£…å¥½ä¹‹å)ï¼ŒPennyLane æä¾›çš„ NumPy çš„åŒ…è£…ç‰ˆæœ¬ï¼Œä»¥åŠä¸€ä¸ªåä¸º`AdamOptimizer (` [`https://pennylane.readthedocs.io/en/stable/code/api/pennylane.AdamOptimizer.html`](https://pennylane.readthedocs.io/en/stable/code/api/pennylane.AdamOptimizer.html) çš„ä¼˜åŒ–å™¨ã€‚ç”¨äºæ­¤çš„`device`æ˜¯è‰è“åœ°æ¨¡æ‹Ÿå™¨ï¼Œå¯ä»¥é€šè¿‡ PennyLane çš„è‰è“åœ°æ’ä»¶å®‰è£…ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚

```py
$ pip install pennylane-sf

```

ä»è¿™ä¸ªç»ƒä¹ å¼€å§‹ï¼Œæˆ‘ä»¬æ‰“å¼€åä¸º`qnn_cosine_pl.ipynb`çš„ Jupyter ç¬”è®°æœ¬ï¼Œå®ƒå¯ä»¥ä»æœ¬ä¹¦ç½‘ç«™çš„ä¸‹è½½é“¾æ¥ä¸­è·å¾—ã€‚

![img/502577_1_En_8_Figg_HTML.jpg](img/502577_1_En_8_Figg_HTML.jpg)

```py
# Import PennyLane, the wrapped version of NumPy provided by PennyLane, and an optimizer.
import pennylane as qml
from pennylane import numpy as np
from pennylane.optimize import AdamOptimizer
import matplotlib.pyplot as plt
import pylab
import pickle

Listing 8-2aLibraries and Optimizer qnn_cosine_pl.ipynb

```

`AdamOptimizer`æ˜¯éšæœºä¼˜åŒ–çš„ä¸€ç§æ–¹æ³•ã€‚å®ƒåŸºäºå…·æœ‰è‡ªé€‚åº”å­¦ä¹ é€Ÿç‡çš„æ¢¯åº¦ä¸‹é™ä¼˜åŒ–å™¨[84]çš„åŸç†ï¼Œä½¿ç”¨ä¾èµ–äºæ­¥é•¿çš„å­¦ä¹ é€Ÿç‡æä¾›è‡ªé€‚åº”åŠ›çŸ©ä¼°è®¡ã€‚ç¬¬ä¸‰ç«  T2 è®²è¿°äº†ç»å…¸ç¥ç»ç½‘ç»œçš„æ¢¯åº¦ä¸‹é™ï¼Œè¿™æ˜¯å‰é¦ˆç½‘ç»œæœ€å¸¸è§çš„è®­ç»ƒç®—æ³•ä¹‹ä¸€ã€‚æ¢¯åº¦ä¸‹é™ä¼˜åŒ–å™¨ä½¿ç”¨æ–œç‡(æˆ–æ¢¯åº¦)æ¥å¼•å¯¼å‚æ•°ç©ºé—´ã€‚æ•°å­¦ä¸Šï¼Œæ¢¯åº¦ä¸‹é™ï¼Œç”±æ–¹ç¨‹ 3 ç»™å‡ºã€‚5 ï¼Œæ­¤å¤„è½¬è½½ã€‚

![$$ {w}_{ij}^{n+1}={w}_{ij}^n-\eta \mathbf{\nabla}E={w}_{ij}^n-\eta \frac{\partial C\left({w}_1,{w}_2\right)}{\partial {w}_{ij}} $$](img/502577_1_En_8_Chapter_TeX_Equs.png)

(8.3)

å…¶ä¸­ï¼Œå½“å‰æƒé‡![$$ {w}_{ij}^{n+1} $$](img/502577_1_En_8_Chapter_TeX_IEq6.png)æ˜¯æ›´æ–°åçš„æƒé‡ï¼Œ![$$ {w}_{ij}^n $$](img/502577_1_En_8_Chapter_TeX_IEq7.png)æ˜¯æœç€æœ€é™¡æ¢¯åº¦æ–¹å‘å‘ä¸‹çš„å‰ä¸€æ­¥çš„æƒé‡ï¼Œ *Î·* æ˜¯å¯¹åº”äºå­¦ä¹ é€Ÿç‡æˆ–æ­¥é•¿çš„ç”¨æˆ·å®šä¹‰çš„è¶…å‚æ•°ï¼Œ *E* æ˜¯æˆæœ¬å‡½æ•°ï¼Œ *C* æ˜¯ç›¸å¯¹äº*w*T12ã€‘T13ã€‘ijT15ã€‘å…·æœ‰å¯¼æ•°çš„ *E* çš„æ•°å­¦ç­‰ä»·å½¢å¼

`pickle`æ¨¡å—å®ç°äº†äºŒè¿›åˆ¶åè®®ï¼Œç”¨äºåºåˆ—åŒ–å’Œååºåˆ—åŒ– Python å¯¹è±¡ç»“æ„ã€‚*é…¸æ´—*æ˜¯å°† Python å¯¹è±¡å±‚æ¬¡ç»“æ„è½¬æ¢æˆå­—èŠ‚æµçš„è¿‡ç¨‹ã€‚*æ‹†åŒ…*æ˜¯ç›¸åçš„æ“ä½œï¼Œä¸€ä¸ªå­—èŠ‚æµ(æ¥è‡ªäºŒè¿›åˆ¶æ–‡ä»¶æˆ–ç±»ä¼¼å­—èŠ‚çš„å¯¹è±¡)è¢«è½¬æ¢å›ä¸€ä¸ªå¯¹è±¡å±‚æ¬¡ã€‚`Pickle`å¯ç”¨äºç¨åå°†æ•°æ®åŠ è½½åˆ°å¦ä¸€ä¸ª Python è„šæœ¬ä¸­ã€‚

ä¸‹ä¸€æ­¥ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå™ªå£°ä½™å¼¦å‡½æ•°è¿›è¡Œé‡‡æ ·ã€‚

```py
Xlim = 5
noise = np.random.normal(0,0.1,100) # generate noise to add to the function values (Y-values)
# define functions
X = np.arange(-Xlim, Xlim, 0.1)
Y = np.cos(X)+noise

Listing 8-2bNoisy Cosine Function Definition qnn_cosine_pl.ipynb

```

è¿™ä¸ªä»£ç å—ç”¨ X è½´å’Œ Y è½´æ•°æ®ç”Ÿæˆä¸¤ä¸ªåˆ—è¡¨ X å’Œ Yã€‚ç°åœ¨è®©æˆ‘ä»¬å°† Y è½´æ•°æ®å†™å…¥ä¸€ä¸ªæ–‡ä»¶ï¼Œä»¥å¤‡å°†æ¥ä½¿ç”¨ã€‚

```py
# write the data out to a file
cosdata = open('cosdata.md', 'wb')
pickle.dump(Y, cosdata)
cosdata.close()
plt.plot(X[0:200], Y[0:200])

Listing 8-2cWrite Noisy Cosine Data 

to a File qnn_cosine_pl.ipynb

```

è¿™æ®µä»£ç å°† *y* çš„æ•°æ®å†™å…¥ä¸€ä¸ªåä¸º`cosdata.md`çš„æ–‡ä»¶ä¸­ã€‚æœ‰äº†è¿™ä¸ªï¼Œæˆ‘ä»¬ç”¨`plt.plot()`å‡½æ•°ç»˜åˆ¶ä¸€äº›æ•°æ®ï¼Œä»¥ç”Ÿæˆä¸‹é¢çš„å™ªå£°ä½™å¼¦å‡½æ•°å›¾ã€‚

![img/502577_1_En_8_Figh_HTML.jpg](img/502577_1_En_8_Figh_HTML.jpg)

ç°åœ¨æˆ‘ä»¬æœ‰ä¸€äº›å™ªå£°ä½™å¼¦æ•°æ®æ¥è®­ç»ƒæˆ‘ä»¬çš„ QNNã€‚ä½¿ç”¨çš„è®¾å¤‡æ˜¯åªæœ‰ä¸€ä¸ªé‡å­æ¨¡å¼(æˆ–çº¿)çš„è‰è“åœºæ¨¡æ‹Ÿå™¨ã€‚ä¸ºäº†å®Œæˆè¿™ä¸ªç»ƒä¹ ï¼Œæˆ‘ä»¬éœ€è¦æŒ‰ç…§ä¹‹å‰çš„æŒ‡å®šå®‰è£… PennyLane çš„è‰è“åœ°æ’ä»¶ã€‚

Note

å¦‚æœ PennyLane çš„ Strawberry Fields æ’ä»¶æ˜¯*è€Œä¸æ˜¯*å®‰è£…çš„ï¼Œæ‚¨ä¼šå¾—åˆ°ä»¥ä¸‹é”™è¯¯:DeviceError:è®¾å¤‡ä¸å­˜åœ¨ã€‚ç¡®ä¿å®‰è£…äº†æ‰€éœ€çš„æ’ä»¶ã€‚

```py
dev = qml.device("strawberryfields.fock", wires=1, cutoff_dim=10)

Listing 8-2dStrawberry Fields plugin qnn_cosine_pl.ipynb

```

PennyLane çš„è‰è“åœ°æ’ä»¶è®¿é—®ä¸€ä¸ª Fock <sup>6</sup> å·æ¨¡æ‹Ÿå™¨åç«¯ã€‚è¿™ä¸ªæ¨¡æ‹Ÿå™¨ä»£è¡¨äº†âˆ£0âŸ©ã€âˆ£1âŸ©ã€âˆ£2âŸ©,â€¦ã€âˆ£*d*1âŸ©çš„ Fock åŸºé‡å­æ€ï¼Œå…¶ä¸­ *D* æ˜¯ç”¨æˆ·ç»™å®šçš„`cutoff_dim`å€¼ï¼Œè¯¥å€¼*é™åˆ¶äº†*å¸Œå°”ä¼¯ç‰¹ç©ºé—´çš„ç»´åº¦ã€‚è¿™ç§è¡¨ç¤ºæ³•çš„ä¼˜ç‚¹æ˜¯å¯ä»¥è¡¨ç¤ºä»»ä½•è¿ç»­å˜é‡çš„è¿ç®—ã€‚è¯·æ³¨æ„ä»¥ä¸‹äº‹é¡¹ã€‚

*   æ¨¡æ‹Ÿæ˜¯è¿‘ä¼¼å€¼ï¼Œå…¶ç²¾ç¡®åº¦éšç€æˆªæ­¢å°ºå¯¸`cutoff_dim.`çš„å¢åŠ è€Œå¢åŠ 

*   å¯¹äº *M* æ¨¡å¼æˆ–çº¿ä»¥åŠ *D* çš„æˆªæ­¢å°ºå¯¸ï¼ŒFock çŠ¶æ€[288]æ¨¡æ‹Ÿå™¨éœ€è¦è‡³å°‘è·Ÿè¸ª *M* <sup>*D*</sup> å€¼ã€‚å› æ­¤ï¼Œä¸åŸºäºé‡å­ä½çš„æ¨¡æ‹Ÿå™¨ç›¸æ¯”ï¼Œæ¨¡æ‹Ÿæ—¶é—´å’Œæ‰€éœ€å†…å­˜éšç€æ¨¡å¼æ•°é‡çš„å¢åŠ è€Œå¢é•¿å¾—æ›´å¿«ã€‚

*   åœ¨ä¼˜åŒ–è¿‡ç¨‹ä¸­è·Ÿè¸ªé‡å­çŠ¶æ€çš„å½’ä¸€åŒ–é€šå¸¸æ˜¯æœ‰ç”¨çš„ï¼Œä»¥ç¡®ä¿ç”µè·¯ä¸ä¼šâ€œå­¦ä¼šâ€å°†å…¶å‚æ•°æ¨å…¥æ¨¡æ‹Ÿéå¸¸ä¸å‡†ç¡®çš„çŠ¶æ€ã€‚

ä¸‹ä¸€æ­¥ï¼Œæˆ‘ä»¬åˆ©ç”¨æˆ‘ä»¬åœ¨ç¬¬ä¸ƒç« ä¸­å¯¹å˜åˆ†ç”µè·¯çš„æ¢ç´¢æ¥å®šä¹‰ QNodeã€‚å¯¹äºå•é‡å­æ¨¡å¼ï¼Œ*å˜åˆ†ç”µè·¯*çš„æ¯ä¸€å±‚éƒ½å®šä¹‰æœ‰ä¸€ä¸ª*è¾“å…¥å±‚*ï¼Œä¸€ä¸ª*åç½®*ï¼Œä¸€ä¸ª*éçº¿æ€§å˜æ¢*ã€‚

```py
def layer(v):
    # Matrix multiplication of input layer
    qml.Rotation(v[0], wires=0)
    qml.Squeezing(v[1], 0.0, wires=0)
    qml.Rotation(v[2], wires=0)

    # Bias
    qml.Displacement(v[3], 0.0, wires=0)

    # Element-wise nonlinear transformation
    qml.Kerr(v[4], wires=0)

Listing 8-2eDefine the QNN Layer qnn_cosine_pl.ipynb

```

é‡å­èŠ‚ç‚¹ä¸­çš„å˜åˆ†ç”µè·¯é¦–å…ˆå°†è¾“å…¥ç¼–ç æˆæ¨¡å¼çš„ä½ç§»ï¼Œç„¶åæ‰§è¡Œå„å±‚ã€‚è¾“å‡ºæ˜¯*x*-æ­£äº¤[288]çš„æœŸæœ›å€¼ã€‚

```py
@qml.qnode(dev)
def quantum_neural_net(var, x=None):
    # Encode input x into quantum state
    qml.Displacement(x, 0.0, wires=0)
    # "layer" subcircuits
    for v in var:
        layer(v)
    return qml.expval(qml.X(0))

Listing 8-2fEncode Input qnn_cosine_pl.ipynb

```

ä½œä¸ºç›®æ ‡ï¼Œæˆ‘ä»¬å–ç›®æ ‡æ ‡ç­¾å’Œæ¨¡å‹é¢„æµ‹ä¹‹é—´çš„æŸå¤±çš„å¹³æ–¹ã€‚

```py
def square_loss(labels, predictions):
    loss = 0
    for l, p in zip(labels, predictions):
        loss = loss + (l - p) ** 2
    loss = loss / len(labels)
    return loss

Listing 8-2gPrediction Modeling qnn_cosine_pl.ipynb

```

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å®šä¹‰æˆæœ¬å‡½æ•°ã€‚åœ¨æˆæœ¬å‡½æ•°ä¸­è®¡ç®—æ¥è‡ªå˜åˆ†ç”µè·¯çš„è¾“å‡ºã€‚å‡½æ•°æ‹Ÿåˆæ˜¯ä¸€ä¸ªå›å½’é—®é¢˜ï¼Œæˆ‘ä»¬å°†æ¥è‡ªé‡å­èŠ‚ç‚¹çš„*é¢„æœŸ*è§£é‡Šä¸º*é¢„æµ‹*ï¼Œè€Œä¸åº”ç”¨è¯¸å¦‚é˜ˆå€¼å¤„ç†çš„åå¤„ç†ã€‚

```py
def cost(var, features, labels):
    preds = [quantum_neural_net(var, x=x) for x in features]
    return square_loss(labels, preds)

Listing 8-2hCost Function qnn_cosine_pl.ipynb

```

ä¸‹ä¸€æ­¥ï¼Œæˆ‘ä»¬å°†å™ªå£°æ•°æ®åŠ è½½åˆ°æˆæœ¬å‡½æ•°ä¸­ã€‚åœ¨è®­ç»ƒæ¨¡å‹ä¹‹å‰ï¼Œè®©æˆ‘ä»¬æ£€æŸ¥ä¸€ä¸‹æ•°æ®(å‚è§æ¸…å• 8-2i )ã€‚

```py
plt.figure()
plt.scatter(X, Y)
plt.xlabel("x", fontsize=18)
plt.ylabel("f(x)", fontsize=18)
plt.tick_params(axis="both", which="major", labelsize=16)
plt.tick_params(axis="both", which="minor", labelsize=16)
plt.show()

Listing 8-2iCost Function qnn_cosine_pl.ipynb

```

æ¸…å• 8-2i ç»™å‡ºäº†ä¸‹é¢çš„è¾“å‡ºå›¾ã€‚

![img/502577_1_En_8_Figi_HTML.jpg](img/502577_1_En_8_Figi_HTML.jpg)

ç½‘ç»œçš„æƒé‡(è¿™é‡Œç§°ä¸º`var`)ç”¨ä»æ­£æ€åˆ†å¸ƒä¸­é‡‡æ ·çš„å€¼åˆå§‹åŒ–ã€‚æˆ‘ä»¬ä½¿ç”¨å››å±‚ã€‚å·²ç»å‘ç°æ€§èƒ½åœ¨å¤§çº¦å…­å±‚æ—¶è¾¾åˆ°ç¨³å®šã€‚

```py
np.random.seed(0)
num_layers = 4
var_init = 0.05 * np.random.randn(num_layers, 5)
print(var_init)

Listing 8-2jDefine the Number of Layers qnn_cosine_pl.ipynb

```

è¿™ä¸ªä»£ç ç‰‡æ®µç»™å‡ºäº†å±‚çš„å¦‚ä¸‹è¾“å‡ºã€‚

![img/502577_1_En_8_Figj_HTML.jpg](img/502577_1_En_8_Figj_HTML.jpg)

æœ€åï¼Œæˆ‘ä»¬ä½¿ç”¨ AdamOptimizerã€‚æˆ‘ä»¬è¿è¡Œä¼˜åŒ–å™¨ï¼Œå¹¶æ›´æ–°æœ¬ç»ƒä¹ ä¸­ä»…*50 æ­¥çš„æƒé‡ã€‚è¿™è¿è¡Œäº†ä¸€æ®µæ—¶é—´ã€‚*

```py
opt = AdamOptimizer(0.01, beta1=0.9, beta2=0.999)
var = var_init
for it in range(50):
    var = opt.step(lambda v: cost(v, X, Y), var)
    print("Iter: {:5d} | Cost: {:0.7f} ".format(it + 1, cost(var, X, Y)))

Listing 8-2kRun the Optimizer qnn_cosine_pl.ipynb

```

è¿è¡Œè¿™ä¸ªä»£ç å—å¼€å§‹ 50 æ­¥çš„è¿­ä»£è¾“å‡ºã€‚ä»¥ä¸‹æ˜¯è¾“å‡ºçš„æˆªæ–­ç¤ºä¾‹ã€‚

![img/502577_1_En_8_Figk_HTML.jpg](img/502577_1_En_8_Figk_HTML.jpg)

ä»£ç å—ä¸­çš„æ­¥éª¤è¶Šå¤šï¼Œæ•ˆæœè¶Šå¥½ï¼Œä½†è¿è¡Œæ—¶é—´ä¹Ÿè¶Šé•¿ã€‚æˆ‘ä»¬é¼“åŠ±æ‚¨è¿è¡Œæ­¤åŠŸèƒ½ï¼›ä¾‹å¦‚ï¼Œé€šè¿‡è°ƒæ•´`for it in range(<number_of_steps>).`ä¸­çš„æ­¥é•¿å€¼ï¼Œå¯ä»¥è¾¾åˆ° 500 æˆ– 700 æ­¥

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ”¶é›†è®­ç»ƒæ¨¡å‹åœ¨[0ï¼Œ30]èŒƒå›´å†…çš„ 50 ä¸ªå€¼çš„*é¢„æµ‹*ï¼Œå¹¶ç»˜åˆ¶æ¨¡å‹ä»å™ªå£°æ•°æ®(è¤çº¢è‰²ç‚¹)ä¸­â€œå­¦ä¹ â€çš„å‡½æ•°ã€‚

```py
x_pred = np.linspace(-3, 3, 50)
predictions = [quantum_neural_net(var, x=x_) for x_ in x_pred]
# plot the function
plt.figure()
plt.scatter(X, Y)
plt.scatter(x_pred, predictions, color="maroon")
plt.xlabel("x")
plt.ylabel("f(x)")
plt.tick_params(axis="both", which="major")
plt.tick_params(axis="both", which="minor")
plt.show()

Listing 8-2lCollect Predictions and Plot Function qnn_cosine_pl.ipynb

```

è¿™ä¼šäº§ç”Ÿä»¥ä¸‹è¾“å‡ºã€‚

![img/502577_1_En_8_Figl_HTML.jpg](img/502577_1_En_8_Figl_HTML.jpg)

è¯¥æ¨¡å‹å·²ç»å­¦ä¼šå¹³æ»‘å™ªå£°æ•°æ®ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ PennyLane æ¥æŸ¥çœ‹æ¨¡å‹åœ¨å®Œå…¨æ²¡æœ‰ç»è¿‡è®­ç»ƒçš„æƒ…å†µä¸‹äº§ç”Ÿçš„å…¸å‹å‡½æ•°ã€‚æ¸…å• 8-2k ä¸­æ›´é«˜çš„æ­¥æ•°å¯¼è‡´æ›´å¥½çš„æ‹Ÿåˆï¼Œä½†æ˜¯è¿è¡Œæ—¶é—´æ›´é•¿ã€‚

æœ€åä¸€æ­¥ï¼Œæˆ‘ä»¬ç”¨æ–¹å·®è¶…å‚æ•°ç»˜åˆ¶å‡½æ•°ã€‚

```py
variance = 1.0
plt.figure()
x_pred = np.linspace(-5, 5, 50)
for i in range(7):
    rnd_var = variance * np.random.randn(num_layers, 7)
    predictions = [quantum_neural_net(rnd_var, x=x_) for x_ in x_pred]
    plt.plot(x_pred, predictions, color="black")
plt.xlabel("x")
plt.ylabel("f(x)")
plt.tick_params(axis="both", which="major")
plt.tick_params(axis="both", which="minor")
plt.show()

Listing 8-2mFunctions Against Hyperparameter qnn_cosine_pl.ipynb

```

è¿™å°†äº§ç”Ÿæœ¬ç»ƒä¹ çš„æœ€åä¸€ä¸ªè¾“å‡ºï¼Œç»˜åˆ¶è¶…å‚æ•°æ–¹å·®çš„å‡½æ•°è¡Œä¸ºã€‚

![img/502577_1_En_8_Figm_HTML.jpg](img/502577_1_En_8_Figm_HTML.jpg)

è¿™äº›å‡½æ•°çš„å½¢çŠ¶éšç€æƒé‡åˆå§‹åŒ–çš„æ–¹å·®è¶…å‚æ•°è€Œæ˜¾è‘—å˜åŒ–ã€‚å°†è¿™ä¸ªè¶…å‚æ•°è®¾ç½®ä¸ºä¸€ä¸ªå°å€¼ä¼šäº§ç”Ÿå‡ ä¹çº¿æ€§çš„å‡½æ•°ï¼Œå› ä¸ºå˜åˆ†ç”µè·¯ä¸­çš„æ‰€æœ‰é‡å­é—¨éƒ½æ‰§è¡Œæ’ç­‰å˜æ¢ã€‚è¾ƒå¤§çš„å€¼äº§ç”Ÿå¹³æ»‘æŒ¯è¡çš„å‡½æ•°ï¼Œå…¶å‘¨æœŸå–å†³äºæ‰€ç”¨çš„å±‚æ•°ï¼Œé€šå¸¸å±‚æ•°è¶Šå¤šï¼Œå‘¨æœŸè¶Šå°ã€‚

#### PennyLane äºŒå…ƒåˆ†ç±»å™¨

ç¬¬äºŒç« ä»‹ç»äº†ä½¿ç”¨ Iris æ•°æ®é›†çš„åˆ†ç±»å™¨(ç”¨äºç»å…¸æ•°æ®åˆ†æ)ã€‚æˆ‘ä»¬åœ¨`svmIris.ipynb`ä¸­è¿è¡Œäº†ä¸€ä¸ªæ”¯æŒå‘é‡åˆ†ç±»å™¨ï¼Œåœ¨ 10000 æ¬¡è¿­ä»£ä¹‹åï¼Œæˆ‘ä»¬è·å¾—äº†ä¸€ä¸ªæ··æ·†çŸ©é˜µå’Œå¤§çº¦ 98%çš„å‡†ç¡®ç‡ã€‚ç¬¬ä¸‰ç« åœ¨`DNNIris.ipynb`ä¸­é’ˆå¯¹ç»å…¸æ·±åº¦ç¥ç»ç½‘ç»œåˆ†ç±»å™¨æŸ¥çœ‹äº†ç›¸åŒçš„è™¹è†œæ•°æ®é›†ï¼Œæˆ‘ä»¬è¿è¡Œäº† 100 ä¸ªæ—¶æœŸä»¥è·å¾— 100%çš„å‡†ç¡®ç‡ã€‚

è§‚å¯Ÿé‡å­ç¥ç»ç½‘ç»œç®—æ³•å¦‚ä½•ä¸åŒäºç›¸åŒæ•°æ®é›†çš„ç»å…¸ç»éªŒå°†æ˜¯æœ‰è¶£çš„ã€‚è¿™é‡Œä½¿ç”¨çš„æ•°æ®åœ¨ç¬¬ 2 å’Œ 3 ç« ä¸­ä½¿ç”¨:ä¸€ä¸ªå…¬å¼€å¯ç”¨çš„æ•°æ®é›†ï¼Œåä¸º *Iris* ï¼Œå¯ä» Python çš„`sklearn`è·å¾—ã€‚æ ‡é¢˜ä¸º`qml_iris_pl.ipynb`çš„ Jupyter ç¬”è®°æœ¬å¯ä»è¯¥ä¹¦çš„ç½‘ç«™ä¸Šè·å¾—ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬ä» Python å’Œ PennyLane å¯¼å…¥æ‰€æœ‰å¿…è¦çš„åº“ï¼Œä»¥åŠ PennyLane çš„`GradientDescentOptimizer`æ¥æ‰§è¡Œä¼˜åŒ–ã€‚æˆ‘ä»¬è¿˜ä½¿ç”¨`StronglyEntanglingLayers`æ¨¡æ¿æ¥æ„å»º NN å±‚ã€‚

![img/502577_1_En_8_Fign_HTML.jpg](img/502577_1_En_8_Fign_HTML.jpg)

```py
from itertools import chain
from sklearn import datasets
from sklearn.utils import shuffle
from sklearn.preprocessing import minmax_scale
from sklearn.model_selection import train_test_split
import sklearn.metrics as metrics

import pennylane as qml
from pennylane import numpy as np
from pennylane.templates.embeddings import AngleEmbedding
from pennylane.templates.layers import StronglyEntanglingLayers
from pennylane.init import strong_ent_layers_uniform
from pennylane.optimize import GradientDescentOptimizer
from pennylane.devices.default_qubit import DefaultQubit

Listing 8-3aFunctions Against Hyperparameter qml_iris_pl.ipynb

```

`GradientDescentOptimizer`æ˜¯ä¸€ä¸ªåŸºæœ¬çš„ä¼˜åŒ–å™¨ï¼Œå®ƒæ˜¯å…¶ä»–åŸºäºæ¢¯åº¦ä¸‹é™çš„ä¼˜åŒ–å™¨çš„åŸºç±»ã€‚æ¢¯åº¦ä¸‹é™ä¼˜åŒ–å™¨çš„ä¸€ä¸ªæ­¥éª¤é€šè¿‡ç­‰å¼ 8.3 ä¸­å®šä¹‰çš„è§„åˆ™è®¡ç®—æ–°å€¼ã€‚

`StronglyEntanglingLayers`æ˜¯ç”±å•é‡å­ä½æ—‹è½¬å’Œçº ç¼ ç»„æˆçš„å±‚çš„æ¨¡æ¿ï¼Œå…¶çµæ„Ÿæ¥è‡ª Schuld ç­‰äººåœ¨ 2020 å¹´[59]çš„è®ºæ–‡ä¸­æå‡ºçš„ä»¥ç”µè·¯ä¸ºä¸­å¿ƒçš„åˆ†ç±»å™¨è®¾è®¡ã€‚

åœ¨ä¸‹ä¸€æ­¥ä¸­ï¼Œæˆ‘ä»¬å¯¼å…¥æ•°æ®ï¼Œå¯¹å…¶æ‰§è¡Œé¢„å¤„ç†(æ··æ´—ã€é€‰æ‹©ç±»å¹¶å°†å…¶è§„èŒƒåŒ–)ï¼Œå¹¶å°†æ•°æ®åˆ†ä¸º 80%â€“20%ï¼Œåˆ†åˆ«ç”¨äºè®­ç»ƒæ•°æ®é›†å’Œæµ‹è¯•æ•°æ®é›†ã€‚

```py
# Import data, pre-processing, data splitting
# load the dataset
iris = datasets.load_iris ()

# shuffle the data
X, y = shuffle (iris.data , iris.target , random_state = 0)

# select only 2 first classes from the data
X = X[y <=1]
y = y[y <=1]

# normalize data
X = minmax_scale (X, feature_range =(0 , np.pi ))

# split data into train + validation and test
X_train_val , X_test , y_train_val , y_test = train_test_split (X, y, test_size =0.2)

Listing 8-3bLoad Data, Preprocess and Split qml_iris_pl.ipynb

```

ä¸‹ä¸€æ­¥æ˜¯æ„å»ºé‡å­åˆ†ç±»å™¨ã€‚ä¸ºäº†å®ç°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å®šä¹‰é‡å­ä½çš„æ•°é‡ä»¥åŒ¹é…ç‰¹å¾çš„æ•°é‡ï¼Œç”¨`DefaultQubit()`å‡½æ•°å®šä¹‰ä¸€ä¸ªè®¾å¤‡ï¼Œä¸ºå˜åˆ†åˆ†ç±»å™¨å’Œæˆæœ¬å‡½æ•°è®¾ç½®ä¸€ä¸ªå‡½æ•°ã€‚

```py
# Building the Quantum Classifier
# number of qubits is equal to the number of features
n_qubits = X.shape [1]

# quantum device handle
dev = DefaultQubit(n_qubits)

# quantum circuit
@qml.qnode (dev )
def circuit (weights , x= None ):
    AngleEmbedding (x, wires = range (n_qubits ))
    StronglyEntanglingLayers (weights , wires = range ( n_qubits ))
    return qml.expval ( qml.PauliZ (0))

# variational quantum classifier
def variational_classifier (theta, x= None ):
    weights = theta [0]
    bias = theta [1]
    return circuit ( weights , x=x) + bias

def cost (theta , X, expectations ):
    e_predicted = \
      np.array ([ variational_classifier (theta , x=x) for x in X])
    loss = np.mean (( e_predicted - expectations )**2)
    return loss

Listing 8-3cBuilding the Quantum Classifier qml_iris_pl.ipynb

```

`StronglyEntanglingLayers()`çš„å‚æ•°`weights,`åŒ…å«æ¯å±‚çš„æƒé‡ã€‚ <sup>7</sup> å±‚æ•°æ¥æºäº`weights`çš„ç¬¬ä¸€ç»´åº¦ã€‚

```py
# number of quantum layers
n_layers = 3

# split into train and validation
X_train , X_validation , y_train , y_validation = \
train_test_split ( X_train_val , y_train_val , test_size =0.20)

# convert classes to expectations : 0 to -1, 1 to +1
e_train = np. empty_like ( y_train )
e_train [ y_train == 0] = -1
e_train [ y_train == 1] = +1

# select learning batch size
batch_size = 5

# calculate numbe of batches
batches = len ( X_train ) // batch_size

# select number of epochs
n_epochs = 10

Listing 8-3dPrepare to Training the Data qml_iris_pl.ipynb

```

è¿™æ®µä»£ç ç‰‡æ®µè¿è¡Œäº†åä¸ªæ—¶æœŸã€‚æˆ‘å»ºè®®ä½ å…ˆé€šè¿‡è®¾ç½®`n_epochs = 5,`è¿è¡Œäº”ä¸ªçºªå…ƒï¼Œç„¶åå†è¿è¡Œåä¸ªçºªå…ƒã€‚å†å…ƒè¿è¡Œçš„å·®å¼‚åæ˜ åœ¨æœ€ç»ˆç²¾åº¦è®¡ç®—ä¸­ã€‚

åœ¨ä¸‹ä¸€æ­¥ä¸­ï¼Œæˆ‘ä»¬å¯¹æ•°æ®æ–½åŠ éšæœºæƒé‡ï¼Œè®­ç»ƒå˜åˆ†åˆ†ç±»å™¨ï¼Œè®©ä¼˜åŒ–å™¨å¼€å§‹å­¦ä¹ è¿‡ç¨‹ï¼Œå¹¶å°†è®­ç»ƒæ•°æ®åˆ†æˆæ‰¹æ¬¡ï¼Œå°±åƒæˆ‘ä»¬åœ¨ç¬¬ 2 å’Œ 3 ç« ä¸­å¯¹ç»å…¸ç³»ç»Ÿæ‰€åšçš„é‚£æ ·ã€‚

```py
# draw random quantum node weights
theta_weights = strong_ent_layers_uniform ( n_layers , n_qubits , seed =42)
theta_bias = 0.0
theta_init = ( theta_weights , theta_bias ) # initial weights

# train the variational classifier
theta = theta_init
# start of main learning loop
# build the optimizer object
pennylane_opt = GradientDescentOptimizer ()

# split training data into batches
X_batches = np.array_split (np.arange (len ( X_train )), batches )
for it , batch_index in enumerate ( chain (*( n_epochs * [ X_batches ]))):
    # Update the weights by one optimizer step
    batch_cost = \
        lambda theta : cost (theta , X_train [ batch_index ], e_train [ batch_index ])
    theta = pennylane_opt.step ( batch_cost , theta )
    # use X_validation and y_validation to decide whether to stop
# end of learning loop

Listing 8-3eTrain the Data! qml_iris_pl.ipynb

```

æœ€åï¼Œæ—¢ç„¶æˆ‘ä»¬å·²ç»å®šä¹‰å¹¶å‡†å¤‡å¥½äº†æ‰€æœ‰çš„å·¥å…·ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ¢ç´¢æ¨è®ºäº†ã€‚

```py
# Inference
# convert expectations to classes
expectations = np. array ([ variational_classifier (theta , x=x) for x in X_test ])
prob_class_one = ( expectations + 1.0) / 2.0
y_pred = ( prob_class_one >= 0.5)

print ( metrics . accuracy_score ( y_test , y_pred ))
print ("Accuracy: {:.2f} %".format(metrics.accuracy_score ( y_test , y_pred )*100))
print ( metrics.confusion_matrix ( y_test , y_pred ))

Listing 8-3fInference qml_iris_pl.ipynb

```

æ­¤ä»£ç å—åœ¨`n_epochs`å€¼ä¸º 10 æ—¶è¾“å‡ºä»¥ä¸‹å†…å®¹ã€‚

![img/502577_1_En_8_Figo_HTML.jpg](img/502577_1_En_8_Figo_HTML.jpg)

ç„¶è€Œï¼Œå¦‚æœæˆ‘ä»¬é€šè¿‡è®¾ç½®`n_epochs = 5`å°†å†å…ƒå‡å°‘åˆ°å€¼ 5ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°ä¸‹é¢çš„è¾“å‡ºã€‚

![img/502577_1_En_8_Figp_HTML.jpg](img/502577_1_En_8_Figp_HTML.jpg)

æ­£å¦‚åœ¨ç»å…¸æ¡ˆä¾‹ä¸­æ‰€é¢„æœŸçš„é‚£æ ·ï¼Œå¯¹äºæ›´å¤šçš„å†å…ƒï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°æ›´å‡†ç¡®çš„ç»“æœã€‚

## å¼ é‡æµé‡å­ QNN

QNN è¢«è§£é‡Šä¸ºä»»ä½•å…·æœ‰å¯è®­ç»ƒè¿ç»­å‚æ•°çš„é‡å­ç”µè·¯ã€‚QNN æ˜¯ä¸€ç§æœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œå…è®¸é‡å­è®¡ç®—æœºå¯¹å„ç§æ•°æ®é›†è¿›è¡Œåˆ†ç±»ï¼Œå…¶ä¸­åŒ…æ‹¬å›¾åƒæ•°æ®ã€‚ä½¿ç”¨çš„å›¾åƒæ•°æ®æ˜¯ç»å…¸æ•°æ®ï¼Œä½†ç»å…¸æ•°æ®æ— æ³•è¾¾åˆ°å åŠ çŠ¶æ€ã€‚å› æ­¤ï¼Œè¦åœ¨é‡å­ç³»ç»Ÿä¸Šå®ç°è¿™ä¸ªåè®®ï¼Œæ•°æ®å¿…é¡»èƒ½å¤Ÿè¢«ä¸€ä¸ªæä¾›å åŠ çš„é‡å­è®¾å¤‡è¯»å–ã€‚QNN é¢†åŸŸç›¸å¯¹è¾ƒæ–°ï¼Œå› ä¸ºè¯¥é¢†åŸŸçš„ç ”ç©¶å’Œå·¥ä½œæŒç»­å¢é•¿ã€‚æˆ‘ä»¬ä¹‹å‰å·²ç»çœ‹åˆ°äº†ä¸€äº›è§£å†³ç‰¹å®š QNN é—®é¢˜çš„ PennyLane ä»£ç çš„ä¾‹å­ã€‚æœ¬èŠ‚ç€çœ¼äº QNN çš„*å›¾åƒåˆ†ç±»*ã€‚

QNN ä½¿ç”¨ç›‘ç£å­¦ä¹ æ–¹æ³•æ¥é¢„æµ‹å›¾åƒæ•°æ®ï¼Œå¦‚ Benedettiï¼ŒLloyd ç­‰äºº(2019) [186]æ‰€ç¤ºã€‚Farhi å’Œ Neven åœ¨ 2019 å¹´æå‡ºäº†[185]ä¸€ç§ QNNï¼Œå¯ä»¥è¡¨ç¤ºç»å…¸æˆ–é‡å­çš„æ ‡è®°æ•°æ®ï¼Œå¹¶é€šè¿‡ç›‘ç£å­¦ä¹ è¿›è¡Œè®­ç»ƒã€‚é‡å­ç”µè·¯ç”±ä¸€ç³»åˆ—ä¾èµ–äºå‚æ•°çš„å¹ºæ­£å˜æ¢ç»„æˆï¼Œå®ƒä½œç”¨äºä¸€ä¸ªè¾“å…¥é‡å­æ€ã€‚å¯¹äºäºŒè¿›åˆ¶åˆ†ç±»ï¼Œåœ¨æŒ‡å®šçš„è¯»å‡ºé‡å­ä½ä¸Šæµ‹é‡å•ä¸ªæ³¡åˆ©ç®—ç¬¦ã€‚æµ‹é‡è¾“å‡ºæ˜¯è¾“å…¥çŠ¶æ€äºŒè¿›åˆ¶æ ‡ç­¾çš„ QNN é¢„æµ‹å™¨ã€‚è®ºæ–‡çš„ä½œè€…[185]å†™é“ï¼Œâ€œæˆ‘ä»¬ç»§ç»­ä½¿ç”¨å•è¯ *neural* æ¥æè¿°æˆ‘ä»¬çš„ç½‘ç»œï¼Œå› ä¸ºè¯¥æœ¯è¯­å·²è¢«æœºå™¨å­¦ä¹ ç¤¾åŒºé‡‡ç”¨ï¼Œå¹¶è®¤è¯†åˆ°ä¸ç¥ç»ç§‘å­¦çš„è”ç³»ç°åœ¨åªæ˜¯å†å²ã€‚â€å¯¹äºç±» MNIST å›¾åƒåˆ†ç±»ï¼Œä½œè€…åœ¨ç”µè·¯ä¸­éšæœºåˆ†é…ä¸¤ä¸ªé‡å­æ¯”ç‰¹çš„å•ä½ã€‚ç”¨äºå­é›†å®‡ç§°çš„ Reed-Muller è¡¨ç¤º[187]æ˜¯è€ƒè™‘ä¸¤é‡å­ä½å•ä½çš„å¦ä¸€ç§æ–¹å¼ã€‚

![img/502577_1_En_8_Fig7_HTML.jpg](img/502577_1_En_8_Fig7_HTML.jpg)

å›¾ 8-7

é‡å­å¤„ç†å™¨ä¸Š QNN çš„ç¤ºæ„å›¾(æ¥æº Farhi å’Œ Nevenï¼Œ2019 [185])

å›¾ 8-7 å±•ç¤ºäº† Farhi å’Œ Nevenã€185ã€‘åœ¨é‡å­å¤„ç†å™¨ä¸Šæå‡ºçš„ QNN çš„ç¤ºæ„å›¾ã€‚âˆ£ *Ïˆ* ï¼Œâ€¦ï¼Œ1âŸ©æ˜¯å‡†å¤‡å¥½çš„è¾“å…¥çŠ¶æ€ï¼Œç„¶åé¦ˆå…¥ QNNã€‚è¿™äº›è¾“å…¥çŠ¶æ€ç»å†ç”±*u*<sub>*I*</sub>(*Î¸*<sub>*I*</sub>)ä¾èµ–äºå‚æ•° *Î¸* <sub>*i*</sub> ç»™å‡ºçš„ä¸€ç³»åˆ—*å°‘æ•°*é‡å­ä½å•ä½ï¼Œè¿™äº›é‡å­ä½å•ä½åˆåœ¨å­¦ä¹ è¿‡ç¨‹ä¸­å¾—åˆ°è°ƒæ•´ï¼Œä½¿å¾—*y*<sub>*n*</sub>

 *TensorFlow Quantum (TFQ)ç”±å¸ƒåŠ³é¡¿ç­‰äººåœ¨ 2020 å¹´æå‡º[191]ï¼Œæ˜¯ä¸€ä¸ªç”¨äºæ··åˆé‡å­-ç»å…¸æœºå™¨å­¦ä¹ çš„ Python æ¡†æ¶ï¼Œä¸»è¦ä¸“æ³¨äºå¯¹é‡å­æ•°æ®è¿›è¡Œå»ºæ¨¡ã€‚TFQ æ˜¯ä¸€ä¸ªåº”ç”¨ç¨‹åºæ¡†æ¶ï¼Œæ—¨åœ¨å…è®¸é‡å­ç®—æ³•ç ”ç©¶äººå‘˜å’Œæœºå™¨å­¦ä¹ åº”ç”¨ç ”ç©¶äººå‘˜æ¢ç´¢åˆ©ç”¨è°·æ­Œé‡å­è®¡ç®—äº§å“çš„è®¡ç®—å·¥ä½œæµï¼Œæ‰€æœ‰è¿™äº›éƒ½æ¥è‡ª TensorFlowã€‚è°·æ­Œäººå·¥æ™ºèƒ½äº 2020 å¹´ 3 æœˆå‘å¸ƒäº† TFQï¼Œä½œä¸ºé‡å­æœºå™¨å­¦ä¹ æ¨¡å‹å¿«é€ŸåŸå‹çš„å¼€æºåº“ã€‚TFQ ä¾èµ–äº Cirqï¼Œè¿™æ˜¯ä¸€ä¸ªåœ¨è¿‘æœŸè®¡ç®—æœºä¸Šå®ç°é‡å­ç”µè·¯çš„å¼€æºå¹³å°ã€‚Cirq åŒ…æ‹¬å®šä¹‰é‡å­è®¡ç®—æ‰€éœ€çš„åŸºæœ¬ç»“æ„ï¼Œå¦‚é‡å­ä½ã€é—¨ã€ç”µè·¯å’Œè®¡ç®—è¿ç®—ç¬¦ã€‚Cirq èƒŒåçš„æ¦‚å¿µæ˜¯æä¾›ä¸€ä¸ªç®€å•çš„ç¼–ç¨‹æ¨¡å‹ï¼ŒæŠ½è±¡å‡ºé‡å­åº”ç”¨çš„åŸºæœ¬æ„ä»¶ã€‚

ç°åœ¨ï¼Œæˆ‘ä»¬å°†äº²èº«ä½“éªŒ TensorFlow quantumã€‚ <sup>8</sup> æœ¬ç»ƒä¹ <sup>9</sup>ã€188ã€‘æ„å»ºä¸€ä¸ª QNN å¯¹ MNIST çš„ç®€åŒ–ç‰ˆæœ¬è¿›è¡Œåˆ†ç±»ï¼Œç±»ä¼¼äº Farhi å’Œ Neven (2019) [185]ä¸­ä½¿ç”¨çš„æ–¹æ³•ã€‚å°† QNN åœ¨è¿™ä¸ªç»å…¸æ•°æ®é—®é¢˜ä¸Šçš„æ€§èƒ½ä¸ç»å…¸ç¥ç»ç½‘ç»œè¿›è¡Œæ¯”è¾ƒã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬åˆ©ç”¨è°·æ­Œåœ¨è°·æ­Œå®éªŒå®¤çš„å…è´¹è®¡ç®—èµ„æºï¼Œå¦‚ç¬¬ 1 ã€ 2 å’Œ 3 ç« æ‰€è¿°ã€‚ç¬¬ä¸€æ­¥ï¼Œæˆ‘ä»¬ä¸‹è½½å¹¶å®‰è£… TFQï¼Œè¿™æ˜¯ TensorFlow çš„å…ˆå†³æ¡ä»¶ã€‚

![img/502577_1_En_8_Figq_HTML.jpg](img/502577_1_En_8_Figq_HTML.jpg)

```py
!pip install tensorflow==2.3.1

Listing 8-4aInstall

TensorFlow qnn_mnist_tfq.ipynb

```

è¾“å‡º(æˆªæ–­)ã€‚

![img/502577_1_En_8_Figr_HTML.jpg](img/502577_1_En_8_Figr_HTML.jpg)

æ­¤æ­¥éª¤å¯èƒ½ä¼šæ˜¾ç¤ºä»¥ä¸‹æœ‰å…³é‡æ–°å¯åŠ¨ TensorFlow è¿è¡Œæ—¶çš„æ¶ˆæ¯ã€‚

![img/502577_1_En_8_Figs_HTML.jpg](img/502577_1_En_8_Figs_HTML.jpg)

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç‚¹å‡»`Restart Runtime`æŒ‰é’®ã€‚

æ¥ä¸‹æ¥ï¼Œå®‰è£… TFQã€‚

```py
!pip install tensorflow-quantum

Listing 8-4bInstall TensorFlow Quantum qnn_mnist_tfq.ipynb

```

è¾“å‡º(æˆªæ–­)ã€‚

![img/502577_1_En_8_Figu_HTML.jpg](img/502577_1_En_8_Figu_HTML.jpg)

![img/502577_1_En_8_Figt_HTML.jpg](img/502577_1_En_8_Figt_HTML.jpg)

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯¼å…¥ TensorFlow å’Œæ¨¡å—ä¾èµ–é¡¹ã€‚

```py
import tensorflow as tf
import tensorflow_quantum as tfq
import cirq
import sympy
import numpy as np
import seaborn as sns
import collections

# visualization tools
%matplotlib inline
import matplotlib.pyplot as plt
from cirq.contrib.svg import SVGCircuit

Listing 8-4cImport Libraries qnn_mnist_tfq.ipynb

```

ç°åœ¨ï¼Œæˆ‘ä»¬å‡†å¤‡åŠ è½½æ•°æ®ã€‚åœ¨æœ¬ç»ƒä¹ ä¸­ï¼Œæˆ‘ä»¬æŒ‰ç…§ Farhi å’Œ Neven [185]çš„æ–¹æ³•ï¼Œæ„å»ºäº†ä¸€ä¸ªäºŒå…ƒåˆ†ç±»å™¨æ¥åŒºåˆ†æ•°å­— 1 å’Œ 7ã€‚æœ¬èŠ‚ä»‹ç»æ•°æ®å¤„ç†ã€‚

1.  ä» Keras åŠ è½½åŸå§‹æ•°æ®ã€‚

2.  ä»…å°†æ•°æ®é›†è¿‡æ»¤ä¸º 1 å’Œ 7ã€‚

3.  ç¼©å°å›¾åƒçš„å°ºå¯¸ï¼Œä»¥ä¾¿å®ƒä»¬å¯ä»¥æ”¾å…¥é‡å­è®¡ç®—æœºã€‚

4.  åˆ é™¤ä»»ä½•çŸ›ç›¾çš„ä¾‹å­ã€‚

5.  å°†äºŒè¿›åˆ¶é•œåƒè½¬æ¢ä¸º Cirq ç”µè·¯ã€‚

6.  å°† Cirq ç”µè·¯è½¬æ¢ä¸º TFQ ç”µè·¯ã€‚

åœ¨ä¸‹ä¸€æ­¥ä¸­ï¼Œæˆ‘ä»¬åŠ è½½éš Keras ä¸€èµ·åˆ†å‘çš„åŸå§‹ MNIST æ•°æ®é›†ã€‚

```py
(x_train, y_train), (x_test, y_test) = tf.keras.datasets.mnist.load_data()

# Rescale the images from [0,255] to the [0.0,1.0] range.
x_train, x_test = x_train[..., np.newaxis]/255.0, x_test[..., np.newaxis]/255.0

print("Number of original training examples:", len(x_train))
print("Number of original test examples:", len(x_test))

Listing 8-4dLoad the Data qnn_mnist_tfq.ipynb

```

è¾“å‡ºã€‚

![img/502577_1_En_8_Figv_HTML.jpg](img/502577_1_En_8_Figv_HTML.jpg)

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¿‡æ»¤æ•°æ®é›†ï¼Œåªä¿ç•™ 1 å’Œ 7ï¼Œåˆ é™¤å…¶ä»–ç±»ã€‚åŒæ—¶ï¼Œå°†æ ‡ç­¾ *y* è½¬æ¢ä¸º`boolean`:1 ä¸ºçœŸï¼Œ7 ä¸ºå‡ã€‚

```py
def filter_17(x, y):
    keep = (y == 1) | (y == 7)
    x, y = x[keep], y[keep]
    y = y == 1
    return x,y

x_train, y_train = filter_17(x_train, y_train)
x_test, y_test = filter_17(x_test, y_test)

print("Number of filtered training examples:", len(x_train))
print("Number of filtered test examples:", len(x_test))

Listing 8-4eFilter the Data qnn_mnist_tfq.ipynb

```

è¿‡æ»¤è¿‡ç¨‹çš„è¾“å‡ºè¯»å‡ºç”¨äºè®­ç»ƒå’Œæµ‹è¯•åˆ†å‰²çš„æ•°å­—ã€‚

![img/502577_1_En_8_Figw_HTML.jpg](img/502577_1_En_8_Figw_HTML.jpg)

æˆ‘ä»¬å°è¯•äº†ä¸€ä¸ªä¾‹å­ï¼Œçœ‹çœ‹æ•°æ®æ˜¯ä»€ä¹ˆæ ·çš„ã€‚

```py
print(y_train[0])
plt.imshow(x_train[0, :, :, 0])
plt.colorbar()

Listing 8-4fExample qnn_mnist_tfq.ipynb

```

è¿™ä¸ªä»£ç å—ç»™å‡ºäº†ä¸‹é¢çš„è¾“å‡ºã€‚

![img/502577_1_En_8_Figx_HTML.jpg](img/502577_1_En_8_Figx_HTML.jpg)

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†å›¾åƒç¼©å°åˆ° 4 Ã— 4ï¼Œå› ä¸º 28 Ã— 28 çš„å›¾åƒå°ºå¯¸å¯¹äºå½“å‰çš„é‡å­è®¡ç®—æœºæ¥è¯´å¤ªå¤§äº†ï¼Œå¹¶åœ¨è°ƒæ•´å¤§å°åæ˜¾ç¤ºå®ƒã€‚

```py
x_train_small = tf.image.resize(x_train, (4,4)).numpy()
x_test_small = tf.image.resize(x_test, (4,4)).numpy()
print(y_train[0])
plt.imshow(x_train_small[0,:,:,0], vmin=0, vmax=1)
plt.colorbar()

Listing 8-4gExample qnn_mnist_tfq.ipynb

```

ä»¥ä¸‹æ˜¯è¾“å‡ºã€‚

![img/502577_1_En_8_Figy_HTML.jpg](img/502577_1_En_8_Figy_HTML.jpg)

ä¸‹ä¸€æ­¥æ˜¯é€šè¿‡ç”¨é‡å­ä½è¡¨ç¤ºæ¯ä¸ªåƒç´ ï¼Œå°†æ•°æ®ç¼–ç ä¸ºé‡å­ç”µè·¯ï¼Œå…¶ä¸­é‡å­ä½çŠ¶æ€å–å†³äºåƒç´ çš„å€¼ã€‚ç¬¬ä¸€æ­¥æ˜¯è½¬æ¢æˆäºŒè¿›åˆ¶ç¼–ç ã€‚

```py
THRESHOLD = 0.5
x_train_bin = np.array(x_train_nocon > THRESHOLD, dtype=np.float32)
x_test_bin = np.array(x_test_small > THRESHOLD, dtype=np.float32)

Listing 8-4hBinary Encoding qnn_mnist_tfq.ipynb

```

ç°åœ¨ï¼Œæˆ‘ä»¬é€šè¿‡ä¸€ä¸ª X é—¨æ—‹è½¬é‡å­ä½ï¼Œåƒç´ ç´¢å¼•å€¼è¶…è¿‡ä¸€ä¸ªé˜ˆå€¼ï¼Œå½¢æˆä¸€ä¸ªç”µè·¯ã€‚

```py
def convert_to_circuit(image):
    """Encode truncated classical image into quantum datapoint."""
    values = np.ndarray.flatten(image)
    qubits = cirq.GridQubit.rect(4, 4)
    circuit = cirq.Circuit()
    for i, value in enumerate(values):
        if value:
            circuit.append(cirq.X(qubits[i]))
    return circuit
x_train_circ = [convert_to_circuit(x) for x in x_train_bin]
x_test_circ = [convert_to_circuit(x) for x in x_test_bin]
SVGCircuit(x_train_circ[0])

Listing 8-4iRotate Qubits Through X Gate qnn_mnist_tfq.ipynb

```

ä¸‹é¢æ˜¯ä¸ºç¬¬ä¸€ä¸ªä¾‹å­åˆ›å»ºçš„ç”µè·¯(ç”µè·¯å›¾æ²¡æœ‰æ˜¾ç¤ºé›¶é—¨é‡å­ä½)ã€‚

![img/502577_1_En_8_Figz_HTML.jpg](img/502577_1_En_8_Figz_HTML.jpg)

ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¯¥ç”µè·¯ä¸å›¾åƒå€¼è¶…è¿‡é˜ˆå€¼çš„æŒ‡æ•°è¿›è¡Œæ¯”è¾ƒã€‚

```py
bin_img = x_train_bin[0,:,:,0]
indices = np.array(np.where(bin_img)).T
indices

Listing 8-4jComparison qnn_mnist_tfq.ipynb

```

ä»¥ä¸‹è¾“å‡ºã€‚

![img/502577_1_En_8_Figaa_HTML.jpg](img/502577_1_En_8_Figaa_HTML.jpg)

é‡å­æ•°æ®ä»¥å¼ é‡çš„å½¢å¼åŠ è½½ï¼Œå®šä¹‰ä¸ºç”¨ Cirq ç¼–å†™çš„é‡å­ç”µè·¯ã€‚TensorFlow åœ¨é‡å­è®¡ç®—æœºä¸Šæ‰§è¡Œè¿™ä¸ªå¼ é‡ï¼Œç”Ÿæˆä¸€ä¸ª*é‡å­æ•°æ®é›†*ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ç°åœ¨å°†è¿™äº› Cirq ç”µè·¯è½¬æ¢ä¸º TensorFlow Quantum ( `tfq`)çš„*å¼ é‡*ï¼Œå¦‚æ¸…å• 8-4k æ‰€ç¤ºã€‚

```py
x_train_tfcirc = tfq.convert_to_tensor(x_train_circ)
x_test_tfcirc = tfq.convert_to_tensor(x_test_circ)

Listing 8-4kComparison qnn_mnist_tfq.ipynb

```

ç°åœ¨æˆ‘ä»¬å‡†å¤‡å»ºé€  QNNã€‚ç„¶è€Œï¼Œå¯¹å›¾åƒåˆ†ç±»çš„é‡å­ç”µè·¯ç»“æ„çš„æŒ‡å¯¼æ˜¯ç¨€ç–çš„ã€‚ç”±äºåˆ†ç±»æ˜¯åŸºäºå¯¹è¯»å‡ºé‡å­ä½çš„æœŸæœ›ï¼ŒFarhi ç­‰äººæå‡ºä½¿ç”¨åŒé‡å­ä½é—¨ï¼Œè¯»å‡ºé‡å­ä½æ€»æ˜¯èµ·ä½œç”¨ã€‚è¿™åœ¨æŸäº›æ–¹é¢ç±»ä¼¼äº Arjovsky ç­‰äºº[190]æå‡ºçš„è·¨åƒç´ è¿è¡Œå°å‹é…‰ RNNã€‚

ä¸ºäº†å®ç°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬ä»æ„å»ºæ¨¡å‹ç”µè·¯å¼€å§‹ã€‚ä¸‹é¢çš„ä»£ç å—æ˜¾ç¤ºäº†ä¸€ç§åˆ†å±‚çš„æ–¹æ³•ã€‚æ¯ä¸€å±‚ä½¿ç”¨åŒä¸€ä¸ªé—¨çš„ *n* ä¸ªå®ä¾‹ï¼Œæ¯ä¸ªæ•°æ®é‡å­ä½ä½œç”¨äºè¯»å‡ºé‡å­ä½ã€‚æˆ‘ä»¬ä»ä¸€ä¸ªç®€å•çš„ç±»å¼€å§‹ï¼Œåœ¨ç”µè·¯ä¸­å¢åŠ ä¸€å±‚è¿™æ ·çš„é—¨ã€‚

```py
class CircuitLayerBuilder():
    def __init__(self, data_qubits, readout):
        self.data_qubits = data_qubits
        self.readout = readout

    def add_layer(self, circuit, gate, prefix):
        for i, qubit in enumerate(self.data_qubits):
            symbol = sympy.Symbol(prefix + '-' + str(i))
            circuit.append(gate(qubit, self.readout)**symbol)
demo_builder = CircuitLayerBuilder(data_qubits = cirq.GridQubit.rect(4,1),
                                   readout=cirq.GridQubit(-1,-1))
circuit = cirq.Circuit()
demo_builder.add_layer(circuit, gate = cirq.XX, prefix='xx')
SVGCircuit(circuit)

Listing 8-4lBuild the QNN Model Circuit qnn_mnist_tfq.ipynb

```

è¾“å‡ºæ˜¾ç¤ºäº†ç”µè·¯ã€‚

![img/502577_1_En_8_Figab_HTML.jpg](img/502577_1_En_8_Figab_HTML.jpg)

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å»ºç«‹ä¸€ä¸ªä¸¤å±‚æ¨¡å‹ï¼ŒåŒ¹é…æ•°æ®ç”µè·¯çš„å¤§å°ï¼Œå¹¶åŒ…æ‹¬å‡†å¤‡å’Œè¯»å‡ºæ“ä½œã€‚

```py
def create_quantum_model():
    """Create a QNN model circuit and readout operation to go along with it."""
    data_qubits = cirq.GridQubit.rect(4, 4)  # a 4x4 grid
    readout = cirq.GridQubit(-1, -1)         # a single qubit at [-1,-1]
    circuit = cirq.Circuit()

    # Prepare the readout qubit.
    circuit.append(cirq.X(readout))
    circuit.append(cirq.H(readout))
    builder = CircuitLayerBuilder(
        data_qubits = data_qubits,
        readout=readout)
    # Then add layers (experiment by adding more).
    builder.add_layer(circuit, cirq.XX, "xx1")
    builder.add_layer(circuit, cirq.ZZ, "zz1")
    # Finally, prepare the readout qubit.
    circuit.append(cirq.H(readout))
    return circuit, cirq.Z(readout)
model_circuit, model_readout = create_quantum_model()

Listing 8-4mBuild a Two-Layer Model qnn_mnist_tfq.ipynb

```

ä¸‹ä¸€ä¸ªä»»åŠ¡æ˜¯ç”¨é‡å­ç»„ä»¶å°†æ¨¡å‹ç”µè·¯åŒ…è£…åœ¨ tfq-keras æ¨¡å‹ä¸­ï¼Œä»¥ä¾¿è®­ç»ƒå®ƒã€‚è¿™ä¸ªæ¨¡å‹è¢«è¾“å…¥æ¥è‡ª`x_train_circ`çš„é‡å­æ•°æ®ï¼Œå®ƒå¯¹ç»å…¸æ•°æ®è¿›è¡Œç¼–ç ã€‚å®ƒä½¿ç”¨ä¸€ä¸ª*å‚æ•°åŒ–é‡å­ç”µè·¯*å±‚`tfq.layers.PQC`ï¼Œæ ¹æ®é‡å­æ•°æ®è®­ç»ƒæ¨¡å‹ç”µè·¯ã€‚Farhi ç­‰äººæå‡ºåœ¨å‚æ•°åŒ–ç”µè·¯ä¸­é‡‡ç”¨è¯»å‡ºé‡å­ä½çš„æœŸæœ›å€¼æ¥å¯¹è¿™äº›å›¾åƒè¿›è¡Œåˆ†ç±»ã€‚æœŸæœ›å€¼è¿”å›ä¸€ä¸ªä»‹äº 1 å’Œâ€“1 ä¹‹é—´çš„å€¼ã€‚

```py
# Build the Keras model.
model = tf.keras.Sequential([
    # The input is the data-circuit, encoded as a tf.string
    tf.keras.layers.Input(shape=(), dtype=tf.string),
    # The PQC layer returns the expected value of the readout gate, range [-1,1].
    tfq.layers.PQC(model_circuit, model_readout),
])

Listing 8-4nBuild Keras Wrapper qnn_mnist_tfq.ipynb

```

ç”±äºé¢„æœŸè¯»æ•°åœ¨`[â€“1,1]`èŒƒå›´å†…ï¼Œä¼˜åŒ–é“°é“¾æŸè€—æ˜¯ä¸€ä¸ªè‡ªç„¶çš„é€‰æ‹©ã€‚

Note

å¦ä¸€ç§æœ‰æ•ˆçš„æ–¹æ³•æ˜¯å°†è¾“å‡ºèŒƒå›´ç§»åŠ¨åˆ°[0ï¼Œ1]ï¼Œå¹¶å°†å…¶è§†ä¸ºæ¨¡å‹åˆ†é…ç»™ç±» 1 çš„æ¦‚ç‡ã€‚è¿™å¯ä»¥ä¸æ ‡å‡†çš„ a TF . loss . binary cross entropy loss ä¸€èµ·ä½¿ç”¨ã€‚

ä¸ºäº†ä½¿ç”¨è¿™é‡Œçš„é“°é“¾æŸè€—ï¼Œæˆ‘ä»¬éœ€è¦åšä¸¤ä¸ªå°çš„è°ƒæ•´ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å°†æ ‡ç­¾`y_train_nocon`ä»å¸ƒå°”è½¬æ¢ä¸º`[-1,1]`ï¼Œæ­£å¦‚é“°é“¾æŸè€—æ‰€é¢„æœŸçš„ã€‚

```py
y_train_hinge = 2.0*y_train_nocon-1.0
y_test_hinge = 2.0*y_test-1.0

```

æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªå®šåˆ¶çš„`hinge_accuracy`åº¦é‡ï¼Œå®ƒæ­£ç¡®åœ°å°†`[â€“1, 1]`ä½œä¸º`y_true`æ ‡ç­¾å‚æ•°ã€‚

```py
def hinge_accuracy(y_true, y_pred):
    y_true = tf.squeeze(y_true) > 0.0
    y_pred = tf.squeeze(y_pred) > 0.0
    result = tf.cast(y_true == y_pred, tf.float32)
    return tf.reduce_mean(result)

model.compile(
    loss=tf.keras.losses.Hinge(),
    optimizer=tf.keras.optimizers.Adam(),
    metrics=[hinge_accuracy])

print(model.summary())

Listing 8-4oLabel Argument qnn_mnist_tfq.ipynb

```

è¿™å°†æ‰“å°å‡ºæ¨¡å‹æ‘˜è¦ã€‚

![img/502577_1_En_8_Figac_HTML.jpg](img/502577_1_En_8_Figac_HTML.jpg)

æˆ‘ä»¬ç°åœ¨è®­ç»ƒ QNN æ¨¡å‹ï¼Œå¤§çº¦éœ€è¦ 30 åˆ° 45 åˆ†é’Ÿâ€”â€”å–å†³äºæ‚¨çš„ç³»ç»Ÿã€‚å¦‚æœä½ ä¸æƒ³ç­‰é‚£ä¹ˆä¹…ï¼Œä½¿ç”¨æ•°æ®çš„ä¸€ä¸ªå°çš„å­é›†(ä¸‹é¢çš„ set `NUM_EXAMPLES=500`)ã€‚è¿™ä¸ä¼šå½±å“æ¨¡å‹åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­çš„è¿›åº¦ï¼Œå› ä¸ºå®ƒåªæœ‰ 32 ä¸ªå‚æ•°ï¼Œå› æ­¤ï¼Œçº¦æŸè¿™äº›å‚æ•°æ‰€éœ€çš„æ•°æ®å¹¶ä¸å¤šã€‚ä½¿ç”¨è¾ƒå°‘çš„ä¾‹å­å¯ä»¥æ›´æ—©åœ°ç»“æŸè®­ç»ƒ(å¤§çº¦ 5 åˆ†é’Ÿ)ï¼Œä½†æ˜¯è¿è¡Œæ—¶é—´è¶³å¤Ÿé•¿ï¼Œå¯ä»¥æ˜¾ç¤ºå®ƒåœ¨éªŒè¯æ—¥å¿—ä¸­å–å¾—äº†è¿›å±•ã€‚

```py
EPOCHS = 3
BATCH_SIZE = 32
NUM_EXAMPLES = len(x_train_tfcirc)
x_train_tfcirc_sub = x_train_tfcirc[:NUM_EXAMPLES]
y_train_hinge_sub = y_train_hinge[:NUM_EXAMPLES]
qnn_history = model.fit(
      x_train_tfcirc_sub, y_train_hinge_sub,
      batch_size=32,
      epochs=EPOCHS,
      verbose=1,

      validation_data=(x_test_tfcirc, y_test_hinge))
qnn_results = model.evaluate(x_test_tfcirc, y_test)

Listing 8-4pTrain the Quantum Model qnn_mnist_tfq.ipynb

```

è¿™ç»™å‡ºäº†é“°é“¾ç²¾åº¦ã€è¿è¡Œæ—¶é—´å’ŒæŸè€—çš„ä»¥ä¸‹è¾“å‡ºã€‚

![img/502577_1_En_8_Figad_HTML.jpg](img/502577_1_En_8_Figad_HTML.jpg)

è®­ç»ƒç²¾åº¦æŠ¥å‘Šäº†æ•´ä¸ªæ—¶æœŸçš„å¹³å‡å€¼ã€‚åœ¨æ¯ä¸ªæ—¶æœŸç»“æŸæ—¶è¯„ä¼°éªŒè¯å‡†ç¡®æ€§ã€‚

æ—¢ç„¶æˆ‘ä»¬å·²ç»çœ‹äº†äº‹ç‰©çš„é‡å­æ–¹é¢ï¼Œæˆ‘ä»¬å¯èƒ½å¸Œæœ›æ‰¾å‡ºä¸€ä¸ªç»å…¸ç½‘ç»œå¦‚ä½•åœ¨ç›¸åŒçš„æ•°æ®é›†ä¸Šè¿è¡Œã€‚å°½ç®¡ QNN å¯ä»¥è§£å†³è¿™ä¸ªç®€åŒ–çš„ MNIST é—®é¢˜ï¼Œä½†åŸºæœ¬çš„ç»å…¸ç¥ç»ç½‘ç»œåœ¨è¿™ä¸ªä»»åŠ¡ä¸Šå¯ä»¥èƒœè¿‡ QNNã€‚åœ¨å•ä¸ªæ—¶æœŸä¹‹åï¼Œä¼ ç»Ÿçš„ç¥ç»ç½‘ç»œå¯ä»¥åœ¨ç»´æŒé›†ä¸Šå®ç°> 98%çš„å‡†ç¡®åº¦ã€‚

åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œç»å…¸çš„ç¥ç»ç½‘ç»œç”¨äº 1â€“7 åˆ†ç±»é—®é¢˜ï¼Œä½¿ç”¨*æ•´ä¸ª* 28 Ã— 28 å›¾åƒï¼Œè€Œä¸æ˜¯å¯¹å›¾åƒè¿›è¡ŒäºŒæ¬¡é‡‡æ ·ã€‚è¿™å¾ˆå®¹æ˜“æ”¶æ•›åˆ°æ¥è¿‘ 100%çš„æµ‹è¯•é›†çš„å‡†ç¡®æ€§ã€‚

```py
def create_classical_model():
    # A simple model based off LeNet from https://keras.io/examples/mnist_cnn/
    model = tf.keras.Sequential()
    model.add(tf.keras.layers.Conv2D(32, [3, 3], activation='relu', input_shape=(28,28,1)))
    model.add(tf.keras.layers.Conv2D(64, [3, 3], activation='relu'))
    model.add(tf.keras.layers.MaxPooling2D(pool_size=(2, 2)))
    model.add(tf.keras.layers.Dropout(0.25))
    model.add(tf.keras.layers.Flatten())
    model.add(tf.keras.layers.Dense(128, activation='relu'))
    model.add(tf.keras.layers.Dropout(0.5))
    model.add(tf.keras.layers.Dense(1))
    return model
model = create_classical_model()
model.compile(loss=tf.keras.losses.BinaryCrossentropy(from_logits=True),
              optimizer=tf.keras.optimizers.Adam(),
              metrics=['accuracy'])
model.summary()

Listing 8-4qBuild the Classical Model qnn_mnist_tfq.ipynb

```

è¿™å°†ç”Ÿæˆå¦‚ä¸‹çš„æ¨¡å‹æ‘˜è¦ã€‚

![img/502577_1_En_8_Figae_HTML.jpg](img/502577_1_En_8_Figae_HTML.jpg)

è¿™ä¸ªæ¨¡å‹æœ‰å°†è¿‘ 120 ä¸‡ä¸ªå‚æ•°ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æŒ‰å¦‚ä¸‹æ–¹å¼è®­ç»ƒç»å…¸æ¨¡å‹ã€‚

```py
model.fit(x_train,
          y_train,
          batch_size=128,
          epochs=1,
          verbose=1,
          validation_data=(x_test, y_test))

cnn_results = model.evaluate(x_test, y_test)

Listing 8-4rTrain the Classical Model qnn_mnist_tfq.ipynb

```

è¿™ä¸ªä»£ç å—ä¸ºå…·æœ‰ 120 ä¸‡ä¸ªå‚æ•°çš„ç»å…¸æ¨¡å‹ç”Ÿæˆç²¾åº¦ã€æŸè€—ç­‰æ–¹é¢çš„è¾“å‡ºã€‚ä¸ºäº†æ›´å…¬å¹³çš„æ¯”è¾ƒï¼Œæˆ‘ä»¬åœ¨äºŒæ¬¡æŠ½æ ·å›¾åƒä¸Šå°è¯• 37 å‚æ•°æ¨¡å‹ã€‚

```py
def create_fair_classical_model():
    # A simple model based off LeNet from https://keras.io/examples/mnist_cnn/
    model = tf.keras.Sequential()
    model.add(tf.keras.layers.Flatten(input_shape=(4,4,1)))
    model.add(tf.keras.layers.Dense(2, activation='relu'))
    model.add(tf.keras.layers.Dense(1))
    return model
model = create_fair_classical_model()
model.compile(loss=tf.keras.losses.BinaryCrossentropy(from_logits=True),
              optimizer=tf.keras.optimizers.Adam(),
              metrics=['accuracy'])

model.summary()

Listing 8-4s37-Parameter 

Model qnn_mnist_tfq.ipynb

```

è¿™å°±äº§ç”Ÿäº†æˆ‘ä»¬æƒ³è¦çš„ 37 å‚æ•°æ¨¡å‹ã€‚

![img/502577_1_En_8_Figaf_HTML.jpg](img/502577_1_En_8_Figaf_HTML.jpg)

ç°åœ¨ï¼Œæˆ‘ä»¬ç”¨ 37 ä¸ªå‚æ•°çš„æ–°èŒƒå›´æ¥è®­ç»ƒè¿™ä¸ªæ¨¡å‹ã€‚

```py
model.fit(x_train_bin,
          y_train_nocon,
          batch_size=128,
          epochs=20,
          verbose=2,
          validation_data=(x_test_bin, y_test))

fair_nn_results = model.evaluate(x_test_bin, y_test)

Listing 8-4tTrain the 37-Parameter Model qnn_mnist_tfq.ipynb

```

è¿™ç»™å‡ºäº†ä»¥ä¸‹(æˆªæ–­çš„)è¾“å‡ºã€‚

![img/502577_1_En_8_Figag_HTML.jpg](img/502577_1_En_8_Figag_HTML.jpg)

æœ€åï¼Œæˆ‘ä»¬æ¯”è¾ƒäº†é‡å­ç¥ç»ç½‘ç»œå’Œç»å…¸ç¥ç»ç½‘ç»œã€‚

```py
qnn_accuracy = qnn_results[1]
cnn_accuracy = cnn_results[1]
fair_nn_accuracy = fair_nn_results[1]
sns.barplot(["Quantum", "Classical, full", "Classical, fair"],
            [qnn_accuracy, cnn_accuracy, fair_nn_accuracy])

Listing 8-4uComparison of Quantum and Classical qnn_mnist_tfq.ipynb

```

æ­¤ä»£ç å—ç»™å‡ºä»¥ä¸‹è¾“å‡ºä½œä¸ºæ¯”è¾ƒã€‚

![img/502577_1_En_8_Figah_HTML.jpg](img/502577_1_En_8_Figah_HTML.jpg)

æ›´é«˜åˆ†è¾¨ç‡çš„è¾“å…¥å’Œæ›´å¼ºå¤§çš„æ¨¡å‹ä½¿å¾—è¿™ä¸ªé—®é¢˜å¯¹ CNN æ¥è¯´å¾ˆå®¹æ˜“ã€‚è™½ç„¶ç›¸ä¼¼åŠŸç‡(çº¦ 32 ä¸ªå‚æ•°)çš„ç»å…¸æ¨¡å‹åœ¨ä¸€å°éƒ¨åˆ†æ—¶é—´å†…è®­ç»ƒåˆ°ç›¸ä¼¼çš„ç²¾åº¦ï¼Œä½†ç»å…¸ç¥ç»ç½‘ç»œä¼˜äºé‡å­ç¥ç»ç½‘ç»œã€‚

åœ¨*ç»å…¸æ•°æ®é›†*ä¸­ï¼Œé‰´äºè¿‘æœŸé‡å­ç³»ç»Ÿçš„çŠ¶æ€ï¼Œé‡å­ç³»ç»Ÿå¾ˆéš¾å‡»è´¥ç»å…¸ç¥ç»ç½‘ç»œã€‚ç„¶è€Œï¼Œåœ¨å…·æœ‰ç»å…¸è¾“å…¥æ•°æ®çš„é‡å­ç³»ç»Ÿä¸Šçš„ç»ƒä¹ ç¡®å®æ‰¿è¯ºåˆ©ç”¨å¸Œå°”ä¼¯ç‰¹ç©ºé—´çš„å¤šç»´åº¦å’ŒæŸäº›ç‰¹å®šé—®é¢˜çš„å åŠ èƒ½åŠ›ã€‚ä»ç»å…¸æ•°æ®ä¸­è·å¾—çš„è§è§£ä¹Ÿä¸ºæˆ‘ä»¬åœ¨ä¸‹ä¸€ä»£é‡å­è®¡ç®—ç³»ç»Ÿä¸Šå®ç°ç®—æ³•åšå¥½äº†å‡†å¤‡ï¼Œæˆ‘ä»¬å¸Œæœ›è¿™å°†å¸¦æ¥å‰æ‰€æœªæœ‰çš„è®¡ç®—èƒ½åŠ›ã€‚

## é‡å­å·ç§¯ç¥ç»ç½‘ç»œ

å¦‚ç¬¬ä¸‰ç« æ‰€è§ï¼Œç»å…¸å·ç§¯ç¥ç»ç½‘ç»œ(CNN)æ˜¯å›¾åƒå¤„ç†å’Œè®¡ç®—æœºè§†è§‰ç›¸å…³é¢†åŸŸçš„æµè¡Œæ¨¡å‹ã€‚CNN çš„ç»“æ„åŒ…æ‹¬å°†äº¤æ›¿çš„*å·ç§¯å±‚*(åŠ ä¸Šä¸€ä¸ª*æ¿€æ´»å‡½æ•°*)å’Œ*æ±‡é›†*å±‚åº”ç”¨äºè¾“å…¥é˜µåˆ—ï¼Œé€šå¸¸åœ¨è¾“å‡ºä¹‹å‰è·Ÿéšä¸€äº›å®Œå…¨è¿æ¥çš„å±‚ã€‚å·ç§¯å±‚çš„å·¥ä½œåŸç†æ˜¯æ‰«ææ•´ä¸ªè¾“å…¥é˜µåˆ—ï¼Œå¹¶é€å—åº”ç”¨ä¸åŒçš„æ»¤æ³¢å™¨(é€šå¸¸æ˜¯ 2 Ã— 2 æˆ– 3 Ã— 3 çŸ©é˜µ)ã€‚å®ƒä»¬æ£€æµ‹å›¾åƒä¸­å¯èƒ½å‡ºç°çš„ç‰¹å®šç‰¹å¾ã€‚ç„¶åï¼Œä½¿ç”¨æ± å±‚å¯¹è¿™äº›å·ç§¯çš„ç»“æœè¿›è¡Œä¸‹é‡‡æ ·ï¼Œä»¥æå–æœ€ç›¸å…³çš„ç‰¹å¾å¹¶å‡å°‘æ•°æ®çš„å¤§å°ï¼Œä»è€Œæ›´å®¹æ˜“åœ¨åç»­å±‚ä¸­è¿›è¡Œå¤„ç†ã€‚å¸¸è§çš„æ± åŒ–æ–¹æ³•åŒ…æ‹¬ç”¨æœ€å¤§å€¼æˆ–å¹³å‡å€¼æ›¿æ¢æ•°æ®å—ã€‚

CNN å…·æœ‰ä¾¿äºæœ‰æ•ˆåˆ©ç”¨æ•°æ®çš„ç›¸å…³æ€§ä¿¡æ¯çš„å±æ€§ã€‚ç„¶è€Œï¼Œå¦‚æœæ•°æ®æˆ–æ¨¡å‹çš„ç»™å®šç»´åº¦å˜å¾—å¤ªå¤§(è¿™åœ¨å¤§æ•°æ®æ—¶ä»£å¾ˆå¯èƒ½å‘ç”Ÿ)ï¼Œä¸ CNN ç›¸å…³çš„è®¡ç®—è´¹ç”¨å¯èƒ½ä¼šå¾ˆå¿«æˆä¸ºä¸€ä¸ªæŒ‘æˆ˜ã€‚é‡å­å·ç§¯ç¥ç»ç½‘ç»œ(QCNN)ä½¿ç”¨é‡å­è®¡ç®—ç¯å¢ƒä¸º CNN æä¾›äº†ä¸€ç§æ–°çš„è§£å†³æ–¹æ¡ˆï¼Œä»¥æé«˜ç°æœ‰å­¦ä¹ æ¨¡å‹çš„æ€§èƒ½ã€‚

![img/502577_1_En_8_Fig8_HTML.jpg](img/502577_1_En_8_Fig8_HTML.jpg)

å›¾ 8-8

QCNN ç¤ºæ„å›¾(æ¥æºä¸›ç­‰ 2018 [193])

qcn é¦–å…ˆç”±ä¸›ç­‰äºº(2018) [193]æå‡ºã€‚QCNNs çš„ç»“æ„å— CNN ç»“æ„çš„å¯å‘ï¼Œå¦‚å›¾ 8-8 æ‰€ç¤ºã€‚åœ¨ QCNN ä¸­ï¼Œå·ç§¯æ˜¯åœ¨ç›¸é‚»é‡å­ä½å¯¹ä¸Šæ‰§è¡Œçš„æ“ä½œ(å‚æ•°åŒ–é…‰æ—‹è½¬)ï¼Œç±»ä¼¼äºå¸¸è§„çš„å˜åˆ†ç”µè·¯ã€‚è¿™äº›å·ç§¯ä¹‹åæ˜¯æ± å±‚ï¼Œæ± å±‚é€šè¿‡æµ‹é‡é‡å­ä½çš„å­é›†å¹¶ä½¿ç”¨æµ‹é‡ç»“æœæ¥æ§åˆ¶åç»­æ“ä½œè€Œå—åˆ°å½±å“ã€‚å®Œå…¨è¿æ¥å±‚çš„æ¨¡æ‹Ÿæ˜¯åœ¨æœ€ç»ˆæµ‹é‡ä¹‹å‰å¯¹å‰©ä½™é‡å­ä½çš„å¤šé‡å­ä½æ“ä½œã€‚æ‰€æœ‰è¿™äº›æ“ä½œçš„å‚æ•°éƒ½æ˜¯åœ¨è®­ç»ƒæœŸé—´å­¦ä¹ çš„ã€‚

åœ¨ Ohï¼ŒChoi å’Œ Kim åœ¨ 2020 å¹´å®Œæˆçš„ç ”ç©¶ä¸­[192]æå‡ºäº†ä¸€ç§æ¨¡å‹ï¼Œé€šè¿‡å°† CNN çš„ç»“æ„åº”ç”¨äºé‡å­è®¡ç®—ç¯å¢ƒæ¥æœ‰æ•ˆåœ°è§£å†³é‡å­ç‰©ç†å’ŒåŒ–å­¦ä¸­çš„åˆ†ç±»é—®é¢˜ã€‚è¯¥ç ”ç©¶è¿˜æå‡ºäº†ä¸€ä¸ªå¯ä»¥ç”¨ O(log(n))æ·±åº¦è®¡ç®—çš„æ¨¡å‹ï¼Œä½¿ç”¨*å¤šå°ºåº¦çº ç¼ é‡æ•´åŒ– ansatz* (MERA)ã€‚

è¯¥ç ”ç©¶ä»‹ç»äº†ä¸€ç§æ–¹æ³•ï¼Œé€šè¿‡åœ¨ç°æœ‰è®¡ç®—æœºè§†è§‰ä¸­ä½¿ç”¨çš„ CNN å­¦ä¹ æ¨¡å‹ä¸­æ·»åŠ ä¸€ä¸ªä½¿ç”¨é‡å­ç³»ç»Ÿçš„å±‚æ¥æé«˜æ¨¡å‹çš„æ€§èƒ½ã€‚è¯¥æ¨¡å‹ä¹Ÿå¯ç”¨äºå°å‹é‡å­è®¡ç®—æœºã€‚æ··åˆå­¦ä¹ æ¨¡å‹å¯ä»¥é€šè¿‡åœ¨ CNN æ¨¡å‹ä¸­å¢åŠ ä¸€ä¸ªé‡å­å·ç§¯å±‚æˆ–è€…ç”¨å·ç§¯å±‚ä»£æ›¿æ¥è®¾è®¡ã€‚æœ¬æ–‡è¿˜é€šè¿‡ TensorFlow é‡å­å¹³å°ä½¿ç”¨ MNIST æ•°æ®é›†è¿›è¡Œè®­ç»ƒï¼ŒéªŒè¯äº† QCNN æ¨¡å‹ç›¸å¯¹äº CNN æ˜¯å¦èƒ½å¤Ÿé«˜æ•ˆå­¦ä¹ ã€‚

å…³äºä¸›ç­‰äºº[193]å…³äº QCNN çš„å¦ä¸€ç¯‡è®ºæ–‡çš„å®Œæ•´å®è·µæ•™ç¨‹å¯åœ¨ [`www.tensorflow.org/quantum/tutorials/qcnn`](http://www.tensorflow.org/quantum/tutorials/qcnn) çš„ Google AI ä¸Šè·å¾—ã€‚å¦‚æœä½ å¯¹é‡å­æ·±åº¦å­¦ä¹ æ„Ÿå…´è¶£ï¼Œè¯·æŒ‰ç…§è‡ªå·±çš„èŠ‚å¥æµè§ˆæ•™ç¨‹ã€‚

é‡å­ CNN çš„ä¸€ä¸ªè‡ªç„¶åº”ç”¨æ˜¯å¯¹é‡å­æ€è¿›è¡Œåˆ†ç±»ã€‚ä¸›ç­‰äºº[193]çš„åŸå§‹å·¥ä½œä½¿ç”¨å®ƒä»¬æ¥åŒºåˆ†ä¸åŒçš„æ‹“æ‰‘ç›¸ä½ã€‚QCNNs ä¹Ÿå¯ä»¥ç”¨æ¥åˆ†ç±»å›¾åƒï¼Œå°±åƒå®ƒä»¬çš„ç»å…¸å¯¹åº”ç‰©ä¸€æ ·ã€‚

## æ‘˜è¦

é‡å­æ•°æ®æ˜¯è‡ªç„¶æˆ–äººå·¥é‡å­ç³»ç»Ÿä¸­å‡ºç°çš„ä»»ä½•æ•°æ®æºã€‚è¿™å¯ä»¥æ˜¯ä»é‡å­åŠ›å­¦å®éªŒä¸­å¾—åˆ°çš„ç»å…¸æ•°æ®ï¼Œä¹Ÿå¯ä»¥æ˜¯ç”±é‡å­è®¾å¤‡ç›´æ¥ç”Ÿæˆçš„æ•°æ®ï¼Œç„¶åä½œä¸ºè¾“å…¥è¾“å…¥åˆ°ç®—æ³•ä¸­ã€‚æœ‰è¯æ®è¡¨æ˜ï¼Œç”±äºé‡å­åŠ›å­¦ç‰¹æ€§ï¼Œå¯¹*é‡å­æ•°æ®*çš„æ··åˆé‡å­-ç»å…¸æœºå™¨å­¦ä¹ åº”ç”¨å¯ä»¥æä¾›ä¼˜äºä»…ç»å…¸æœºå™¨å­¦ä¹ çš„é‡å­ä¼˜åŠ¿ã€‚é‡å­æ•°æ®è¡¨ç°å‡ºå åŠ å’Œçº ç¼ ï¼Œå¯¼è‡´è”åˆæ¦‚ç‡åˆ†å¸ƒï¼Œè¿™å¯èƒ½éœ€è¦æŒ‡æ•°æ•°é‡çš„ç»å…¸è®¡ç®—èµ„æºæ¥è¡¨ç¤ºæˆ–å­˜å‚¨ã€‚

ä¹Ÿè®¸é‡å­æœºå™¨å­¦ä¹ æœ€ç›´æ¥çš„åº”ç”¨æ˜¯é‡å­æ•°æ®â€”â€”é‡å­ç³»ç»Ÿå’Œè¿‡ç¨‹äº§ç”Ÿçš„å®é™…çŠ¶æ€ã€‚è®¸å¤šé‡å­æœºå™¨å­¦ä¹ ç®—æ³•é€šè¿‡å°†æ•°æ®æ˜ å°„åˆ°é‡å­åŠ›å­¦çŠ¶æ€ï¼Œç„¶åä½¿ç”¨åŸºæœ¬çš„é‡å­çº¿æ€§ä»£æ•°å­ä¾‹ç¨‹æ“çºµè¿™äº›çŠ¶æ€ï¼Œæ¥æ‰¾åˆ°ç»å…¸æ•°æ®ä¸­çš„æ¨¡å¼ã€‚è¿™äº›é‡å­æœºå™¨å­¦ä¹ ç®—æ³•å¯ä»¥ç›´æ¥åº”ç”¨äºå…‰å’Œç‰©è´¨çš„é‡å­æ€ï¼Œä»¥æ­ç¤ºå®ƒä»¬çš„æ½œåœ¨ç‰¹å¾å’Œæ¨¡å¼ã€‚ç”±æ­¤äº§ç”Ÿçš„é‡å­åˆ†ææ¨¡å¼é€šå¸¸æ¯”ä»é‡å­ç³»ç»Ÿä¸­æå–çš„æ•°æ®çš„ç»å…¸åˆ†ææ›´æœ‰æ•ˆå’Œæ›´æœ‰å¯å‘æ€§ã€‚

æœ¬ç« æ¢è®¨äº† D-Waveã€Xanadu çš„ PennyLane çš„ QNN å’Œ Google çš„ TensorFlow Quantum ä¸Šçš„æ—…è¡Œé”€å”®å‘˜é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆï¼Œå¹¶æ¢è®¨äº†é‡å­å·ç§¯ç¥ç»ç½‘ç»œã€‚æˆ‘ä»¬è¿˜æ¢è®¨äº† QCNN é¢†åŸŸçš„æœ€æ–°ç ”ç©¶å’Œè¿›å±•ã€‚

ç¬¬ä¹ç« æ¢ç´¢å…ˆè¿›çš„é¢†åŸŸï¼Œå¦‚é‡å­åŒ–å­¦ã€é‡å­è¡Œèµ°å’Œå±‚ææˆåƒï¼Œé‡å­æœºå™¨å­¦ä¹ åœ¨è¿™äº›é¢†åŸŸæ­£å˜å¾—æ´»è·ƒå¹¶æœ‰æœ›å‘å±•ã€‚

Footnotes 1

æ¹–æ³Šä¹˜æ•°: [`https://en.wikipedia.org/wiki/Lagrange_multiplier#:~:text=In%20mathematical%20optimization%2C%20the%20method,chosen%20values%20of%20the%20variables`](https://en.wikipedia.org/wiki/Lagrange_multiplier%2523:%257E:text%253DIn%252520mathematical%252520optimization%25252C%252520the%252520method,chosen%252520values%252520of%252520the%252520variables)

Â  2

å‡ºå·®é”€å”®äººå‘˜é—®é¢˜: [`https://en.wikipedia.org/wiki/Travelling_salesman_problem#cite_note-6`](https://en.wikipedia.org/wiki/Travelling_salesman_problem%2523cite_note-6)

Â  3

qbsolv åŸºäº Wangï¼ŒLuï¼ŒGlover å’Œ Hao (2012)çš„è®ºæ–‡â€œå¤§å‹æ— çº¦æŸäºŒå…ƒäºŒæ¬¡ä¼˜åŒ–çš„å¤šçº§ç®—æ³•â€ã€‚[163]

Â  4

ç»å…¸ç»å°”å…¹æ›¼æœº:[`https://en.wikipedia.org/wiki/Boltzmann_machine`](https://en.wikipedia.org/wiki/Boltzmann_machine)ã€167ã€‘

Â  5

pennylanae/pennylane æ ¹æ® Apache è®¸å¯è¯ 2.0 è·å¾—è®¸å¯ã€‚

Â  6

ç¦å…‹çŠ¶æ€: [`https://en.wikipedia.org/wiki/Fock_state#:~:text=In%20quantum%20mechanics%2C%20a%20Fock,the%20Soviet%20physicist%20Vladimir%20Fock`](https://en.wikipedia.org/wiki/Fock_state%2523:%257E:text%253DIn%252520quantum%252520mechanics%25252C%252520a%252520Fock,the%252520Soviet%252520physicist%252520Vladimir%252520Fock) ã€‚

Â  7

strong çº ç¼ å±‚æ–‡æ¡£: [`https://pennylane.readthedocs.io/en/stable/code/api/pennylane.templates.layers.StronglyEntanglingLayers.html`](https://pennylane.readthedocs.io/en/stable/code/api/pennylane.templates.layers.StronglyEntanglingLayers.html)

Â  8

å¯¹äºè¿™ä¸ªç»ƒä¹ ï¼Œä»£ç æ”¹ç¼–è‡ª TensorFlow Quantum æ–‡æ¡£: [`https://www.tensorflow.org/quantum/tutorials/mnist`](https://www.tensorflow.org/quantum/tutorials/mnist)

Â  9

æ ¹æ® Apache è®¸å¯è¯ 2.0 ç‰ˆè®¸å¯(â€œè®¸å¯è¯â€)

Â **