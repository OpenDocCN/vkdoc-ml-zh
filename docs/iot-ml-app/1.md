# 1.入门:必要的软件和硬件

本章将向你介绍单板计算机的世界。很多人第一次听到这个术语时，可能会想知道 SBC 是什么，它是用来做什么的。本章将解释 SBC 及其历史发展。您还将了解市场上最受欢迎的 SBC，如香蕉 Pi、树莓 Pi 和 Arduino。在深入的比较中，我将解释流行的 SBC 在 USB、存储、网络和通信方面的特性。

然后，您将了解 Raspberry Pi，尤其是 Raspberry Pi 3 模型 B+，因为您将在本书中将其用作物联网和 IIoT 项目的主节点。您还可以找到对位于 Raspberry Pi 上的 GPIO(通用输入/输出)引脚及其用途的深入解释。然后，您将了解单板微米辊(SBM)，它不同于单板计算机。物联网和 IIoT 应用中的单板微控制器一般被用作 Raspberry Pi 等单板计算机的从机。最受欢迎的单板微控制器是 Arduino，您可以通过详细的表格格式查看 SBM 的类型，包括它们的处理器、I/O 模块、频率、电压等。

然后，您将看到 Arduino Mega 2560 及其布局，并了解其 GPIO 引脚。接下来，你将了解本书最重要的主题:物联网传感器及其类型和应用。您将在案例研究解决方案中使用其中一些。还涵盖了无人机的主题，因为它们可以用于收集电信应用程序的数据。请注意，在大多数国家，驾驶无人机需要许可证，在试图将无人机用于任何项目之前，您应该遵守该许可证。您还将了解 Modbus 设备以及如何使用它来构建商业应用。最后，您将了解运行所有这些设备的软件程序。

Note

全书通篇使用 Python 版。如果您有一个旧版本的 Python，代码示例可能无法工作。您需要 Python 3.x 或更高版本才能成功运行它们。

## 硬件要求

要运行本书中的练习，您需要以下硬件:

*   **树莓 Pi 3 型号 B+**

*   **Arduino Mega 2560**

*   **LCD/LED 屏幕输出 Raspberry Pi 3 型号 B+**

*   **单相电能表:Modbus 220/230V，双向，多功能，RS485，脉冲/Modbus 输出**

*   **无人机:工业级，满足这些规格的重型起重:**
    *   **最大有效载荷:1.5 千克(3.5 磅)**

    *   **航程:5 公里**

    *   **飞行时间:至少 30 分钟**

### 单板计算机

单板计算机是安装在一块印刷电路板上的功能齐全的计算机。这种计算机的独特之处在于，整个输入、输出和处理(如图形和数字计算)都发生在同一块板上。虽然 SBC 可以被构建为高计算服务器，但是这种类型的计算机的更受欢迎的版本是小而紧凑的机器。

从历史上看，SBC 是为了教育和紧凑而建造的；现在它们被用于主流商业应用。

单板计算机建立在不同的微处理器上，但它们都是简单的设计。它们是为了方便和紧凑而制造的。运行一台占用空间很小、稳定且便携的快速计算机增加了拥有这些机器的魅力。

单板计算机的早期实现之一(1976 年 5 月)被称为 Diana micro 它基于英特尔 C8080A 处理器，是 BigBook 系列计算机中非常受欢迎的家用计算机。随着 PC 市场的扩大，SBC 没有进一步发展，直到现在，PC 几乎已经被平板电脑、笔记本电脑和移动设备所取代。可以去 [`https://en.wikipedia.org/wiki/Single-board_computer`](https://en.wikipedia.org/wiki/Single-board_computer) 了解更多信息。

使用 SBCs 的一些优势如表 [1-1](#Tab1) 所示。

表 1-1

SBC 的特点和优势

<colgroup><col class="tcol1 align-left"> <col class="tcol2 align-left"></colgroup> 
| 

特征

 | 

优势

 |
| --- | --- |
| 价格 | 如今，每台 SBC 的价格不到 30 美元。 |
| 波形因数 | 单板机非常小，几乎只有掌上电脑的大小，这使得它们便于携带和使用。 |
| 操作系统 | Linux 变种最受欢迎。Windows 物联网 |
| 体系结构 | 两种变体:插槽支持和无插槽支持。 |
| 功率效率 | 高的 |

单板计算机受欢迎的主要原因是价格，因为它们每台不到 30 美元。另一个额外的好处是它们紧凑和方便的外形；它们适合手掌。有运行 Linux 或 Windows IoT 或其他操作系统的变体。大多数 SBC 没有插槽支持；然而，有些人支持在上面贴工业级卡片。这些小型机器在电力方面效率很高，可以有效地在家用电力单相连接上运行。除非你想把它们插到一个大的 LED 或 LCD 屏幕上，否则它们不需要单独的屏幕电源。他们有自己的 5 英寸或 7 英寸 LED/LCD 平板屏幕，可以由单板机自己供电。单板可以放在灵活的盖子里。从透明外壳到时尚外壳，再到容纳 4 个或 7 个单板机集群的外壳，如今的单板机有多种选择。这种可用性通过给用户 DIY 的成就感扩展了这些计算机的吸引力。从选择机箱到安装操作系统再到使用其他类型的软件，一切都很灵活，有很多选项可供选择。现在我们来看看市面上最流行的单板机及其发展。

### 市场上流行的单板计算机

表 [1-2](#Tab2) 根据 [`https://en.wikipedia.org/wiki/Comparison_of_single-board_computers#Operating_system`](https://en.wikipedia.org/wiki/Comparison_of_single-board_computers%2523Operating_system) 列出了市场上一些最受欢迎的单板机。

表 1-2

流行的单板计算机

<colgroup><col class="tcol1 align-left"> <col class="tcol2 align-left"> <col class="tcol3 align-left"> <col class="tcol4 align-left"> <col class="tcol5 align-left"> <col class="tcol6 align-left"> <col class="tcol7 align-left"> <col class="tcol8 align-left"> <col class="tcol9 align-left"> <col class="tcol10 align-left"> <col class="tcol11 align-left"> <col class="tcol12 align-left"> <col class="tcol13 align-left"> <col class="tcol14 align-left"> <col class="tcol15 align-left"></colgroup> 
| 

名字

 | 

显卡插槽

 | 

USB[2]

 | 

仓库

 | 

建立关系网

 | 

沟通

 | 

通用输入输出

 |
| --- | --- | --- | --- | --- | --- | --- |
| 

Two

 | 

three

 | 

设备

 | 

车载

 | 

闪存插槽

 | 

萨塔（人名）

 | 

Eth。

 | 

无线网络

 | 

Bt。

 | 

I <sup>2</sup> C

 | 

精力

 | 

通用输入输出接口

 | 

模拟的

 |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| 覆盆子 PiZero W | 不 | 不 | 不 | 数码伴侣 | 不 | microSD(微额供资) | 不 | 不 | b/g/n | 4.1 + BLE | 是 | 是 | Seventeen | 不 |
| 树莓皮零 | 不 | 不 | 不 | 数码伴侣 | 不 | microSD(微额供资) | 不 | 不 | 不 | 不 | 是 | 是 | Seventeen | 不 |
| 树莓 Pi 型号 B+ | 不 | four | 不 | 不 | 不 | microSD(微额供资) | 不 | 10/100 | 不 | 不 | 是 | 是 | Seventeen | 不 |
| 树莓 Pi 型号 B | 不 | Two | 不 | 不 | 不 | 南达科他州 | 不 | 10/100 | 不 | 不 | 是 | 是 | eight | 不 |
| 树莓 Pi 型号 A | 不 | one | 不 | 不 | 不 | 南达科他州 | 不 | 不 | 不 | 不 | 是 | 是 | eight | 不 |
| 树莓 Pi 3 型号 B | 不 | four | 不 | 不 | 不 | microSD(微额供资) | 不 | 10/100 | b/g/n | Four point one | 是 | 是 | Seventeen | 不 |
| 树莓 Pi 2 型号 B | 不 | four | 不 | 不 | 不 | microSD(微额供资) | 不 | 10/100 | 不 | 不 | 是 | 是 | Seventeen | 不 |
| 英特尔伽利略第二代[46] | 1 台迷你 | one | 不 | 是 | 8 MB 闪存+ 8 KB EEPROM | 南达科他州 | 不 | 10/100 | 不 | 不 | 是 | 是 | Twenty | 12 位模数转换器，6 路脉宽调制 |
| 香蕉派 M3[137] | 不 | Two | 不 | 数码伴侣 | 8gb EMM | microSD(微额供资) | USB 转 SATA 2.0 适配器 | 银杏叶提取物 | 阿拉伯语/阿拉伯语/西班牙语 | four | 是 | 是 | Forty | 12 位模数转换器(用于触摸的 CON1) |
| 香蕉派 M2 | 不 | Two | 不 | 数码伴侣 | 不 | microSD(微额供资) | 不 | 银杏叶提取物 | 阿拉伯语/阿拉伯语/西班牙语 | 不 | 是 | 是 | Forty | 12 位模数转换器(用于触摸的 CON1) |
| 香蕉派[11] | 不 | Two | 不 | 数码伴侣 | 不 | 南达科他州 | SATA 2.0 | 银杏叶提取物 | 不 | 不 | 是 | 是 | Twenty-six | 12 位模数转换器(用于触摸的 CON1) |

在撰写本文时，当今最流行的 SBC 是树莓派和香蕉派。它们同样受到业余爱好者和严肃用户的欢迎。树莓 Pi 运行 Noobs、Raspbian 和 Windows IoT 等操作系统，而香蕉 Pi 运行 Linux 和 Android 4.x。树莓 Pi 从零模型发展到目前的 3 模型 B+，正如你从表 [1-2](#Tab2) 中看到的，硬件有了巨大的改进。Raspberry Pi 3 B+ how 拥有 ARM Cortex-A53 1.4GHz CPU，这是对 Raspberry Pi 3 B 的改进，Raspberry Pi 3 B 拥有 ARM Cortex-A53 1.2GHz CPU。RAM 大小没有改变；然而，Wi-Fi 有所增强，现在具有高达 5GHz 的传输能力。以太网支持从 100Mbps 增加到 300Mbps。那些项目与移动应用程序紧密相关的用户更喜欢使用 Banana Pi，因为它的操作系统是 Android，虽然它是在 Linux 上构建的，但其操作的核心是 Android。对于本书中的项目，我选择了树莓派。我们将要使用的操作系统是 Raspbian，它是 Debian OS 的一个改编版本。我们不使用 Noobs 是因为我们想在 SBC 上开发商业级应用，我们不使用 Windows IoT 是因为我们需要一个嵌入了桌面和开发 IDE 的操作系统。所以拉斯边的选择是相当明显的。

使用表 [1-3](#Tab3) 来帮助您决定将哪个 Raspberry Pi 用于您的项目。

表 1-3

树莓 Pi 技术规格

<colgroup><col class="tcol1 align-left"> <col class="tcol2 align-left"> <col class="tcol3 align-left"> <col class="tcol4 align-left"> <col class="tcol5 align-left"> <col class="tcol6 align-left"> <col class="tcol7 align-left"> <col class="tcol8 align-left"> <col class="tcol9 align-left"> <col class="tcol10 align-left"></colgroup> 
| 

树莓 Pi 平台

 | 

随机存取存储

 | 

处理器

 | 

通用串行总线

 | 

以太网

 | 

无线网络

 | 

蓝牙

 | 

高清晰度多媒体接口

 | 

其他视频

 | 

MicroSD(微额供资)

 |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| 树莓派 A+ | 512MB | 700 MHz ARM11 | 1 个端口 | - | - | - | 是 | DSI，复合 | 是 |
| 树莓 Pi B+ | 512MB | 700 MHz ARM11 | 4 个端口 | 10/100Mbps | - | - | 是 | DSI，复合 | 是 |
| 树莓 Pi 2 B | 1GB | 900 MHz 四核 ARM Cortex-A7 | 4 个端口 | 10/100Mbps | - | - | 是 | DSI，复合 | 是 |
| 树莓 Pi 3 B | 1GB | 1.2 GHz 四核 64 位 ARM Cortex A53 | 4 个端口 | 10/100Mbps | 802.11n | Four point one | 是 | DSI，复合 | 是 |
| 树莓 Pi 3 B+ | 1GB | 1.4 GHz 64 位 ARM Cortex A53 | 4 个端口 | 300 Mbps/Poe | 802.11ac | Four point two | 是 | DSI，复合 | 是 |
| 树莓派零度 | 512MB | 1 GHz 单核 ARM11 | 1 个微型 USB | - | - | - | 迷你 HDMI | - | 是 |
| 树莓派零无线 | 512MB | 1 GHz 单核 ARM11 | 1 个微型 USB | - | 802.11n | Four point one | 迷你 HDMI | - | 是 |

在我们进入下一节的微控制器主题之前，让我们看看 Raspberry Pi 架构的一个非常重要的方面，即 SBC 板上的 GPIO 引脚覆盖。这些引脚用于与辅助硬件通信，如传感器或其他可以进行串行通信的微控制器，如 Arduino。图 [1-1](#Fig1) 为树莓 Pi 3 模型 B+的 GPIO 叠加图。

![img/484167_1_En_1_Chapter/484167_1_En_1_Fig1_HTML.jpg](img/484167_1_En_1_Chapter/484167_1_En_1_Fig1_HTML.jpg)

图 1-1

用于 Raspberry Pi 3 型号 B+的 GPIO 引脚覆盖

在图 [1-1](#Fig1) 中，你可以看到总共有 40 个 GPIO 管脚。它们有一个结构，为了使用它，理解它是很重要的。图中的引脚编号从 1 到 40。引脚 1 和 17 用于为您的设备提供电源输出(3.5 伏)。引脚 2 和 4 用于提供 5 伏的电源输出。编号为 6、9、14、20、25、30、34 和 39 的引脚用于电路接地。其余引脚用于 GPIO。稍后，当您为一些基于物联网的解决方案创建完整电路时，将会用到这些信息。

现在让我们来讨论微控制器及其使用方法。

## 单板微控制器

SBM 是内置于单个电路板中的微控制器；它们在工业和商业应用中用作工业和商业设备之间的接口，例如使用串行总线通信的设备。它们用于开发需要与工业机器或网络接口(如需要 Modbus 通信协议的接口)连接的解决方案。

Arduino 是一种非常流行的单板微控制器，业余爱好者和学生使用它来学习硬件实现以及如何控制和构建与常见 C 和 C++程序接口的业余爱好者机器。然而，我们将 Arduino 用于工业级目的。让我们比较 Arduino 系列的三种型号，以便选择最适合我们的微控制器。

Arduino Uno、Arduino Mega 和 Arduino Mega 2560 是我们将用于比较的三种型号。所有三个单板微控制器都使用 16MHz 频率的处理器。Mega 和 Mega 2560 的印刷电路板尺寸高于 Arduino Uno，Arduino Uno 在长度上比它们都小一半，为 2.7 英寸 x 2.1 英寸到 4 英寸 x 2.1 英寸。Arduino Mega 2560 具有最高的 256kb 闪存，而 Arduino Uno 具有最低的 32kb 闪存。Arduino Mega 有 128kb。就 SBM 而言，闪存非常重要，因为无论您编写什么程序来通过应用程序控制硬件，都必须先写入闪存。如果闪存容量低，你就不能在其上编写工业级的应用程序。这两种型号都比 Arduino Uno 具有更高的 EEPROM 和 SRAM 此外，Mega 型号有 54 个 GPIO 引脚，而 Uno 只有 14 个引脚。为什么我们的应用需要更多引脚？我们将使用我们的应用程序与串行 Modbus 通信接口进行通信，这可能需要同时连接两个或三个设备。如果引脚数量更少，我们将在拥有并行器件方面受到限制。为此，我们需要更高的引脚。

所以对我们来说最好的型号是 Arduino Mega 2560，它拥有最高的闪存。

### Arduino Mega 2560

图 [1-2](#Fig2) 显示了 Arduino Mega 2560 的 GPIO 覆盖图及其通信架构。

![img/484167_1_En_1_Chapter/484167_1_En_1_Fig2_HTML.jpg](img/484167_1_En_1_Chapter/484167_1_En_1_Fig2_HTML.jpg)

图 1-2

Arduino Mega 2560 架构

在图 [1-2](#Fig2) 的单板计算机图中可以看到标记为 GPIO 引脚的区域。该型号支持数字引脚和模拟引脚。数字引脚用于控制数字传感器等设备并与之通信，模拟引脚用于与模拟传感器等模拟设备通信。该型号有一个 USB 接口，用于与另一个设备进行串行总线通信，例如像 Raspberry Pi 这样的 SBC。在本书后面关于如何在 Raspberry Pi 和 Arduino 之间进行连接和通信的部分，您将会详细了解这一点。图 [1-3](#Fig3) 显示了 Arduino Mega 2560 板上 GPIO 引脚的覆盖图。

![img/484167_1_En_1_Chapter/484167_1_En_1_Fig3_HTML.jpg](img/484167_1_En_1_Chapter/484167_1_En_1_Fig3_HTML.jpg)

图 1-3

Arduino Mega 2560 GPIO 引脚覆盖

如图所示，从 D 开始的管脚编号表示数字管脚；这些是您将连接数字传感器和设备的插槽。从 A 开始的引脚是模拟引脚，可用于与模拟器件通信。目前，这是你需要理解的。一旦你开始组装你的系统，你将会看到所有这些细节。

## 物联网传感器

物联网是互联网连接到日常物理设备和物体的延伸。当像传感器和互联网连接这样的设备被添加到它并被嵌入到像艺术对象或任何其他对象这样的物理设备中时，显示关于创建日期、对象的艺术家描述、最近修改日期等的信息。，则物联网形成。我们现在有了自动再订购柜的概念，可以在消费后空了的时候在线订购食物。通过在日常物品中嵌入物联网传感器，我们正在使它们变得智能，便于人类改善。

市场上常见的物联网传感器可以与 Raspberry Pi 和 Arduino 一起工作，因为它们使用 GPIO 引脚进行通信。表 [1-4](#Tab4) 列出了可以在 Raspberry Pi 和 Arduino 上使用的常见传感器类型。

表 1-4

物联网传感器的常见类型及其用途

<colgroup><col class="tcol1 align-left"> <col class="tcol2 align-left"></colgroup> 
| 

传感器的类型

 | 

目的

 |
| --- | --- |
| 计算机视觉 | 光学和环境光检测 |
| 邻近和位置 | GPS 定位和物体的存在 |
| 温度 | 检测空气、土壤和水中的大气温度 |
| 湿度/水分 | 检测空气和土壤中的大气湿度 |
| 听觉的 | 探测大气中的红外线和超声波振动 |
| 化学药品 | 检测空气、土壤和水中的气体含量 |
| 流动 | 检测封闭区域(如管道)中的空气和水流 |
| 电磁的 | 检测环境中的电磁水平 |
| 加速 | 检测连接的电子设备的倾斜 |
| 负载/重量 | 检测被监控环境中负载或重量的变化 |

从表 [1-4](#Tab4) 中可以看出，有多种传感器可用，从数字到模拟，使用 Wi-Fi 摄像头测量和检测物体，到检测电子设备上的重量或负载变化。这些传感器的用途和应用是无限的，可以赋予物联网应用新的生命。您将在本书中使用这些常见类型的传感器，我将在您构建解决方案时更详细地概述它们。

## 嗡嗡声

维基百科( [`https://simple.wikipedia.org/wiki/Unmanned_aerial_vehicle`](https://simple.wikipedia.org/wiki/Unmanned_aerial_vehicle) )对无人机的定义是通过遥控装置操作的无人驾驶飞行器。无人机通常内置一个小型微控制器，能够检测气压变化、物体接近度、加速度等。它内置了许多物联网传感器，比有人驾驶的飞机更智能。但是，不需要人类监督飞行和工作的自动无人机非常少。大多数无人机都有人类监督员，他们通过远程控制机制控制它们的活动。

您将在电信领域案例研究的解决方案中使用工业级无人机。你将需要一架工业级无人机，其有效载荷可达 3.5 磅或 1.5 千克，航程为 5 公里，因为你将驾驶它在特定地点的某个区域进行探测。你需要的最小飞行时间是 30 分钟，因为这是收集一些像样的数据以应用机器学习所需的最小时间。这几类无人机肯定不便宜；起价 2500 美元。

## Modbus 设备

在案例研究的能源部分，您将使用另一种设备。Modbus 设备是用于连接工业设备的标准通信协议，例如机器到计算机。它们也用于收集和发送数据。有一个主设备或微控制器使用 Modbus 协议与其从设备通信，从设备的数量最多可达 247 个。这使得协议非常健壮，这就是我选择 Arduino Mega 2560 单板微控制器的原因(因为它在板上有很多空间用于模拟和数字引脚进行通信)。

Disclaimer

在继续之前，我想提醒您使用此 Modbus 设备作为电能表的相关风险。它是一种电器，如果连接不当，会有短路的危险。如果不按照说明书使用，它还会对人的生命造成危险。如果连接错误，它还会烧毁和损坏您的 Raspberry Pi 和 Arduino 板。因此，如果你对电气连接感到不舒服，我强烈建议你不要使用这种设备，或者从当地电气技师那里获得专业帮助，以进行正确的连接。我和出版商都不对任何形式的损害负责，无论是物质损害还是生命损害。建议用户自行判断。

在工业领域，使用三相 Modbus 电能表，但这在正常环境下很难复制，所以我推荐使用单相电能表，它使用 Modbus RTU 通信协议。施耐德电气等公司有很多选择。

## 所需软件

要运行本书中的练习，您需要安装 Python 3.x。为此，我建议您使用 Raspbian 操作系统附带的默认 Python 安装。Python 是一个简单的发行版，不像 Anaconda，它不需要任何安装。本书中的所有编码练习都适用于这个版本的 Python。本书中的练习和解答不支持 Windows，也没有在任何版本的 Windows 上测试过。使用 Raspbian 操作系统是让它们工作的必要条件。请按照本书安装部分给出的步骤进行安装。

您还将使用 Arduino IDE 在 Arduino 和 Raspberry Pi 之间进行通信，因此 Arduino 将在您的解决方案中充当 Raspberry Pi 的从属设备。这可以通过`apt-get`命令安装，您将在本书的安装部分看到。

## 摘要

本章介绍了 SBC 及其历史发展。您了解了市场上最受欢迎的 SBC，如 Banana Pi、Raspberry Pi 和 Arduino。在深入的比较中，您从 USB、存储、网络和通信功能方面探究了流行的 SBC 的功能。您还了解了 Raspberry Pi，更具体地说是 Raspberry Pi 3 模型 B+,您将在本书后面的 IoT 和 IIoT 项目中使用它作为主节点。您了解了位于 Raspberry Pi 上的 GPIO 引脚及其用途。您还了解了单板微控制器以及它们与单板计算机的不同之处。您还了解到，物联网和 IIoT 应用中的单板微控制器通常用作 Raspberry Pi 等单板计算机的从机。您还看到了最受欢迎的单板微控制器是 Arduino，并且查看了 SBM 类型和特性信息的表格，如处理器、I/O 模块、频率、电压等。

然后，您查看了 Arduino Mega 2560 及其布局，并了解了它的 GPIO 引脚。然后你了解了这本书最重要的主题:物联网传感器及其类型和应用。您还了解了无人机，因为在本书中，它们将用于为电信应用收集数据。您了解了 Modbus 设备以及如何使用它来构建商业应用。最后，你得到了一份将在本书中使用的软件列表。