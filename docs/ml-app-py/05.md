# 五、医疗保健中机器学习要避免的陷阱

在这一章中，我将分享我多年来在构建机器学习和非机器学习应用程序中积累的经验和知识。本章的主要目的是让你意识到人们在商业环境中实现机器学习时经常犯的错误。我将强调机器学习团队和实现机器学习的组织需要避免的一些陷阱。你可能在工作环境中遇到过这些，或者有些对你来说是新的；然而，根据我的经验，我给出的这个场景是你会珍惜的，我们会知道如何避免这些问题的专家意见。从这个角度出发，我希望你能阅读我在本章中谈到的所有六个陷阱。我将从我的经历中使用并给出各种例子，而不指名客户，以保持匿名，当团队没有关注这些原则时，它是如何导致项目被延迟或终止的。以我作为一名超过 17 年的程序和项目经理的身份，我不能强调这样一个事实，如果你不遵循这些原则，你的机器学习项目也注定会失败。

## 满足业务目标

满足业务目标是我从第 [1](01.html) 章开始已经讨论过的事情。然而，在这里，我不仅要强调为满足业务需求这一唯一目标构建机器学习应用程序的重要性，还要给你一些真实的例子，当机器学习开发团队没有遵循这一原则时，项目以灾难告终。

在我的一个客户的任务中，我被介绍给一个非常有才华的年轻团队，他们正在开发一个人工智能应用程序。该团队由机器学习工程师测试人员、文档专家和其他跨职能专家组成。由于发布应用程序的严格时间表，该团队在压力下工作。团队使用 scrum 敏捷方法进行开发，为了获得他们项目的状态，我开始参加他们的日常会议。我知道团队正在开发中，产品负责人已经对正在开发的应用程序发出了几次警告。有几名经验丰富的工程师在这个团队工作，并且由一名经验丰富的经理监督。接下来的一周，团队和产品负责人开了一次会，我深入了解了产品负责人对正在开发的应用程序的看法。

在产品演示中，产品负责人同意在团队的各种冲刺阶段向他展示的应用程序的部分内容；然而，当团队集成应用程序时，产品负责人给出的反馈是这个应用程序不符合业务目标。任何开发过 1.0 应用程序的人都经历过这种情况。突然，当应用程序以部分形式展示给产品负责人时，产品负责人同意这些部分是好的，并且符合业务目标；然而，当应用程序被集成时，它不符合业务目标。

这种情况通常会发生，在这种情况下，应用程序的业务目标之一是自动化手动流程，并应用机器学习算法来加快医疗保健领域的速度；然而，当应用程序集成到 GUI、设置和配置模块、机器学习引擎和 web 报告模块的地方时，应用程序需要花费更多的时间来创建自动化流程，这违背了构建应用程序的原始业务目标。每个模型，比如设置和配置、引擎、web 报告和 GUI，都是由不同的团队在称为 sprints 的迭代周期中开发的。他们没有想到通过使用搜索算法和技术来构建一个高效快速的应用程序，这将减少人类完成该应用程序自动执行的相同任务所需的时间。当您开发要满足特定业务目标的应用程序时，任何人都不应该在开发应用程序时忽略这些业务目标。否则，它将导致失败，并且由于忽略了业务目标而导致项目终止。

这是我给所有读者的建议:关注业务目标，并询问每个团队他们正在构建的模块是否满足业务目标。应用程序会比执行工作的人更好吗？这个应用程序会比执行这项工作的人更快吗？如果你作为一个团队认为这个应用程序将会比手工任务更好，那么这个自动化将会提供多少时间或者减少多少流程？

这些是从团队成员到产品所有者到经理的每个人每天都需要问的关于应用程序满足其业务目标的一些问题。团队大部分时间都在努力解决技术问题，例如使用哪种算法、哪种语言用于 Goa、哪种技术用于 web 报告应用程序，以及如何使每个模块相互通信，而不是着眼于主要的业务目标——在这种情况下，提供快速高效的人工替代。如果团队忽略了业务目标，应用程序的部分将会成功；然而，当它们被总结时，它们将被定义为一个失败，项目可能因此被废弃。在所有的会议中，无论是业务会议、团队会议、产品负责人会议，还是任何其他类型的评审会议，讨论的主题都必须是我们现在构建的应用程序是否能够满足主要的业务目标。如果应用程序将满足业务目标，那么满足的百分比是多少，这应该基于团队进行的一些实际测试来衡量。只有当我们将这种严谨性放在业务目标的首位时，我们才能希望应用程序能够满足其业务目标。

## 这不是比赛，是应用商业！

每个应用机器学习工程师需要具备的另一个重要心态是，他们正在为业务开发，这不再是一场黑客马拉松或竞赛。我这样说是基于我与许多机器学习团队交谈以及在 LinkedIn 等社交平台上与机器学习工程师互动的经验，我看到人们普遍认为机器学习就是了解统计数据、常见的机器学习算法以及 Python 或 r 等编程语言。但是，当同一位机器学习工程师在黑客马拉松或竞赛中获胜后，他们进入了商业世界，他们无法满足机器学习应用程序的商业目标。我现在将强调应用机器学习和竞赛中使用的机器学习之间的差异；这将帮助你理解应用机器学习与流行机器学习的不同之处。表 [5-1](#Tab1) 显示了这种差异。

表 5-1

应用机器学习和流行机器学习的区别

<colgroup><col class="tcol1 align-left"> <col class="tcol2 align-left"> <col class="tcol3 align-left"></colgroup> 
| 

因素

 | 

应用机器学习

 | 

流行的机器学习

 |
| --- | --- | --- |
| 目标 | 解决商业问题 | 在比赛中获得最高名次 |
| 代码所有权 | 由组织专有并可申请专利 | 公共不可专利 |
| 焦点 | 申请商业成功 | 黑进分数 |
| 实现的手段 | 端到端工作应用 | 符合竞争标准的代码 |
| 技术成就 | 应用程序满足业务需求 | 代码符合顶级标准 |

在表格中，你可以看到有五种类型的参数，我根据这些参数区分了应用机器学习和流行机器学习。首先是客观。在应用机器学习的情况下，目标是解决业务问题。业务问题可能与自动化人工工作或创建一个创新应用程序有关，该应用程序将使用人工智能和机器学习为业务的最终客户执行新任务。目标显然是解决企业面临的问题，并应用机器学习来解决它们。在竞赛中使用的流行机器学习的情况下，目标是在竞赛中获得最高等级。有人可能会争辩说，如果不满足或解决竞争中给出的业务问题，你就无法在竞争中获得最高排名。因为比赛中至少有数百名参与者能够以他们自己的方式解决比赛中给出的业务问题，所以他们可能不会被选为获胜者，因为他们没有排名最高。在黑客马拉松或竞赛中，从来没有应用标准来查看哪个参与者的解决方案能够最佳地解决业务问题；但是，这是为了看给出的解决方案是否能够满足一定的精度水平。达到或超过准确度水平可能并不意味着该解决方案最佳地解决了所识别的业务问题。你可能有一个非常准确的机器学习算法，但它可能无法解决业务问题，因为它没有考虑到业务试图解决的问题。在这种情况下，流行的机器学习方法将产生灾难性的机器学习解决方案。

下一个参数是代码所有权。在应用机器学习的情况下，通常 code credit Python 机器学习团队归该组织所有，并可申请专利，归该组织所有。与此相反，随着竞赛中流行的机器学习，代码不可申请专利，因为它可以被公众访问。该解决方案没有版权，因为任何参与竞赛或黑客马拉松的人都可以看到它。这对于在 kaggle.com 这样的网站上举办的比赛来说是真实的。

下一个参数是焦点。在这里，应用机器学习侧重于商业成功和创建一个不仅满足而且超过商业目标的解决方案。通过机器学习应用程序，就像我们在实验室协调员的案例研究中看到的那样，kiosk 中的聊天机器人能够用某些有限的功能取代实验室协调员，并能够使业务取得成功。在流行的机器学习的情况下，重点是在代码中使用黑客来获得更高的准确性或竞争对手瞄准的任何基准。这种关注的一个例子是，有一些算法，如梯度提升或 Ada，已经受到竞赛参与者的欢迎，因为它们能够提供更高的精度水平。准确性水平并不意味着保证您的解决方案能够解决业务问题。尽管您可能有一个高精度的机器学习解决方案，但它可能不符合业务目标，这有多种原因。其中一些可能与解决方案的效率有关。也可能是我们试图在我们的机器学习算法中进行偏差和方差的权衡。

下一个参数是实现应用程序或业务目标的方法。在应用机器学习的情况下，方法是创建一个端到端的工作应用程序，模拟解决其业务需求。然而，在流行的机器学习的情况下，目的是编写符合竞争标准的代码。

下一个参数是技术成就。在应用机器学习的情况下，只有当应用程序满足业务需求时，它才会成功。在流行的机器学习中，代码只有在满足或者是顶级标准时才成功。在我看来，这是一个机器学习工程师必须抛弃和重新学习这些参数的方式的重大差异，以及方法上的差异，并改变他们成为应用机器学习工程师的心态。

## 不要陷入规划和设计的缺陷中

规划的目的是为应用程序开发提供一个结构，并识别可能会破坏项目的风险。一些常见的规划缺陷是:

*   ***未能识别机器学习应用的关键业务目标。**T3】*

*   ***无法识别应用程序所需的所有模块。**T3】*

*   ***无法确定应用程序性能的基准。**T3】*

*   一些设计缺陷是:

*   ***为机器学习应用程序创建反馈架构失败。**T3】*

*   ***由于技术原因，未能识别集成挑战。**T3】*

*   ***失败的原型。**T3】*

在我的计划缺陷列表中，最大的缺陷是未能确定组织正在开发的机器学习应用程序的关键业务目标。举个例子，一个特定的客户要求一个机器学习应用程序来代替医疗机构的前台。这个特定的商业目标本身对于理解如何将它转换成交互式机器学习应用没有多大用处。不同的主题可以有不同的解释。例如，一个团队可能会说，因为我们需要更换整个前台系统，所以我们需要制造一个机器人。其他一些团队可能会说，我们需要构建一个信息亭计算机，为到达的客户提供与医院交互的选项。另一个团队可以将其解释为构建一个可以帮助前台人员的应用程序。因此，它不仅有助于定义业务目标，而且有助于确定流程的哪一部分需要替换或模仿。如果这样做不正确，那么不同的团队和不同的人将会提出他们自己的想法来解决所确定的业务问题，因此，确定那些对于机器学习应用来说重要的关键业务目标是非常重要的。

下一个失败是在应用程序规划期间确定应用程序所需的所有模型。我看到各种各样的主题发现，例如，为了让应用程序正常工作，他们需要一个他们以前没有考虑过的配置模块。在开发活动的中期发现这样的模型是一件昂贵的事情。因此，谨慎的做法是，团队进行有效的规划，并确定机器学习应用程序成功运行所需的所有模型。在我们的例子中，如果配置模块将在开发周期的中间被开发，那么它需要重新计划和重新安排，然后重新处理机器学习应用的成本。如果结果是模块很小，并且不需要很多天的工作，那么就没有必要回去找企业所有者来确定重新计划是否得到他们的批准。然而，如果这是一个主要的开发活动，需要几周的开发和测试活动，并且会影响软件的集成，那么这就是一个错过计划或糟糕计划的例子。重要的是，开发机器学习应用程序的团队在开始设计和编码之前，要做大量的计划工作，确定该应用程序所需的各种模型。

对于规划中的下一个失败，我提出了一个导致机器学习应用程序失败的非常常见的问题——一旦应用程序进入生产，就要确定性能基准。我说这很常见的原因是因为许多与机器学习相关的算法都是计算机密集型的，如果机器学习应用程序使用像深度学习神经网络这样的东西，那么性能基准在这样的应用程序构建过程中是极其重要的。根据我的经验，我可以告诉你，当一个机器学习应用程序为一个著名的客户构建并投入生产时，该算法运行了 12 个多小时，以便计算一个关于客户是否会从网站购买产品的预测值。当团队开始规划时，他们从未想过要加入任何应用程序性能基准，因为所有的机器学习工程师都来自热门的机器学习领域，他们没有将机器学习应用于业务的经验。因此，尽管该应用程序在使用深度学习模型后具有很高的准确性，但它未能满足预测客户是否会购买产品以及谁在实时状态下访问过网站的值的业务目标。在机器学习应用程序的应用程序开发生命周期中，当应用程序被集成并一起工作时，这些性能基准必须以测试用例的形式出现。这将确保机器学习应用能够按照业务目标的预期来执行。

现在我们来看看设计缺陷，第一个是为机器学习应用程序创建反馈架构的失败。这是另一个非常常见的问题，其中机器学习架构师未能在软件的设计中创建反馈循环，并且机器学习应用程序没有从实时生产系统中获取反馈，并且随后被业务抛弃，因为给出了不准确的结果。让我澄清一下我所说的机器学习应用的反馈架构是什么意思。任何机器学习团队都可以规划、设计和开发预测流程的某些业务参数的机器学习应用程序。在现实世界中，很难找到一个不具有 100%准确度的应用程序。每个算法都有一定的准确度，这意味着算法会做出一些错误的预测，分类为类型 1 和类型 2 错误。如果机器学习应用不从预测错误值中学习，那么它被认为在反馈架构中有设计缺陷。反馈架构要求机器学习应用程序从它所犯的错误中学习，并在下一次提高自己的性能。这被称为真正的学习，并模仿人类每天进行的学习过程。

在下一个设计流程失败中，我谈到了识别技术带来的集成挑战。在机器学习应用程序中，你可以创建聊天机器人——例如，我在第 [4](04.html) 章中为我们模拟实验室协调员的案例研究创建的聊天机器人。我用 Python 创建了 GUI 然而，在现实世界中，当你实现这样一个应用程序时，你很难用 Python 来构建人工智能。为了创建前端应用程序，您可以使用一种机器友好的语言，如 C#或 Java。这种应用程序的下一个集成挑战是聊天机器人的智能在 Python 中运行，但目标出现在 dotnet 中，这两者如何集成在一起？这可以通过使用各种插件技术来实现，这些插件技术将 C#集成到 Python 中，或者将 Python 集成到 C#中，然后让它们通过这些插件库相互通信。这只是设计机器学习应用程序时可能面临的技术集成挑战的一个例子。另一个例子是，如果聊天机器人需要通过网站与人交互，那么他们需要一种方法从 web 前端 GUI 连接到 Python 代码。这可以通过像 flask 这样的服务和技术来实现，它们允许集成过程。

我谈到的下一个失败是原型的失败。在这次失败中，团队构建了一个概念证明，并向业务所有者展示了一个原型；然而，当我们试图在现实世界中实现原型时，我们面临着多重问题。这些问题通常与所用技术的扩展有关，例如 10 个用户的原型。然而，当我们将它扩展到成千上万的用户时，它就挂了。在这种情况下，虽然我们有一个原型，但在扩大规模时失败了。在某些情况下，我们也可以有一个使用某种技术的原型，但是当该技术被用来创建某个在原型开发时没有构建的功能时，它就失败了，我们意识到这种技术不适合我们试图构建的原型应用程序。因此，原型失败也是机器学习应用程序可能面临的设计失败之一，这也可能导致机器学习应用程序项目的终止。

## 为您的预测模型选择最佳算法

这是机器学习应用失败的另一大原因。我推荐使用 scikit-learn 备忘单进行算法选择。这是为您的机器学习算法[ [1](#Par40) ]选择最佳算法的复杂过程中导航的最佳方式。

让我用本书第 [4](04.html) 章中的案例研究为参考，给你演示一个例子。我来到橙色的开始按钮，它问的下一个问题是，“你有大于 50 的样本吗？”在我们的案例中，如果你还记得的话，我们有 125 家医院的样本，多于 50 家。所以在我们的案例中，没有必要获取更多的数据。我们转到下一个圈，它问:“你是在预测一个类别吗？”在我们的例子中，我们预测食物浪费是以千克为单位的，这是数量而不是类别，所以我们说不，我们转而预测数量。然后它要求用是或否来预测一个量。我们说是。它会问:“是不是少于 10 万个样本？”我们说是的，因为我们只有 125 个样本。下一个问题是，“应该重要的功能是不是很少？”我们说不，因为大多数数字特征在我们的例子中是重要的。我们选择 SVR 核线性回归，我们看到它不起作用，因此箭头的下一部分将我们带到集成回归器，我们选择线性回归回归器来解决我们确定的问题。所以在这本书里，你已经看到了我是如何使用小抄来得到最好的机器学习算法的。

## 你在用敏捷机器学习吗？

目前，基于敏捷 scrum 的软件开发方法非常流行，并且正在全世界的组织中使用。敏捷方法已经证明了它加速软件开发和授权团队自己做决策的能力。我谈论敏捷机器学习是因为有各种各样的机器学习应用程序不是由软件组织开发的，而是由商业组织开发的，比如零售店、医院或金融公司。在这种情况下，当他们开发内部应用程序时，为了取得成功，他们也应该使用最现代的软件开发方法。敏捷为机器学习应用程序开发团队提供了能力和灵活性，如果应用程序不能满足业务需求，他们可以中途改变路线。机器学习是一种试错的努力，不能说一定会有特定问题的解决方案。试错法可以基于算法的选择、数据集的选择或技术的选择。如果团队以瀑布方式工作，那么他们就失去了敏捷的好处，敏捷允许团队在中途修正其路线。敏捷为你提供了将产品所有者整合到开发周期中的框架，并接受早期的反馈，这样在应用程序开发的最后就不会出现意外。敏捷也给团队带来了民主，因为团队成员在执行工作时做出重大决策，而且他们自愿承担必要的工作，以便按时完成应用程序。使用机器学习应用程序的敏捷 scrum 类型的开发也带来了透明性，允许每个人看到机器学习工程师和其他跨职能团队成员在项目中做什么。由于机器学习的试错法，一些开发周期可能会以失败告终，因此最好让利益相关者立即知道某个方法不起作用，而不是让他们一直等到周期结束，就像瀑布模型中发生的那样。考虑到所有这些好处，我强烈建议，无论何时你组建一个机器学习应用团队，你都应该开始使用敏捷形式的开发。

## 确定项目中的技术风险

开发机器学习应用程序的最大风险是，这是一个基于试错的过程。有时，这些算法在某些类型的数据集上有效，有时在其他类型的数据集上表现不佳。尽管有一个备忘单(我们在前面讨论过)，但是在最佳算法选择中没有唯一的答案。尽管商业世界存在这种限制，但机器学习顾问面临着为客户提供最佳解决方案的压力。即使找到了正确的算法，超参数优化也需要很长时间来确定算法的正确参数。人工神经网络和 RNN 等深度学习算法需要非常高的计算能力和处理时间，以达到最佳参数集。

还有其他技术风险，例如通过使用 GPU 需要高计算能力，深度学习应用程序的 RAM 如果没有针对生产环境进行适当的规划，可能会导致整个项目脱轨。我收到了许多来自工业客户的 sow，他们希望在 4 GB RAM、1,1 GHZ CPU 和普通 GPU 上实现工业视觉应用，我必须告诉他们基于神经网络的系统的最低计算要求。

我发现大多数客户的另一个风险是，他们从市场上雇佣了一个机器学习工程师团队；然而，他们中没有一个人有能力开发一个生产就绪的机器学习应用程序，因为他们从来没有这样做过。这种技术资源对本组织来说是一种负担，而不是资产。然后，他们必须聘请像我这样的顾问来指导他们建立端到端的机器学习算法。具有实现机器学习应用知识的经验丰富的机器学习工程师很难找到。

与从不懂应用机器学习的黑客马拉松中获得机器学习工程师的风险相对应的是，他们可能知道开发应用程序的公司不使用的编程语言。我的一个客户雇佣了懂 Java 和 R，不懂 Python 的机器学习工程师。应用程序是用 Python 开发的，他们在学习和实现代码时都有困难。他们设法编写了代码，但是当涉及到测试和消除缺陷时，他们很努力，因为由于他们对 Python 编程语言缺乏经验，他们编写了一个固有的性能滞后的应用程序。最后，为了加快这个过程，他们不得不雇佣一个像我一样的顾问来帮助他们。当招聘经理面临组建机器学习工程师团队的压力，每个人都急于开始项目时，就会发生这种情况。如果没有为项目仔细挑选人员，技能肯定是一个很大的风险，并可能导致延误。机器学习不仅仅需要编程技能；它需要一个深入了解数学和统计学，并且知道算法如何工作的人。它还需要 SQL 数据库的知识，比如 MongoDB 或 Cassandra，以及基于 web 服务器的集成引擎，比如 Flask。机器学习也需要优秀的分析能力；机器学习工程师分析算法结果的能力也非常重要。机器学习工程师的另一项经常被忽视的技能是理解和迎合业务目标的能力。这种能力是在应用应用机器学习的过程中获得的，我在本书中已经概述了这一点。通过使用我概述的一些技术，您可以为您的客户开发快速且健壮的应用程序。

另一个非常重要的陷阱是在没有数据的情况下创建机器学习应用程序。如你所见，在第四章的案例研究中，我只有 125 家医院的数据。不建议为如此小的数据量创建应用程序，因为这是对技术的一种不充分利用。机器学习算法和底层技术能够使用数 Pb 的数据。我遇到过几个确实想构建机器学习应用程序的客户，但是当我问一个简单的问题时，“你的数据在哪里？”他们无法为他们希望我构建的机器学习应用程序找到任何明确的数据来源。他们给我看的是不能超过 1 千兆字节的数据。如果你最终使用机器学习应用程序来处理如此小的数据量，那么你可能不会通过投资应用机器学习来获得所需的回报。因此，即使在你开始构思一个机器学习应用程序之前，你也必须在你的组织内部问一问，你是否有数据来为这项任务构建一个机器学习应用程序。例如，如果你想创造一个机器人来取代医生，那么你是否有所有症状、疾病、病因和药物的数据，以及以某种机器可以阅读的文本格式编译的成分？这是你需要的一个非常小的例子；然而，机器学习应用需要的数据比我所谈论的要多得多。

在我看来，任何机器学习团队最重要的能力是将技术机器学习术语翻译成商业语言的能力。这种最单一的能力区分了流行的机器学习工程师和应用的机器学习工程师。告诉业务主管 SVM 算法最适合预测客户流失对他们来说没有任何意义，除非你告诉他们我开发了这种算法，可以预测客户何时会离开该业务。很多时候，去掉行话可以让商界人士更容易理解机器学习。我经常让机器学习工程师思考，如果他们必须向一个外行人解释他们在机器学习中最喜欢的算法，他们会如何用三句话来解释？这里的关键是不仅要减少行话，还要保持简洁。在商业世界中，在正确的时间用正确的时态用正确的词语表达正确的事情是极其重要的。只有这样，我们才能希望企业能够理解机器学习应用程序给组织带来的价值(或者没有)。

在任何机器学习应用中要避免的另一个极其重要的陷阱是数据隐私。我们在脸书和其他组织最近的数据泄露事件中看到，公共数据及其处理、传输、存储和保护方式对于企业的长期持续发展非常重要。任何机器学习应用程序都需要数 Pb 的数据，忽略应用程序的数据隐私方面将意味着我们将组织置于风险之中。不仅在应用程序的设计阶段，而且在实现阶段都需要进行仔细的规划。数据的安全性、数据传输的时间以及数据存储的位置都需要仔细考虑。如果使用平面文件来存储数据，那么它们是否足够安全？谁将访问它们？它们是否存储在安全的服务器上？这些数据将与谁共享？我们如何确保从长远来看，数据仍然是安全的，甚至没有人从组织内部窃取数据？未能保护机器学习应用程序的数据隐私可能会导致法律诉讼，并给组织带来极其糟糕的结果。如果组织有数据隐私政策，那么我们需要检查并询问这个机器学习应用程序是否符合组织的数据隐私政策。机器学习应用程序的用户故事需要包括数据泄露测试案例，以便崩溃并证明机器学习应用程序能够安全地传输数据并存储数据，而没有任何类型的黑客或不应访问数据的团体能够访问数据。

## 尾注

1.  Buitinck 等人，2013 年。机器学习软件的 API 设计:来自 scikit-learn 项目的经验， [`http://scikit-learn.org/stable/tutorial/machine_learning_map/index.html`](http://scikit-learn.org/stable/tutorial/machine_learning_map/index.html)