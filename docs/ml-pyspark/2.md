# 二、机器学习导论

当我们出生时，我们没有能力做任何事情。那时候我们连头都抬不直，但最终我们开始学习。起初，我们都笨手笨脚，犯很多错误，摔倒，撞到头很多次，但慢慢地学会了坐、走、跑、写和说。作为一种内置的机制，我们不需要大量的例子来学习一些东西。例如，仅仅通过看到路边的两到三所房子，我们就可以很容易地学会识别一所房子。只要看到周围有几辆汽车和自行车，我们就能很容易地区分汽车和自行车。我们很容易区分猫和狗。尽管对我们人类来说这看起来非常简单和直观，但对机器来说这可能是一项艰巨的任务。

机器学习是一种机制，通过这种机制，我们试图让机器学习，而不用显式地对它们进行编程。简单来说，我们向机器展示了大量猫和狗的图片，只够机器学习两者之间的差异并正确识别新图片。这里的问题可能是这样的:学习像区分猫和狗这样简单的事情需要这么多的图片吗？机器面临的挑战是，它们能够仅从一些图像中学习整个模式或抽象特征；他们需要足够多的例子(在某些方面有所不同)来学习尽可能多的特征，以便能够做出正确的预测，而作为人类，我们有这种惊人的能力在不同的层次上进行抽象，并容易识别物体。这个例子可能是针对图像识别的，但是对于其他应用程序，机器也需要大量的数据来学习。

机器学习是过去几年谈论最多的话题之一。越来越多的企业希望采用信息技术来保持竞争优势；然而，很少有人真正拥有合适的资源和适当的数据来实现它。在本章中，我们将涵盖机器学习的基本类型，以及企业如何从使用机器学习中受益。

互联网上有大量关于机器学习的定义，尽管如果我可以尝试用简单的术语来描述，它看起来会像这样:

1.  机器学习使用统计技术，有时使用高级算法来进行预测或学习数据中的隐藏模式，并从本质上取代基于规则的系统，使数据驱动的系统更加强大。

让我们详细地过一遍这个定义。顾名思义，机器学习就是让机器学习，尽管当我们谈论让机器学习时，会涉及到许多组件。

一个组成部分是数据，它是任何模型的支柱。机器学习在相关数据上蓬勃发展。数据中的信号越多，预测就越准确。机器学习可以应用于不同的领域，如金融、零售、医疗保健和社交媒体。另一部分是算法。基于我们试图解决的问题的性质，我们相应地选择算法。最后一部分由硬件和软件组成。Spark 和 Tensorflow 等开源分布式计算框架的出现使得机器学习对每个人来说都变得更加容易。当场景有限时，基于规则的系统就出现了，所有的规则都可以手动配置来处理这些情况。最近，这种情况有所改变，特别是场景数部分。例如，欺诈发生的方式在过去几年中发生了巨大的变化，因此为这种情况创建手动规则实际上是不可能的。因此，在从数据中学习并适应新数据并做出相应决策的场景中，机器学习正在发挥作用。事实证明，这对每个人都有巨大的商业价值。

让我们看看不同类型的机器学习及其应用。我们可以将机器学习分为四大类:

1.  监督机器学习

2.  无监督机器学习

3.  半监督机器学习

4.  强化学习

上述每个类别都有特定的用途，使用的数据也互不相同。归根结底，机器学习是从数据(历史或实时)中学习，并基于模型训练做出决策(离线或实时)。

## 监督机器学习

这是机器学习的主要类别，为企业带来了大量应用和价值。在监督学习中，我们在标记的数据上训练我们的模型。通过标记，它意味着数据有正确的答案或结果。让我们举一个例子来说明监督学习。如果有一家金融公司希望在接受他们的贷款请求之前根据他们的档案筛选客户，机器学习模型将根据历史数据进行训练，这些数据包含有关过去客户的档案和客户是否拖欠贷款的标签列的信息。样本数据如表 [2-1](#Tab1) 所示。

表 2-1

客户详细信息

<colgroup><col class="tcol1 align-left"> <col class="tcol2 align-left"> <col class="tcol3 align-left"> <col class="tcol4 align-left"> <col class="tcol5 align-left"> <col class="tcol6 align-left"> <col class="tcol7 align-left"></colgroup> 
| 

客户 ID

 | 

年龄

 | 

性别

 | 

薪水

 | 

贷款数量

 | 

作业类型

 | 

贷款违约

 |
| --- | --- | --- | --- | --- | --- | --- |
| 到 23 号 | Thirty-two | M | 80K | one | 永久的 | 不 |
| AX43 | Forty-five | F | 10.5 万 | Two | 永久的 | 不 |
| BG76 | Fifty-one | M | 75K | three | 合同 | 是 |

在监督学习中，模型从也有标签/结果/目标列的训练数据中学习，并使用它对看不见的数据进行预测。在上面的示例中，年龄、性别和薪金等列被称为属性或功能，而最后一列(贷款违约)被称为目标或标签，模型试图对其进行预测以获取不可见的数据。一个包含所有这些值的完整记录称为观察值。该模型需要足够多的观察数据来进行训练，然后根据类似的数据进行预测。在监督学习中，模型至少需要一个输入要素/属性才能与输出列一起接受训练。机器能够从训练数据中学习的原因是因为潜在的假设，即这些输入特征中的一些单独地或组合地对输出列有影响(贷款违约)。

有许多应用程序使用监督学习设置，例如:

案例 1:是否有特定的客户会购买该产品？

案例 2:访问者是否会点击广告？

案例 3:这个人是否会拖欠贷款？

案例 4:给定房产的预期售价是多少？

案例五:如果这个人是不是恶性肿瘤？

以上是监督学习的一些应用，还有很多。使用的方法有时会因模型试图预测的输出类型而异。如果目标标签是分类类型，则它属于分类类别；如果目标特征是一个数值，它将属于回归类别。一些受监督的 ML 算法如下:

1.  线性回归

2.  逻辑回归

3.  支持向量机

4.  朴素贝叶斯分类器

5.  决策树

6.  组装方法

监督学习的另一个特性是可以评估模型的性能。基于模型的类型(分类/回归/时间序列)，可以应用评估指标，并且可以测量性能结果。这主要通过将训练数据分成两组(训练集和验证集)并在训练集上训练模型并在验证集上测试其性能来实现，因为我们已经知道验证集的正确标签/结果。然后，我们可以更改超参数(在后面的章节中介绍)或使用特征工程引入新的特征来提高模型的性能。

## 无监督机器学习

在无监督学习中，我们在类似种类的数据上训练模型，除了这个数据集不包含任何标签或结果/目标列。本质上，我们在没有任何正确答案的情况下根据数据训练模型。在无监督学习中，机器试图在数据中找到隐藏的模式和有用的信号，这些数据可以在以后用于其他应用。其中一个用途是在客户数据中寻找模式，并将客户分组到代表某些属性的不同聚类中。例如，我们来看看表 [2-2](#Tab2) 中的一些客户数据。

表 2-2

客户详细信息

<colgroup><col class="tcol1 align-left"> <col class="tcol2 align-left"></colgroup> 
| 

客户 ID

 | 

歌曲类型

 |
| --- | --- |
| AS12 | 浪漫的 |
| BX54 | 嘻哈音乐 |
| BX54 | 岩石 |
| AS12 | 岩石 |
| CH87 | 嘻哈音乐 |
| CH87 | 经典的 |
| AS12 | 岩石 |

在上面的数据中，我们有客户和他们喜欢的音乐类型，没有任何目标或输出列，只有客户和他们的音乐偏好数据。

我们可以使用无监督学习，将这些客户分组到有意义的集群中，以更多地了解他们的群体偏好，并采取相应的行动。我们可能必须将数据集调整为其他形式，以实际应用无监督学习。我们简单地计算每个客户的价值，看起来就像表 [2-3](#Tab3) 所示。

表 2-3

客户详细信息

<colgroup><col class="tcol1 align-left"> <col class="tcol2 align-left"> <col class="tcol3 align-left"> <col class="tcol4 align-left"> <col class="tcol5 align-left"></colgroup> 
| 

客户 ID

 | 

浪漫的

 | 

嘻哈音乐

 | 

岩石

 | 

经典的

 |
| --- | --- | --- | --- | --- |
| AS12 | one | Zero | Two | Zero |
| BX54 | Zero | one | one | Zero |
| CH87 | Zero | one | Zero | one |

现在，我们可以形成一些有用的用户组，并应用这些信息来推荐和制定基于集群的策略。我们当然可以提取的信息是，哪些客户在偏好方面是相似的，并且可以从内容的角度作为目标。

![img/469852_1_En_2_Chapter/469852_1_En_2_Fig1_HTML.png](img/469852_1_En_2_Chapter/469852_1_En_2_Fig1_HTML.png)

图 2-1

*聚类后无监督学习*

如图 [2-1](#Fig1) 所示，聚类 A 可以属于只喜欢摇滚的客户，聚类 B 可以属于喜欢浪漫&古典音乐的人，最后一个聚类可能属于嘻哈和摇滚爱好者。无监督学习的另一个用途是发现是否有任何异常活动或异常检测。无监督学习有助于确定数据集中的例外。大多数时候，无监督学习可能非常棘手，因为没有清晰的组或多个组之间的重叠值，这不能给出聚类的清晰图像。例如，如图 [2-2](#Fig2) 所示，数据中没有清晰的分组，无监督学习无法帮助形成真正有意义的数据点聚类。

![img/469852_1_En_2_Chapter/469852_1_En_2_Fig2_HTML.jpg](img/469852_1_En_2_Chapter/469852_1_En_2_Fig2_HTML.jpg)

图 2-2

*重叠集群*

有许多应用程序使用无监督学习设置，例如

案例 1:总客户群中有哪些不同的群体？

案例二:这个交易是异常还是正常？

无监督学习中使用的算法有

1.  聚类算法(K 均值，分层)

2.  维度缩减技术

3.  主题建模

4.  关联规则挖掘

无监督学习的整个思想是发现和找出模式，而不是做出预测。因此，无监督学习主要在两个方面不同于有监督学习。

1.  没有标注的训练数据，也没有预测。

2.  模型在无监督学习中的性能无法评估，因为没有标签或正确答案。

## 半监督学习

顾名思义，半监督学习介于监督学习和非监督学习之间。事实上，它使用了这两种技术。这种类型的学习主要与我们处理混合类型的数据集的场景相关，这种数据集包含有标签和无标签的数据。有时它只是完全未标记的数据，但我们手动标记了其中的一部分。可以对这一小部分标记数据使用半监督学习来训练模型，然后使用它来标记数据的其他剩余部分，然后可以将其用于其他目的。这也称为伪标记，因为它标记了未标记的数据。举一个简单的例子，我们有很多来自社交媒体的不同品牌的图片，其中大部分都没有标签。现在使用半监督学习，我们可以手动标记这些图像中的一些，然后在标记的图像上训练我们的模型。然后，我们使用模型预测来标记剩余的图像，以将未标记的数据完全转换为标记的数据。

半监督学习的下一步是在整个标记数据集上重新训练模型。它提供的优势是模型在更大的数据集上进行训练，这在早期是不存在的，现在更健壮，更擅长预测。另一个优势是半监督学习节省了大量人工标记数据的精力和时间。这样做的另一面是，伪标记很难获得高性能，因为它使用一小部分标记数据来进行预测。然而，这仍然是比手动标记数据更好的选择，手动标记数据可能非常昂贵且耗时。

## 强化学习

是第四种也是最后一种学习，在数据使用及其预测方面略有不同。强化学习本身就是一个很大的研究领域，整本书都可以围绕它来写。我们不会对此进行太深入的探讨，因为这本书更侧重于使用 PySpark 构建机器学习模型。其他类型的学习和强化学习之间的主要区别是，我们需要数据，主要是历史数据来训练模型，而强化学习是在奖励系统上工作的。它主要是基于代理采取的改变其状态以最大化回报的某些行动的决策。让我们使用可视化将它分解为单个元素。

![img/469852_1_En_2_Chapter/469852_1_En_2_Figa_HTML.jpg](img/469852_1_En_2_Chapter/469852_1_En_2_Figa_HTML.jpg)

*   自主主体:这是整个学习过程中负责采取行动的主要角色。如果是一个游戏，代理采取行动来完成或达到最终目标。

*   操作:这些是代理为了在任务中前进可以采取的一组可能的步骤。每个动作都会对代理的状态产生一些影响，并且可能导致奖励或惩罚。例如，在网球比赛中，动作可能是发球、回球、向左或向右移动等。

*   奖励:这是强化学习取得进步的关键。奖励使代理能够根据积极的奖励或惩罚采取行动。它是一种反馈机制，区别于传统的监督和非监督学习技术

*   环境:这是代理可以参与的领域。环境决定了行动者采取的行动是奖励还是惩罚。

*   状态:代理在任何给定时间点所处的位置定义了代理的状态。为了前进或达到最终目标，代理人必须不断地朝积极的方向改变状态，以使回报最大化。

强化学习的独特之处在于，有一个反馈机制，基于总贴现报酬最大化来驱动代理人的下一个行为。一些使用强化学习的突出应用是自动驾驶汽车、优化能耗和游戏领域。然而，它也可以用来建立推荐系统。

## 结论

在这一章中，我们简要地看了不同类型的机器学习方法和一些应用。在接下来的章节中，我们将使用 PySpark 详细研究监督和非监督学习。